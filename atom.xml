<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>songmin&#39;s blog</title>
  
  <subtitle>æ— å¿Œä¸æ‚”</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://fusugz.github.io/"/>
  <updated>2020-05-14T14:01:17.044Z</updated>
  <id>https://fusugz.github.io/</id>
  
  <author>
    <name>fusugz</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Unityå¼•ç”¨UIWebViewé—®é¢˜è§£å†³</title>
    <link href="https://fusugz.github.io/2020/05/14/unity-uiwebview/"/>
    <id>https://fusugz.github.io/2020/05/14/unity-uiwebview/</id>
    <published>2020-05-14T13:54:47.000Z</published>
    <updated>2020-05-14T14:01:17.044Z</updated>
    
    <content type="html"><![CDATA[<h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>2020å¹´5æœˆä»¥æ¥ï¼Œä¸Šä¼ åˆ°iTunes Connectçš„ipaæ–‡ä»¶å¦‚åŒ…å«UIWebViewç›¸å…³å¼•ç”¨ï¼Œä¼šå¯¼è‡´ipaåŒ…æ— æ³•é€šè¿‡å¤„ç†ï¼Œæ„å»ºç‰ˆæœ¬ä¸å¯ç”¨ã€‚</p><p>å®¡æ ¸å›¢é˜Ÿåœ¨é‚®ä»¶ä¸­ç»™å‡ºçš„è¯´æ˜å¦‚ä¸‹ï¼š</p><blockquote><p>ITMS-90809: Deprecated API Usage â€“ Apple will stop accepting submissions of apps that use UIWebView APIs . See <a href="https://developer.apple.com/documentation/uikit/uiwebview" target="_blank" rel="noopener">https://developer.apple.com/documentation/uikit/uiwebview</a><br>for more information.</p></blockquote><p>ä½¿ç”¨<code>find</code>æŸ¥æ‰¾å·¥ç¨‹ä¸­ç›¸å…³APIï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . | grep -v .svn  | grep "\.a" | grep -v "\.app" | xargs grep UIWebView</span><br></pre></td></tr></table></figure><p>ç»“æœæŒ‡å‘libiPhone-lib.aæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯Unityå¯¼å‡ºå·¥ç¨‹æ—¶ç”Ÿæˆçš„ç³»ç»Ÿåº“æ–‡ä»¶ï¼Œè¯´æ˜å…¶ä¸­åŒ…å«UIWebViewå¼•ç”¨ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="æ–¹æ¡ˆä¸€"><a href="#æ–¹æ¡ˆä¸€" class="headerlink" title="æ–¹æ¡ˆä¸€"></a>æ–¹æ¡ˆä¸€</h4><h4 id="å‡çº§Unityç‰ˆæœ¬"><a href="#å‡çº§Unityç‰ˆæœ¬" class="headerlink" title="å‡çº§Unityç‰ˆæœ¬"></a>å‡çº§Unityç‰ˆæœ¬</h4><p>Unityåœ¨Unity2017.4.33ç‰ˆæœ¬ä¸­ä¿®å¤äº†æ­¤é—®é¢˜ï¼Œæ¡ä»¶å…è®¸å¯å‡çº§Unityç‰ˆæœ¬æ¥è§£å†³ã€‚</p><blockquote><p>iOS:Fixed Deprecated API Usage warning for using UIWebView when submitting Builds to the App Store Connect.ï¼ˆ1180664ï¼Œ 1182274ï¼‰</p></blockquote><h4 id="æ–¹æ¡ˆäºŒ"><a href="#æ–¹æ¡ˆäºŒ" class="headerlink" title="æ–¹æ¡ˆäºŒ"></a>æ–¹æ¡ˆäºŒ</h4><h4 id="å»é™¤libiPhone-lib-aä¸­UIWebViewçš„å¼•ç”¨"><a href="#å»é™¤libiPhone-lib-aä¸­UIWebViewçš„å¼•ç”¨" class="headerlink" title="å»é™¤libiPhone-lib.aä¸­UIWebViewçš„å¼•ç”¨"></a>å»é™¤libiPhone-lib.aä¸­UIWebViewçš„å¼•ç”¨</h4><ol><li><p>é¦–å…ˆï¼Œç”Ÿæˆä¸€ä¸ªURLUtility.mmæ–‡ä»¶</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">namespace</span> core &#123;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">type</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">StringStorageDefault</span> &#123;</span>&#125;;</span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">type</span>,<span class="title">class</span> <span class="title">type2</span>&gt;</span></span><br><span class="line"><span class="class">    <span class="title">class</span> <span class="title">basic_string</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">char</span> * str;</span><br><span class="line">        basic_string( <span class="keyword">char</span>* arg)&#123;</span><br><span class="line">            str = arg;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OpenURLInGame</span><span class="params">(core::basic_string&lt; <span class="keyword">char</span>,core::StringStorageDefault&lt;<span class="keyword">char</span>&gt; &gt; <span class="keyword">const</span>&amp;arg)</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OpenURL</span><span class="params">(core::basic_string&lt;<span class="keyword">char</span>,core::StringStorageDefault&lt;<span class="keyword">char</span>&gt; &gt;<span class="keyword">const</span> &amp;arg)</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">void</span> *arg2 = arg.str;</span><br><span class="line">    UIApplication *app = [UIApplication sharedApplication];</span><br><span class="line">    NSString *urlStr = [NSString stringWithUTF8String:(<span class="keyword">char</span> *)arg2];</span><br><span class="line">    NSURL *url = [NSURL URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">if</span> (@available(iOS <span class="number">10.0</span>, *)) &#123;</span><br><span class="line">        [app openURL:url options:@&#123;UIApplicationOpenURLOptionsSourceApplicationKey : @YES&#125; completionHandler:nil];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [app openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">OpenURL</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> <span class="keyword">const</span>&amp;arg)</span></span>&#123;</span><br><span class="line">    UIApplication *app = [UIApplication sharedApplication];</span><br><span class="line">    NSString *urlStr = [NSString stringWithUTF8String:arg.c_str()];</span><br><span class="line">    NSURL *url = [NSURL URLWithString:urlStr];</span><br><span class="line">    <span class="keyword">if</span> (@available(iOS <span class="number">10.0</span>, *)) &#123;</span><br><span class="line">        [app openURL:url options:@&#123;UIApplicationOpenURLOptionsSourceApplicationKey : @YES&#125; completionHandler:nil];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [app openURL:url];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>ä½¿ç”¨lipoæŸ¥çœ‹libiPhone-lib.aæ–‡ä»¶ä¸­åŒ…å«çš„æ¶æ„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lipo -info libiPhone-lib.a </span><br><span class="line">Architectures in the fat file: libiPhone-lib.a are: armv7 arm64 armv7s</span><br></pre></td></tr></table></figure><p>å¯çŸ¥ï¼Œä»¥ä¸ŠlibiPhone-lib.aä¸­åŒ…å«çš„æ¶æ„æœ‰armv7ã€arm64å’Œarmv7sï¼Œä»¥ä¸‹ä»¥arm64ä¸ºä¾‹ã€‚</p></li><li><p>ä½¿ç”¨URLUtility.mmç”Ÿæˆå¯¹åº”æ¶æ„ä¸‹URLUtility.oæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">clang -c URLUtility.mm -arch arm64 -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk</span><br></pre></td></tr></table></figure></li><li><p>åˆ†ç¦»libiPhone-lib.aä¸­å„æ¶æ„æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lipo libiPhone-lib.a -thin arm64 -output ./URLUtility64/libiPhone-lib64.a</span><br></pre></td></tr></table></figure></li><li><p>ç§»é™¤å¯¹åº”æ¶æ„ä¸­çš„åŸæœ‰URLUtility.oæ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ar -d ./URLUtility64/libiPhone-lib64.a URLUtility.o</span><br></pre></td></tr></table></figure></li><li><p>å°†æ–°ç”Ÿæˆçš„URLUtility.oæ–‡ä»¶æ·»åŠ åˆ°å¯¹åº”æ¶æ„çš„.aä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ar -q ./URLUtility64/libiPhone-lib64.a ./URLUtility64/URLUtility.o</span><br></pre></td></tr></table></figure></li><li><p>å°†å„æ¶æ„çš„.aæ–‡ä»¶åˆå¹¶ç”Ÿæˆæ–°çš„libiPhone-lib.a</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lipo -create ./URLUtility64/libiPhone-lib64.a ./URLUtilityv7/libiPhone-libv7.a ./URLUtilityv7s/libiPhone-libv7s.a -output ./new/libiPhone-lib.a</span><br></pre></td></tr></table></figure></li></ol><p>ä»¥ä¸Šï¼Œå³å¯æ›¿æ¢libiPhone-lib.aä¸­çš„URLUtility.oæ–‡ä»¶ï¼Œä»è€Œè¾¾åˆ°ç§»é™¤UIWebViewç›¸å…³å¼•ç”¨çš„ç›®çš„ã€‚</p><p>å¯ä»¥ä½¿ç”¨Python3å°†ä»¥ä¸Šæµç¨‹ç”¨è„šæœ¬å®ç°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/evn python</span></span><br><span class="line"><span class="comment"># coding=UTF-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">restructure</span><span class="params">()</span>:</span></span><br><span class="line">    iPhone_OS_SDK_path = <span class="string">"/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS.sdk"</span></span><br><span class="line">    arm64_path = <span class="string">"./URLUtility64/"</span></span><br><span class="line">    armv7_path = <span class="string">"./URLUtilityv7/"</span></span><br><span class="line">    armv7s_path = <span class="string">"./URLUtilityv7s/"</span></span><br><span class="line">    new_lib_path = <span class="string">"./new"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(arm64_path):</span><br><span class="line">        print(<span class="string">"------ç§»é™¤åŸURLUtility64æ–‡ä»¶------"</span>)</span><br><span class="line">        shutil.rmtree(arm64_path)</span><br><span class="line">    os.makedirs(arm64_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(armv7_path):</span><br><span class="line">        shutil.rmtree(armv7_path)</span><br><span class="line">        print(<span class="string">"------ç§»é™¤åŸURLUtilityv7æ–‡ä»¶------"</span>)</span><br><span class="line">    os.makedirs(armv7_path)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> os.path.exists(armv7s_path):</span><br><span class="line">        shutil.rmtree(armv7s_path)</span><br><span class="line">        print(<span class="string">"------ç§»é™¤åŸURLUtilityv7sæ–‡ä»¶------"</span>)</span><br><span class="line">    os.makedirs(armv7s_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(new_lib_path):</span><br><span class="line">        shutil.rmtree(new_lib_path)</span><br><span class="line">        print(<span class="string">"------ç§»é™¤åŸnewæ–‡ä»¶------"</span>)</span><br><span class="line">    os.makedirs(new_lib_path)</span><br><span class="line"></span><br><span class="line">    cmd_generate_o_arm64 = <span class="string">"clang -c URLUtility.mm -arch arm64 -isysroot "</span> + iPhone_OS_SDK_path</span><br><span class="line">    cmd_generate_o_armv7 = <span class="string">"clang -c URLUtility.mm -arch armv7 -isysroot "</span> + iPhone_OS_SDK_path</span><br><span class="line">    cmd_generate_o_armv7s = <span class="string">"clang -c URLUtility.mm -arch armv7s -isysroot "</span> + iPhone_OS_SDK_path</span><br><span class="line"></span><br><span class="line">    cmd_thin_arm64 = <span class="string">"lipo libiPhone-lib.a -thin arm64 -output ./URLUtility64/libiPhone-lib64.a"</span></span><br><span class="line">    cmd_thin_armv7 = <span class="string">"lipo libiPhone-lib.a -thin armv7 -output ./URLUtilityv7/libiPhone-libv7.a"</span></span><br><span class="line">    cmd_thin_armv7s = <span class="string">"lipo libiPhone-lib.a -thin armv7s -output ./URLUtilityv7s/libiPhone-libv7s.a"</span></span><br><span class="line"></span><br><span class="line">    cmd_mv_arm64 = <span class="string">"mv URLUtility.o ./URLUtility64/URLUtility.o"</span></span><br><span class="line">    cmd_mv_armv7 = <span class="string">"mv URLUtility.o ./URLUtilityv7/URLUtility.o"</span></span><br><span class="line">    cmd_mv_armv7s = <span class="string">"mv URLUtility.o ./URLUtilityv7s/URLUtility.o"</span></span><br><span class="line"></span><br><span class="line">    cmd_delete_arm64 = <span class="string">"ar -d ./URLUtility64/libiPhone-lib64.a URLUtility.o"</span></span><br><span class="line">    cmd_delete_armv7 = <span class="string">"ar -d ./URLUtilityv7/libiPhone-libv7.a URLUtility.o"</span></span><br><span class="line">    cmd_delete_armv7s = <span class="string">"ar -d ./URLUtilityv7s/libiPhone-libv7s.a URLUtility.o"</span></span><br><span class="line"></span><br><span class="line">    cmd_add_arm64 = <span class="string">"ar -q ./URLUtility64/libiPhone-lib64.a ./URLUtility64/URLUtility.o"</span></span><br><span class="line">    cmd_add_armv7 = <span class="string">"ar -q ./URLUtilityv7/libiPhone-libv7.a ./URLUtilityv7/URLUtility.o"</span></span><br><span class="line">    cmd_add_armv7s = <span class="string">"ar -q ./URLUtilityv7s/libiPhone-libv7s.a ./URLUtilityv7s/URLUtility.o"</span></span><br><span class="line">    </span><br><span class="line">    cmd_create_lib = <span class="string">"lipo -create ./URLUtility64/libiPhone-lib64.a ./URLUtilityv7/libiPhone-libv7.a ./URLUtilityv7s/libiPhone-libv7s.a -output "</span> + new_lib_path + <span class="string">"/libiPhone-lib.a"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    print(<span class="string">"------å¤„ç†arm64æ¶æ„------"</span>)</span><br><span class="line">    os.system(cmd_generate_o_arm64)</span><br><span class="line">    os.system(cmd_thin_arm64)</span><br><span class="line">    os.system(cmd_mv_arm64)</span><br><span class="line">    os.system(cmd_delete_arm64)</span><br><span class="line">    os.system(cmd_add_arm64)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"------å¤„ç†armv7æ¶æ„------"</span>)</span><br><span class="line">    os.system(cmd_generate_o_armv7)</span><br><span class="line">    os.system(cmd_thin_armv7)</span><br><span class="line">    os.system(cmd_mv_armv7)</span><br><span class="line">    os.system(cmd_delete_armv7)</span><br><span class="line">    os.system(cmd_add_armv7)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"------å¤„ç†armv7sæ¶æ„------"</span>)</span><br><span class="line">    os.system(cmd_generate_o_armv7s)</span><br><span class="line">    os.system(cmd_thin_armv7s)</span><br><span class="line">    os.system(cmd_mv_armv7s)</span><br><span class="line">    os.system(cmd_delete_armv7s)</span><br><span class="line">    os.system(cmd_add_armv7s)</span><br><span class="line"></span><br><span class="line">    os.system(cmd_create_lib)</span><br><span class="line">    print(<span class="string">"ğŸ€ç”Ÿæˆæ–°çš„libiPhone-lib.aï¼Œå·²ç§»é™¤UIWebViewå¼•ç”¨"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    restructure()</span><br></pre></td></tr></table></figure><p>åˆå§‹æ–‡ä»¶ç›®å½•ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ URLUtility.mm</span><br><span class="line">â””â”€â”€ libiPhone-lib.a</span><br></pre></td></tr></table></figure><p>è„šæœ¬è¿è¡Œå®Œæˆåæ–‡ä»¶ç›®å½•ä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ URLUtility.mm</span><br><span class="line">â”œâ”€â”€ URLUtility64</span><br><span class="line">â”‚   â”œâ”€â”€ URLUtility.o</span><br><span class="line">â”‚   â””â”€â”€ libiPhone-lib64.a</span><br><span class="line">â”œâ”€â”€ URLUtilityv7</span><br><span class="line">â”‚   â”œâ”€â”€ URLUtility.o</span><br><span class="line">â”‚   â””â”€â”€ libiPhone-libv7.a</span><br><span class="line">â”œâ”€â”€ URLUtilityv7s</span><br><span class="line">â”‚   â”œâ”€â”€ URLUtility.o</span><br><span class="line">â”‚   â””â”€â”€ libiPhone-libv7s.a</span><br><span class="line">â”œâ”€â”€ libiPhone-lib.a</span><br><span class="line">â”œâ”€â”€ new</span><br><span class="line">â”‚   â””â”€â”€ libiPhone-lib.a</span><br><span class="line">â””â”€â”€ restructure.</span><br></pre></td></tr></table></figure><p>å…¶ä¸­newæ–‡ä»¶ç›®å½•ä¸‹çš„libiPhone-lib.aå·²å®ç°UIWebViewå¼•ç”¨çš„ç§»é™¤ï¼Œä½¿ç”¨<code>find</code>å‘½ä»¤è¿›è¡ŒéªŒè¯ï¼Œå‘ç°æ–°çš„libiPhone-lib.aä¸­å·²ä¸åŒ…å«UIWebViewç›¸å…³ä»»ä½•ä»£ç ã€‚å°†è¯¥æ–‡ä»¶ä¸å·¥ç¨‹ä¸­çš„å¯¹åº”æ–‡ä»¶è¿›è¡Œæ›¿æ¢ï¼Œå³å¯è§£å†³ipaåŒ…ä¸Šä¼ é—®é¢˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h3&gt;&lt;p&gt;2020å¹´5æœˆä»¥æ¥ï¼Œä¸Šä¼ åˆ°iTunes Connectçš„ipaæ–‡ä»¶å¦‚åŒ…å«UIWebViewç›¸å…³å¼•ç”¨ï¼Œä¼šå¯¼è‡´ipaåŒ…æ— æ³•é€šè¿‡å¤„ç†ï¼Œæ„å»ºç‰ˆæœ¬ä¸å¯
      
    
    </summary>
    
      <category term="UIWebView" scheme="https://fusugz.github.io/categories/UIWebView/"/>
    
    
      <category term="unity" scheme="https://fusugz.github.io/tags/unity/"/>
    
  </entry>
  
  <entry>
    <title>é¢å‘æ¥å£ç¼–ç¨‹</title>
    <link href="https://fusugz.github.io/2019/09/08/face-to-protocol/"/>
    <id>https://fusugz.github.io/2019/09/08/face-to-protocol/</id>
    <published>2019-09-08T12:47:21.000Z</published>
    <updated>2019-09-08T12:48:48.087Z</updated>
    
    <content type="html"><![CDATA[<p><strong>é¢å‘æ¥å£ç¼–ç¨‹ä¸ä¸é¢å‘å¯¹è±¡ç¼–ç¨‹åŒçº§ï¼Œè€Œæ˜¯é™„å±äºé¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³çš„ç²¾é«“ä¹‹ä¸€ã€‚</strong></p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><blockquote><p>åœ¨ç³»ç»Ÿåˆ†æå’Œæ¶æ„ä¸­ï¼Œåˆ†æ¸…å±‚æ¬¡å’Œä¾èµ–å…³ç³»ï¼Œæ¯ä¸ªå±‚æ¬¡ä¸æ˜¯ç›´æ¥å‘å…¶ä¸Šå±‚æä¾›æœåŠ¡ï¼ˆå³ä¸æ˜¯ç›´æ¥å®ä¾‹åŒ–åœ¨ä¸Šå±‚ä¸­ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡å®šä¹‰ä¸€ç»„æ¥å£ï¼Œä»…å‘ä¸Šå±‚æš´éœ²å…¶æ¥å£åŠŸèƒ½ï¼Œä¸Šå±‚å¯¹äºä¸‹å±‚ä»…ä»…æ˜¯æ¥å£ä¾èµ–ï¼Œè€Œä¸ä¾èµ–å…·ä½“ç±»ã€‚</p></blockquote><h3 id="æœ¬è´¨"><a href="#æœ¬è´¨" class="headerlink" title="æœ¬è´¨"></a>æœ¬è´¨</h3><ol><li>æ¥å£æ˜¯ä¸€ç»„è§„åˆ™çš„é›†åˆï¼Œå®ƒè§„å®šäº†å®ç°æœ¬æ¥å£çš„ç±»æˆ–è€…æ¥å£å¿…é¡»æ‹¥æœ‰çš„ä¸€ç»„è§„åˆ™ã€‚</li><li>æ¥å£æ˜¯åœ¨ä¸€å®šç²’åº¦è§†å›¾ä¸ŠåŒç±»äº‹ç‰©çš„æŠ½è±¡è¡¨ç¤ºï¼Œå®ç°äº†å¤šæ€æ€§ã€‚</li></ol><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ol><li>ç»“æ„æ¸…æ™°ï¼Œä½¿ç”¨æ–¹ä¾¿ã€‚</li><li>æé«˜ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œå½“ä¸‹å±‚éœ€è¦æ”¹å˜æ—¶ï¼Œåªè¦æ¥å£åŠæ¥å£åŠŸèƒ½ä¸å˜ï¼Œåˆ™ä¸Šå±‚ä¸ç”¨åšä»»ä½•ä¿®æ”¹ã€‚</li><li>è®¾è®¡åˆç†çš„æ¥å£ï¼Œæœ‰åˆ©äºç¨‹åºçš„è§„èŒƒåŒ–ï¼Œå¯å¹¶è¡Œè¿›è¡Œå¼€å‘ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚</li><li>å®ç°äº†ç¨‹åºçš„å¯æ’æ‹”æ€§ï¼Œå¯¹äºä¸åŒçš„éœ€æ±‚åˆ‡æ¢ä¸åŒçš„å®ç°ï¼Œé™ä½äº†è€¦åˆåº¦ï¼Œéšç€ç³»ç»Ÿçš„å¤æ‚æ€§çš„æé«˜ä¼˜åŠ¿ä¼šæ„ˆåŠ æ˜æ˜¾ã€‚</li><li>å…è®¸å¤šé‡å®ç°ï¼Œå¼¥è¡¥äº†ç»§æ‰¿çš„ç¼ºé™·ã€‚</li></ol><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ol><li>å¢åŠ äº†è®¾è®¡å¤æ‚åº¦ï¼Œä¸é€‚ç”¨äºç®€å•çš„ç³»ç»Ÿã€‚</li><li>å¯èƒ½ä¼šé™ä½ä»£ç çš„å¯å¤ç”¨æ€§ã€‚</li><li>å¯èƒ½ä¼šé™ä½ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚</li></ol><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><blockquote><p> æ¥å£åˆ†ä¸ºåº•å±‚å®ç°ã€æ¥å£å±‚å®šä¹‰ã€ä¸Šå±‚è°ƒç”¨ä¸‰éƒ¨åˆ†ã€‚</p></blockquote><h4 id="æ¥å£å±‚"><a href="#æ¥å£å±‚" class="headerlink" title="æ¥å£å±‚"></a>æ¥å£å±‚</h4><ul><li>æ¥å£å±‚æ˜¯ä¸Šä¸‹å±‚çš„ç²˜åˆå‰‚ï¼Œå®ç°ä¸Šä¸‹å±‚çš„åˆ†ç¦»ã€‚</li><li>æ¥å£å±‚é€šè¿‡å•ä¾‹æŒæœ‰åº•å±‚æœåŠ¡ã€‚</li><li>åº•å±‚éœ€è¦å°†è‡ªå·±çš„åŠŸèƒ½æ³¨å…¥ç»™æ¥å£å±‚ã€‚</li><li>ä¸Šå±‚é€šè¿‡æŒ‡å®šçš„å…¥å£è°ƒç”¨ä¸‹å±‚çš„æ¥å£ã€‚</li></ul><h4 id="åº•å±‚"><a href="#åº•å±‚" class="headerlink" title="åº•å±‚"></a>åº•å±‚</h4><ul><li>åº•å±‚éœ€è¦éµå¾ªæ¥å£å±‚åè®®ï¼Œå¹¶å®ç°protocolçš„å£°æ˜çš„æ–¹æ³•ã€‚</li><li>åº•å±‚çš„æœåŠ¡éœ€è¦æ³¨å…¥åˆ°æ¥å£å±‚ï¼Œå¯ä»¥æ˜¯åº•å±‚setupæ—¶æ³¨å…¥ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒæ–¹çš„å…¶ä»–åˆé€‚çš„ä½ç½®æ³¨å…¥ã€‚</li></ul><h4 id="ä¸Šå±‚"><a href="#ä¸Šå±‚" class="headerlink" title="ä¸Šå±‚"></a>ä¸Šå±‚</h4><ul><li>ä¸Šå±‚åªä¾èµ–æ¥å£å±‚ï¼Œé€šè¿‡æ¥å£å±‚è°ƒç”¨åº•å±‚æ–¹æ³•ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;é¢å‘æ¥å£ç¼–ç¨‹ä¸ä¸é¢å‘å¯¹è±¡ç¼–ç¨‹åŒçº§ï¼Œè€Œæ˜¯é™„å±äºé¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹æ€æƒ³çš„ç²¾é«“ä¹‹ä¸€ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;å®šä¹‰&quot;&gt;&lt;a href=&quot;#å®šä¹‰&quot; class=&quot;headerlink&quot; title=&quot;å®šä¹‰&quot;&gt;&lt;/a&gt;å®šä¹‰&lt;/h3&gt;&lt;b
      
    
    </summary>
    
      <category term="code-mind" scheme="https://fusugz.github.io/categories/code-mind/"/>
    
    
      <category term="protocol" scheme="https://fusugz.github.io/tags/protocol/"/>
    
  </entry>
  
  <entry>
    <title>ARKitåº”ç”¨ä¹‹å¯¼èˆª</title>
    <link href="https://fusugz.github.io/2019/02/19/arkit-navigation/"/>
    <id>https://fusugz.github.io/2019/02/19/arkit-navigation/</id>
    <published>2019-02-19T06:39:03.000Z</published>
    <updated>2019-02-19T06:43:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h1><p>ARKit 2.0å‘å¸ƒä»¥æ¥ï¼ŒiOSç«¯ARç±»åº”ç”¨å±‚å‡ºä¸ç©·ã€‚ç”±äºå…¶å¼ºå¤§çš„åŠŸèƒ½ï¼Œè®¸å¤šäººä»¬å¯¹äºARåº”ç”¨çš„ç¾å¥½è®¾æƒ³éƒ½ä¸€ä¸€å®ç°ã€‚<br>ARï¼ˆAugmented Realityï¼‰çš„æœ€åˆå®šä¹‰ï¼Œå°±æ˜¯å¢å¼ºç°å®ï¼ˆæˆ–æ‰©å¢ç°å®ï¼‰ï¼Œå³åœ¨å¤–éƒ¨è®¾å¤‡çš„è¾…åŠ©ä¸‹å¢å¼ºç°å®ç”Ÿæ´»çš„æ„Ÿå®˜ä½“éªŒã€‚ARçš„æœ¬è´¨ä¹Ÿæ˜¯è™šæ‹Ÿï¼Œæ˜¯åœ¨ç°å®ä¸–ç•Œä¹‹ä¸Šå åŠ è™šæ‹Ÿåœºæ™¯ä»¥æä¾›æ›´åŠ ç›´è§‚æˆ–æœ‰è¶£çš„ä¿¡æ¯ã€‚<br>åŸºäºè¿™ä¸€å®šä¹‰ï¼Œäººä»¬å¾ˆå®¹æ˜“æƒ³åˆ°åˆ©ç”¨ARçœ‹åˆ°å‘¨è¾¹è¡—æ™¯ä¸­è¢«é®æŒ¡çš„éƒ¨åˆ†ï¼Œå¹¶æ˜¾ç¤ºå…¶åŸºæœ¬ä¿¡æ¯çš„åº”ç”¨åœºæ™¯ã€‚åˆ©ç”¨æ‰‹æœºè¿™ä¸€å¤–éƒ¨è¾…åŠ©è®¾å¤‡ï¼Œå†…ç½®æ‘„åƒå¤´æ•æ‰åˆ°çš„ç”»é¢å°±æ˜¯ç°å®æ™¯è§‚ï¼Œå¼€å‘è€…å¯ä»¥åœ¨æ‘„åƒå¤´çš„å®æ™¯ä¹‹ä¸Šæ·»åŠ æƒ³è¦æ·»åŠ çš„3Dæ ‡æ³¨ï¼Œå¹¶é™„ä»¥æœ‰ç”¨çš„ä¿¡æ¯ï¼Œç®€å•çš„ARå¯¼èˆªå°±å¾—èƒ½ä»¥å®ç°ã€‚</p><h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><p>è¯¥åŠŸèƒ½çš„å®ç°æ ¸å¿ƒæ˜¯åŸºäºCoreLocationçš„å®æ—¶å®šä½åŠŸèƒ½ä¸ARKitçš„å›¾å±‚çš„ç»“åˆã€‚å®ç°çš„åŸºç¡€é™¤ARKitå’ŒiOS 11.0+ä»¥å¤–ï¼Œè¿˜å€Ÿé‰´äº†GitHubå¼€æºé¡¹ç›®<a href="https://github.com/ProjectDent/ARKit-CoreLocation" target="_blank" rel="noopener">ARKit+CoreLocation</a>æä¾›çš„<code>ARCL</code>å·¥å…·ç±»ï¼Œå»ºè®®é¦–å…ˆä»”ç»†é˜…è¯»æ­¤é¡¹ç›®ä¸­æºç ï¼Œé¢†æ‚Ÿå®ç°æ€æƒ³å’Œé€»è¾‘ã€‚</p><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><h2 id="å‰æœŸå‡†å¤‡å·¥ä½œ"><a href="#å‰æœŸå‡†å¤‡å·¥ä½œ" class="headerlink" title="å‰æœŸå‡†å¤‡å·¥ä½œ"></a>å‰æœŸå‡†å¤‡å·¥ä½œ</h2><p>é¡¹ç›®ä¸­ä»£ç ä½¿ç”¨Swift 4.2 ç¼–å†™ã€‚<br>1.é¦–å…ˆï¼Œåœ¨é¡¹ç›®ä¸­å¼•å…¥ä¸Šæ–‡ä¸­æåˆ°çš„ <code>ARCL</code>ä¸­çš„<code>Source</code>éƒ¨åˆ†ï¼Œæˆ–è€…ç›´æ¥pod â€˜ARCLâ€™ã€‚<br>å…¶ä¸­å„æ–‡ä»¶ä¸­ä»£ç çš„ä½œç”¨å¯ä»¥ä»ä»–ä»¬çš„å‘½åä¸­ä¸€ç›®äº†ç„¶ï¼Œè¿™é‡Œå°±ä¸åšèµ˜è¿°ï¼Œå‚è§ä»¥ä¸‹æ–‡ä»¶ç›®å½•ç»“æ„ï¼š</p><blockquote><p>Source<br>â”œâ”€â”€ CGPoint+Extensions.swift<br>â”œâ”€â”€ CLLocation+Extensions.swift<br>â”œâ”€â”€ FloatingPoint+Radians.swift<br>â”œâ”€â”€ LocationManager.swift<br>â”œâ”€â”€ LocationNode.swift<br>â”œâ”€â”€ SCNNode+Extensions.swift<br>â”œâ”€â”€ SCNVector3+Extensions.swift<br>â”œâ”€â”€ SceneLocationEstimate+Extensions.swift<br>â”œâ”€â”€ SceneLocationEstimate.swift<br>â””â”€â”€ SceneLocationView.swift</p></blockquote><p>2.åœ¨Plistä¸­åŠ å…¥NSCameraUsageDescriptionå’ŒNSLocationWhenInUseUsageDescriptionçš„keyå¹¶æ·»åŠ ç®€çŸ­æè¿°ã€‚</p><ol start="3"><li>æ”¹å†™<code>ARCL</code>ä¸­çš„<code>LocationNode.swift</code>,å³æ„é€ ä½ éœ€è¦çš„æ ‡æ³¨æ ·å¼å’Œå†…å®¹ã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">open class LocationAnnotationNode: LocationNode &#123;</span><br><span class="line">    ///An image to use for the annotation</span><br><span class="line">    ///When viewed from a distance, the annotation will be seen at the size provided</span><br><span class="line">    ///e.g. if the size is 100x100px, the annotation will take up approx 100x100 points on screen.</span><br><span class="line">    public let image: UIImage</span><br><span class="line"></span><br><span class="line">    ///Subnodes and adjustments should be applied to this subnode</span><br><span class="line">    ///Required to allow scaling at the same time as having a 2D &apos;billboard&apos; appearance</span><br><span class="line">    public let annotationNode: SCNNode</span><br><span class="line"></span><br><span class="line">    ///Whether the node should be scaled relative to its distance from the camera</span><br><span class="line">    ///Default value (false) scales it to visually appear at the same size no matter the distance</span><br><span class="line">    ///Setting to true causes annotation nodes to scale like a regular node</span><br><span class="line">    ///Scaling relative to distance may be useful with local navigation-based uses</span><br><span class="line">    ///For landmarks in the distance, the default is correct</span><br><span class="line">    public var scaleRelativeToDistance = false</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public init(location: CLLocation?, image: UIImage, title: String, distance: String) &#123;</span><br><span class="line">        self.image = image</span><br><span class="line"></span><br><span class="line">        let frame: CGRect = CGRect(x:0.0, y:0.0, width:200.0, height:82.0)</span><br><span class="line">        let bgImageView = UIImageView.init(frame: frame)</span><br><span class="line">        bgImageView.image = image</span><br><span class="line"></span><br><span class="line">        let titleLabel = UILabel.init(frame: CGRect(x: 0.0, y: 0.0, width: 120.0, height: 60.0))</span><br><span class="line">        titleLabel.textColor = UIColor.darkText</span><br><span class="line">        titleLabel.font = UIFont.boldSystemFont(ofSize: 18.0)</span><br><span class="line">        titleLabel.text = title</span><br><span class="line">        titleLabel.textAlignment = NSTextAlignment.center</span><br><span class="line">        bgImageView.addSubview(titleLabel)</span><br><span class="line"></span><br><span class="line">        let distanceLabel = UILabel.init(frame: CGRect(x: 120.0, y: 0.0, width: 80.0, height: 60.0))</span><br><span class="line">        distanceLabel.textColor = UIColor.init(red: 19.0/255.0, green: 115.0/255.0, blue: 114.0/255.0, alpha: 1.0)</span><br><span class="line">        distanceLabel.font = UIFont.systemFont(ofSize: 16.0)</span><br><span class="line">        distanceLabel.text = distance</span><br><span class="line">        distanceLabel.textAlignment = NSTextAlignment.center</span><br><span class="line">        bgImageView.addSubview(distanceLabel)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        let plane = SCNPlane(width: frame.size.width/100, height: frame.size.height/100)</span><br><span class="line">        plane.firstMaterial!.diffuse.contents = bgImageView</span><br><span class="line">        plane.firstMaterial!.lightingModel = .constant</span><br><span class="line"></span><br><span class="line">        annotationNode = SCNNode()</span><br><span class="line">        annotationNode.geometry = plane</span><br><span class="line"></span><br><span class="line">        super.init(location: location)</span><br><span class="line"></span><br><span class="line">        self.name = title</span><br><span class="line">        self.distance = distance</span><br><span class="line">        self.distanceLabel = distanceLabel</span><br><span class="line"></span><br><span class="line">        let billboardConstraint = SCNBillboardConstraint()</span><br><span class="line">        billboardConstraint.freeAxes = SCNBillboardAxis.Y</span><br><span class="line">        constraints = [billboardConstraint]</span><br><span class="line"></span><br><span class="line">        addChildNode(annotationNode)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ol><p><strong>ä»¥ä¸Šä»£ç çš„ä½œç”¨æ˜¯ä½¿ç”¨ä½ç½®åç§°å’Œè·ç¦»åˆ›å»ºæ ‡æ³¨ï¼Œè¿”å›ä¸€ä¸ªå¸¦æ ‡é¢˜å’Œè·ç¦»ä¿¡æ¯çš„æ°”æ³¡ï¼Œæ³¨æ„ï¼šè¿™é‡Œçš„è·ç¦»æ˜¯å®æ—¶å˜åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨åˆå§‹åŒ–æ—¶ç»™å®šä¸€ä¸ªåˆå§‹å€¼ï¼Œè€Œåœ¨è·å–åˆ°çš„ä½ç½®ä¿¡æ¯åé€šè¿‡è®¡ç®—å®æ—¶è¿›è¡Œæ›´æ–°ï¼Œä»¥è¾¾åˆ°åŠ¨æ€æ›´æ–°åœºæ™¯çš„æ•ˆæœ</strong></p><h2 id="å‘ˆç°"><a href="#å‘ˆç°" class="headerlink" title="å‘ˆç°"></a>å‘ˆç°</h2><p>åœ¨ä»¥ä¸Šå‡†å¤‡å·¥ä½œçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å°†ARæ ‡æ³¨å®æ—¶å‘ˆç°åœ¨æ‘„åƒå¤´ä¸­ã€‚<br>å› æ­¤æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–<code>SceneLocationView</code>å’Œ<code>MKMapView</code>,å¹¶å®Œæˆç›¸å…³é…ç½®ã€‚</p><ul><li><p>åˆå§‹åŒ–<code>sceneLocationView</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sceneLocationView.locationDelegate = self as? SceneLocationViewDelegate</span><br><span class="line">        // Set to true to display am arrow wjoch points north.</span><br><span class="line">        sceneLocationView.orientToTrueNorth = false</span><br><span class="line">        sceneLocationView.showAxesNode = true</span><br><span class="line">        if displayDebugging &#123;</span><br><span class="line">            sceneLocationView.showFeaturePoints = true</span><br><span class="line">        &#125;</span><br><span class="line">        buildData().forEach &#123;</span><br><span class="line">            sceneLocationView.addLocationNodeWithConfirmedLocation(locationNode: $0)</span><br><span class="line">        &#125;</span><br><span class="line">        view.addSubview(sceneLocationView)</span><br></pre></td></tr></table></figure></li><li><p>åˆå§‹åŒ–<code>mapView</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if !showMapView &#123;</span><br><span class="line">            mapView.delegate = self as? MKMapViewDelegate</span><br><span class="line">            mapView.showsUserLocation = true</span><br><span class="line">            mapView.isHidden = true</span><br><span class="line">            view.addSubview(mapView)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li></ul><p>ä½¿ç”¨<code>LocationAnnotationNode</code>çš„<code>init</code>æ–¹æ³•åˆ›å»ºæ ‡æ³¨ç‚¹ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">func buildNode(latitude: CLLocationDegrees, longtitude: CLLocationDegrees, altitude: CLLocationDistance, imageName: String, title: String, distance: String) -&gt; LocationAnnotationNode &#123;</span><br><span class="line">        let location = CLLocation(coordinate: CLLocationCoordinate2D(latitude: latitude, longitude: longtitude), altitude: altitude)</span><br><span class="line">        let image = UIImage(named: imageName)!</span><br><span class="line"></span><br><span class="line">        return LocationAnnotationNode(location: location, image: image, title: title, distance: distance)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å†åˆ©ç”¨å®šæ—¶å™¨è¿ç»­ä¸”é—´æ–­åœ°æ›´æ–°æ ‡æ³¨ä¿¡æ¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// Update user location and show distance from current location to nodes added</span><br><span class="line">updateUserLocationTimer = Timer.scheduledTimer(timeInterval: 3.0,</span><br><span class="line">                                                       target: self,</span><br><span class="line">                                                       selector: #selector(ViewController.updateUserLocation),</span><br><span class="line">                                                       userInfo: nil,</span><br><span class="line">                                                       repeats: true)</span><br></pre></td></tr></table></figure></p><p>åœ¨é€‚å½“çš„æ—¶å€™æ›´æ–°è·ç¦»ä¿¡æ¯å³å¯ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@objc func updateUserLocation() &#123;</span><br><span class="line">        guard let currentLocation = sceneLocationView.currentLocation() else &#123;</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        DispatchQueue.main.async &#123;</span><br><span class="line">            if let bestEstimate = self.sceneLocationView.bestLocationEstimate(), let position = self.sceneLocationView.currentScenePosition() &#123;</span><br><span class="line">                print(&quot;------------------------------------&quot;)</span><br><span class="line">                print(&quot;Fetch current location&quot;)</span><br><span class="line">                print(&quot;Best location estimate, position: \(bestEstimate.position), location: \(bestEstimate.location.coordinate), accurace: \(bestEstimate.location.horizontalAccuracy)&quot;)</span><br><span class="line">                print(&quot;current position: \(position)&quot;)</span><br><span class="line"></span><br><span class="line">                let translation = bestEstimate.translatedLocation(to: position)</span><br><span class="line">                print(&quot;translation: \(translation)&quot;)</span><br><span class="line">                print(&quot;translated location: \(currentLocation)&quot;)</span><br><span class="line">                print(&quot;------------------------------------&quot;)</span><br><span class="line"></span><br><span class="line">                // Location nodes</span><br><span class="line">                for node in self.sceneLocationView.locationNodes &#123;</span><br><span class="line">                    let distance = currentLocation.distance(from: node.location)</span><br><span class="line">                    var distanceStr: String = String(format: &quot;%.0fm&quot;, distance)</span><br><span class="line">                    if distance &gt;= 1000 &#123;</span><br><span class="line">                        distanceStr = String(format: &quot;%.1fkm&quot;, (distance/1000))</span><br><span class="line">                    &#125;</span><br><span class="line">                    node.distance = distanceStr</span><br><span class="line">                    node.distanceLabel.text = distanceStr</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Šã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚è¿°&lt;/h1&gt;&lt;p&gt;ARKit 2.0å‘å¸ƒä»¥æ¥ï¼ŒiOSç«¯ARç±»åº”ç”¨å±‚å‡ºä¸ç©·ã€‚ç”±äºå…¶å¼ºå¤§çš„åŠŸèƒ½ï¼Œè®¸å¤šäººä»¬å¯¹äºARåº”ç”¨çš„ç¾å¥½è®¾æƒ³éƒ½ä¸€ä¸€å®ç°ã€‚&lt;br&gt;ARï¼ˆAugme
      
    
    </summary>
    
    
      <category term="ARKit" scheme="https://fusugz.github.io/tags/ARKit/"/>
    
      <category term="Navigation" scheme="https://fusugz.github.io/tags/Navigation/"/>
    
  </entry>
  
  <entry>
    <title>EasyARåº”ç”¨ä¹‹iOSåŸç”Ÿè§†é¢‘æ’­æ”¾ã€è„±å¡ã€‘</title>
    <link href="https://fusugz.github.io/2018/12/04/easyar-tuoka/"/>
    <id>https://fusugz.github.io/2018/12/04/easyar-tuoka/</id>
    <published>2018-12-04T13:11:34.000Z</published>
    <updated>2018-12-24T13:43:10.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/2251123-2e100649d08e4d29.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è™¹è—ä¸è§"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™æ˜¯EasyARåº”ç”¨ç³»åˆ—çš„ç¬¬äºŒç¯‡ï¼Œé’ˆå¯¹ARè§†é¢‘æ’­æ”¾ï¼Œâ€œè„±å¡â€åŠŸèƒ½æ˜¯äºŸå¾…è§£å†³çš„é—®é¢˜ã€‚<br>ç„¶è€Œï¼ŒEasyARçš„æ–‡æ¡£ä¸­æ²¡æœ‰å…³äºiOSåŸç”Ÿè„±å¡çš„å…·ä½“å®ç°æ–¹å¼ï¼Œè®ºå›ä¸­æé—®ä¹Ÿæ²¡æœ‰å¾—åˆ°æœ‰ç”¨çš„å›ç­”ã€‚ç„¶è€Œï¼Œåœ¨æ—§ç‰ˆè®ºå›çš„<a href="http://bbs.sightp.com/forum.php?mod=viewthread&amp;tid=11643&amp;highlight=iOS" target="_blank" rel="noopener">è¯·é—® iOS è¯†åˆ«å¥½å æ’­æ”¾è§†é¢‘å°ºå¯¸æ”¹å˜é—®é¢˜</a>ä¸­ï¼ŒEasyARSupportç»™å‡ºäº†è§†é¢‘å§¿æ€å’Œå°ºå¯¸çš„ä¿®æ”¹æ–¹æ³•ï¼Œä»£ç ç”±Cè¯­è¨€ç¼–å†™ã€‚<br><img src="https://upload-images.jianshu.io/upload_images/2251123-72cbbd7d0af4c00d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ä¿®æ”¹å§¿æ€å’Œå°ºå¯¸"><br>ç¬”è€…ä»è¯¥æ–¹æ³•ä¸­å¾—åˆ°å¯å‘ï¼š</p><blockquote><p>è¿½è¸ªå™¨æ•æ‰åˆ°ç›®æ ‡å›¾åƒåï¼Œè‹¥ç›®æ ‡å›¾åƒè„±ç¦»æ‘„åƒå¤´èŒƒå›´æ—¶ï¼Œå¯ä»¥è°ƒæ•´è§†é¢‘çš„å§¿æ€å’Œå°ºå¯¸ï¼Œä½¿è§†é¢‘ä»ä½äºè§†å›¾çš„ä¸­å¤®å¹¶ç»´æŒåŸå°ºå¯¸ï¼Œè„±å¡é—®é¢˜å°±è¿åˆƒè€Œè§£ã€‚</p></blockquote><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><ul><li>åˆ†æå®ç°åŸç†<br>æ ¹æ®EasyARSupportæä¾›çš„ä»£ç æˆªå›¾ï¼Œå¯ä»¥å¾—çŸ¥ä»£ç åšäº†ä¸¤ä»¶äº‹ï¼š</li></ul><ol><li>åˆå§‹åŒ–ä¸€ä¸ª<code>cameraView</code>å¹¶ä¸ºå…¶`dataâ€™å±æ€§èµ‹å€¼ï¼Œå…¶ä¸­çš„ä¸‹æ ‡ä¸º12çš„æ•°å€¼å†³å®šäº†è§†é¢‘çš„å¯è§èŒƒå›´ï¼Œä¸ºå…³é”®å‚æ•°ã€‚</li><li>ä¸ºè§†é¢‘æ¸²æŸ“æä¾›äº†ä¸€ä¸ªå°ºå¯¸ï¼Œç”¨æ¥è§„å®šè§†é¢‘çš„å°ºå¯¸æ¯”ä¾‹ã€‚<br>å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºè§£å†³æ–¹æ¡ˆï¼šåœ¨é€‚å½“çš„æ—¶æœºè°ƒæ•´è§†é¢‘çš„å§¿æ€å’Œå°ºå¯¸ï¼Œå¹¶å®ç°ç»§ç»­æ’­æ”¾è§†é¢‘ã€‚</li></ol><ul><li>å¯»æ‰¾é€‚å½“çš„æ—¶æœº<br>åœ¨å®ä¾‹ä»£ç çš„helloar.mçš„ <code>render()</code>å‡½æ•°ä¸­ï¼Œ<code>targetInstances</code>ä¸ºè·å–åˆ°çš„ç›®æ ‡å®ä¾‹ï¼Œå½“ç›®æ ‡å®ä¾‹çš„<code>count &gt; 0&#39;å³è¢«è®¤ä¸ºè¿½è¸ªåˆ°ç›®æ ‡ï¼Œæ­¤æ—¶æˆ‘ä»¬è¿›è¡Œä¸€ç³»åˆ—è§†é¢‘æ¸²æŸ“å·¥ä½œï¼›è€Œå½“å…¶</code>count &gt; 0`ä¸æˆç«‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºç›®æ ‡å·²è„±ç¦»æ‘„åƒå¤´å¯è§†èŒƒå›´ï¼Œæ­¤æ—¶å³ä¸ºé€‚å½“çš„å®é™…ã€‚</li><li>å®ç°è„±å¡<br>æ ¹æ®ä¸Šæ–‡ä¸­Cè¯­è¨€ä»£ç æ˜¯å‚è€ƒï¼Œæˆ‘ä»¬å¯ä»¥ç›¸åº”åœ°ç¼–å†™OCå®ç°ä»£ç ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if (imagetargetSize != nil) &#123; // è„±å¡</span><br><span class="line">// data[12] = 0; ä¸Šä¸‹ä½ç½®å‚æ•° -0.5(æœ€ä¸Š)ï¼Œ 0ï¼ˆä¸­ï¼‰ï¼Œ 0.5ï¼ˆæœ€ä¸‹ï¼‰</span><br><span class="line">NSArray *data = @[@0, @-1, @0, @0, @-1, @0, @0, @0, @0, @0, @1, @0, @0, @0, @-1, @1]; </span><br><span class="line">easyar_Matrix44F *cameraView = [easyar_Matrix44F create:data];</span><br><span class="line">easyar_Vec2F *size = [easyar_Vec2F create:@[@1.0f, @1.0f]];</span><br><span class="line"></span><br><span class="line">[current_video_renderer render:[camera projectionGL:0.2f farPlane:500.f] cameraview:cameraView size:size];</span><br><span class="line">[video update];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>å…¶ä¸­çš„<code>imagetargetSize</code>åˆå§‹å€¼ä¸ºnil,å¹¶åœ¨<code>count &gt; 0</code>ä¸­ç”±<code>[imagetarget size]</code>çš„å€¼èµ‹äºˆã€‚å…¶å†…åœ¨é€»è¾‘æ˜¯ï¼Œ<code>imagetargetSize</code>ç”¨äºåˆ¤æ–­ç›®æ ‡æ˜¯å¦æ›¾è¢«è¿½è¸ªå™¨è·å–ï¼Œè‹¥æœªè·å–ï¼Œåˆ™è§†é¢‘ä¹Ÿè¿˜ä¸ç¡®å®šï¼Œä¹Ÿå°±ä¸å­˜åœ¨è°ƒæ•´å§¿æ€äº†ã€‚</p><h1 id="ç»¼è¿°"><a href="#ç»¼è¿°" class="headerlink" title="ç»¼è¿°"></a>ç»¼è¿°</h1><p>ä»¥ä¸Šï¼ŒiOSåŸç”Ÿè§†é¢‘è§†é¢‘æ’­æ”¾çš„â€œè„±å¡â€åŠŸèƒ½å¾—ä»¥å®ç°ã€‚<br>è¿™é‡Œæœ‰<a href="https://github.com/fusugz/easyarVideo/blob/master/helloarvideo/helloar_offcark.m" target="_blank" rel="noopener">helloar_offcard.m</a>ä¾›å‚è€ƒã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2251123-2e100649d08e4d29.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="EasyAR" scheme="https://fusugz.github.io/categories/EasyAR/"/>
    
    
      <category term="EasyAR" scheme="https://fusugz.github.io/tags/EasyAR/"/>
    
  </entry>
  
  <entry>
    <title>ARKitåº”ç”¨ä¹‹è¯†åˆ«å›¾åƒæ’­æ”¾è§†é¢‘</title>
    <link href="https://fusugz.github.io/2018/11/20/recognizing-images-to-play-video/"/>
    <id>https://fusugz.github.io/2018/11/20/recognizing-images-to-play-video/</id>
    <published>2018-11-20T13:23:50.000Z</published>
    <updated>2018-11-20T13:39:50.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/2251123-7af2c7a08693ad96.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å§é—»æµ·æ£ èŠ±"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ARKitä¸ºiOSç³»ç»Ÿæä¾›äº†å¯¹å›¾åƒçš„è¯†åˆ«åŠŸèƒ½ã€‚å¯é€šè¿‡æ£€æµ‹ç”¨æˆ·ç¯å¢ƒä¸­çš„å·²çŸ¥2Då›¾åƒï¼Œä½¿ç”¨å…¶ä½ç½®æ”¾ç½®ARå†…å®¹ã€‚å…¶ä¸­çš„ARå†…å®¹å¯ä»¥æ˜¯ä¸€ä¸ªç«‹ä½“æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€å¼ å›¾ç‰‡æˆ–ä¸€ä¸ªè§†é¢‘ã€‚</p><p>è¿™ä¸€åŠŸèƒ½å¿…å°†ä½¿å¾—æœªæ¥çš„appæ›´åŠ æœ‰è¶£ï¼Œä¹Ÿè®©æˆ‘ä»¬æœ‰äº†æ–°çš„å®ç°å½¢å¼ï¼Œè®©æˆ‘ä»¬æ¥å°è¯•ä¸€ä¸‹åŸºäºARkitçš„å›¾ç‰‡è¯†åˆ«åŠŸèƒ½åœ¨appå†…æ’­æ”¾è§†é¢‘å§ã€‚</p><blockquote><p>ç¯å¢ƒï¼šiOS 11.3+ | Xcode 10.0+ </p><p>Frameworkï¼šARkit</p></blockquote><h2 id="å¯ç”¨å›¾åƒæ£€æµ‹"><a href="#å¯ç”¨å›¾åƒæ£€æµ‹" class="headerlink" title="å¯ç”¨å›¾åƒæ£€æµ‹"></a>å¯ç”¨å›¾åƒæ£€æµ‹</h2><p>é¦–å…ˆï¼Œæ„å»ºç›®æ ‡å›¾åƒ</p><p>ç›®æ ‡å›¾åƒå³é€šè¿‡æ‘„åƒå¤´æ‰«æè¯†åˆ«çš„ç›®æ ‡å›¾åƒï¼Œä½¿ç”¨è‡ªå·±çš„å›¾åƒè¿›è¡Œæ£€æµ‹ï¼Œéœ€è¦å°†ç›®æ ‡å›¾åƒæ·»åŠ åˆ°Xcodeä¸­çš„Assetsç›®å½•ä¸­ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/2251123-f25726a28248f22d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ·»åŠ ç›®æ ‡å›¾ç‰‡"></p><ol><li>æ‰“å¼€é¡¹ç›®çš„Assetsç›®å½•ï¼Œç„¶åæ·»åŠ æ–°çš„ARèµ„æºç»„ã€‚</li><li>å°†æ‰€éœ€æ·»åŠ çš„å›¾ç‰‡æ·»åŠ åˆ°åˆ›å»ºçš„èµ„æºç»„ä¸­ã€‚</li><li>å¯¹äºæ¯ä¸ªå›¾ç‰‡ï¼Œä½¿ç”¨æ£€æŸ¥å™¨æ¥æè¿°ä½ å¸Œæœ›åœ¨ç”¨æˆ·çš„çœŸå®ç¯å¢ƒä¸­æ‰¾åˆ°å®ƒçš„å›¾åƒçš„ç‰©ç†å¤§å°ã€‚ï¼ˆå¯ä½¿ç”¨é¢„è§ˆæ¥æŸ¥çœ‹å›¾ç‰‡å¤§å°ï¼Œæ³¨æ„å•ä½ï¼Œè·å–åå¿…é¡»æ·»åŠ å›¾ç‰‡çš„Sizeï¼Œå›¾ç‰‡çš„å®½é«˜ä¸å¾—å°äº480 pixelsï¼‰</li></ol><p>ä½¿ç”¨ARkitéœ€è¦å¼•å…¥æ‰€éœ€çš„ç³»ç»Ÿåº“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;SceneKit/SceneKit.h&gt;</span><br><span class="line">#import &lt;ARKit/ARKit.h&gt;</span><br></pre></td></tr></table></figure><p>åœ¨<code>viewWillAppear:</code>ä¸­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å›¾åƒ</span><br><span class="line">ARWorldTrackingConfiguration *configuration = [ARWorldTrackingConfiguration new];</span><br><span class="line">configuration.detectionImages = [ARReferenceImage referenceImagesInGroupNamed:@&quot;AR Resources&quot; bundle:nil];</span><br><span class="line"></span><br><span class="line">// åˆ›å»º&apos;world-tracking&apos;é…ç½®</span><br><span class="line">[self.sceneView.session runWithConfiguration:configuration options:ARSessionRunOptionResetTracking | ARSessionRunOptionRemoveExistingAnchors];</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨runWithConfiguration:æ–¹æ³•ä½¿ç”¨é…ç½®è¿è¡Œä¼šè¯</span><br><span class="line">[self.sceneView.session runWithConfiguration:configuration];</span><br></pre></td></tr></table></figure><h2 id="åˆå§‹åŒ–Scene-View"><a href="#åˆå§‹åŒ–Scene-View" class="headerlink" title="åˆå§‹åŒ–Scene View"></a>åˆå§‹åŒ–Scene View</h2><p>åœ¨<code>Main.storyboard</code>ä¸­æ·»åŠ <code>ARSCNView</code>,è®¾ç½®å…¨å±å¹•çº¦æŸã€‚</p><p>åœ¨<code>viewDidLoad</code>ä¸­åˆå§‹åŒ–sceneViewï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">self.sceneView.delegate = self;</span><br><span class="line">SCNScene *scene = [SCNScene new];</span><br><span class="line">self.sceneView.scene = scene;</span><br></pre></td></tr></table></figure><h2 id="å¯è§†åŒ–å›¾åƒç»“æœ"><a href="#å¯è§†åŒ–å›¾åƒç»“æœ" class="headerlink" title="å¯è§†åŒ–å›¾åƒç»“æœ"></a>å¯è§†åŒ–å›¾åƒç»“æœ</h2><p>åœ¨å‰æ–‡ä¸­æˆ‘ä»¬å·²ç»æ·»åŠ äº†è¯†åˆ«çš„ç›®æ ‡å›¾åƒï¼Œå½“åº”ç”¨ç¨‹åºæ£€æµ‹åˆ°ç›®æ ‡å›¾åƒæ—¶æˆ‘ä»¬éœ€è¦å¯è§†åŒ–å›¾åƒç»“æœï¼Œæ ¹æ®å½“å‰ç›®æ ‡ï¼Œæˆ‘ä»¬åœ¨ç›®æ ‡å›¾åƒä¸Šæ’­æ”¾è§†é¢‘ã€‚</p><p>åœ¨è¿™é‡Œï¼Œéœ€è¦å®ç°ARSCNViewDelegateä¸­çš„ä»£ç†æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - ARSCNViewDelegate</span><br><span class="line"></span><br><span class="line">- (void)renderer:(id&lt;SCNSceneRenderer&gt;)renderer didAddNode:(SCNNode *)node forAnchor:(ARAnchor *)anchor &#123;</span><br><span class="line">ARImageAnchor *imageAnchor = (ARImageAnchor *)anchor;</span><br><span class="line"></span><br><span class="line">// è·å–å‚è€ƒå›¾ç‰‡å¯¹è±¡</span><br><span class="line">ARReferenceImage *referenceImage = imageAnchor.referenceImage;</span><br><span class="line">// æ ¹æ®å›¾ç‰‡å¯¹è±¡æ’­æ”¾å¯¹åº”è§†é¢‘</span><br><span class="line">if (referenceImage.name) &#123;</span><br><span class="line">NSString *fileName = referenceImage.name;</span><br><span class="line">[self setFileForPlayerWithFileName:fileName];</span><br><span class="line"></span><br><span class="line">SCNNode *tempNode = [SCNNode new];</span><br><span class="line">CGFloat imageWidth = referenceImage.physicalSize.width;</span><br><span class="line">CGFloat imageHeight = referenceImage.physicalSize.height;</span><br><span class="line"></span><br><span class="line">SCNBox *bgBox = [SCNBox boxWithWidth:imageWidth height:imageHeight length:0.01 chamferRadius:0];</span><br><span class="line">tempNode.geometry = bgBox;</span><br><span class="line">tempNode.eulerAngles = SCNVector3Make(-M_PI/2.0, 0.0, 0.0);</span><br><span class="line">tempNode.opacity = 1.0;</span><br><span class="line"></span><br><span class="line">SCNMaterial *material = [[SCNMaterial alloc] init];</span><br><span class="line">material.diffuse.contents = self.player;</span><br><span class="line">tempNode.geometry.materials = @[material];</span><br><span class="line">[self.player play];</span><br><span class="line"></span><br><span class="line">[node addChildNode:tempNode];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)setFileForPlayerWithFileName:(NSString *)fileName &#123;</span><br><span class="line">NSString *urlStr = [[NSBundle mainBundle] pathForResource:fileName ofType:@&quot;mp4&quot;];</span><br><span class="line">NSURL *url = [NSURL fileURLWithPath:urlStr];</span><br><span class="line">AVPlayerItem *playerItem = [AVPlayerItem playerItemWithURL:url];</span><br><span class="line">self.player = [[AVPlayer alloc] initWithPlayerItem:playerItem];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°±èƒ½ç®€å•åœ°å®ç°åˆ©ç”¨ARKitè¯†åˆ«å›¾åƒå¹¶æ’­æ”¾å¯¹åº”çš„è§†é¢‘ã€‚</p><p>ä¸ºäº†æ›´åŠ æ¸…æ¥šçš„å±•ç°ï¼Œé™„ä¸Šä»£ç ä»¥ä¾›å‚è€ƒï¼š<a href="https://github.com/fusugz/RecognizingImagesToPlayVideo" target="_blank" rel="noopener">RecognizingImagesToPlayVideo</a></p><p>å…¶ä¸­çš„è§†é¢‘æ–‡ä»¶å¯å‰å¾€<a href="http://img.dpm.org.cn/Uploads/File/2018/04/19/haitang.mp4" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½ï¼Œå½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç›¸åº”ä¿®æ”¹é¡¹ç›®ä¸­é…ç½®æ›´æ¢ä½ çš„ç›®æ ‡å›¾åƒå’Œè§†é¢‘æ–‡ä»¶ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2251123-7af2c7a08693ad96.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="ARKit" scheme="https://fusugz.github.io/categories/ARKit/"/>
    
    
      <category term="ARKit" scheme="https://fusugz.github.io/tags/ARKit/"/>
    
  </entry>
  
  <entry>
    <title>iOSåŸºç¡€çŸ¥è¯†æ•´ç†ä¹‹Notification Center</title>
    <link href="https://fusugz.github.io/2018/11/09/notification-center/"/>
    <id>https://fusugz.github.io/2018/11/09/notification-center/</id>
    <published>2018-11-09T02:53:51.000Z</published>
    <updated>2018-11-09T02:56:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Notification-Center"><a href="#Notification-Center" class="headerlink" title="Notification Center"></a>Notification Center</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><blockquote><p>é€šè¿‡é€šçŸ¥ä¸­å¿ƒå‘æ‰€æœ‰æ³¨å†Œè§‚å¯Ÿè€…å¹¿æ’­çš„ä¿¡æ¯å®¹å™¨<br>å®ƒæ˜¯ä¸€ä¸ªå•ä¾‹å¯¹è±¡ï¼Œå…è®¸å½“äº‹æƒ…å‘ç”Ÿæ—¶é€šçŸ¥ä¸€äº›å¯¹è±¡ï¼Œè®©å¯¹è±¡ä½œå‡ºç›¸åº”ååº”ã€‚<br>å®ƒå…è®¸æˆ‘ä»¬åœ¨ä½ç¨‹åº¦è€¦åˆçš„æƒ…å†µä¸‹ï¼Œæ»¡è¶³æ§åˆ¶å™¨ä¸ä¸€ä¸ªä»»æ„çš„å¯¹è±¡è¿›è¡Œé€šä¿¡çš„ç›®çš„ã€‚<br>è¿™ç§æ¨¡å¼çš„åŸºæœ¬ç‰¹å¾æ˜¯ä¸ºäº†è®©å…¶ä»–çš„å¯¹è±¡èƒ½å¤Ÿæ¥æ”¶åˆ°æŸç§äº‹ä»¶ä¼ é€’è¿‡æ¥çš„é€šçŸ¥ï¼Œä¸»è¦ä½¿ç”¨é€šçŸ¥åç§°æ¥å‘é€å’Œæ¥æ”¶é€šçŸ¥ã€‚<br>åŸºæœ¬ä¸Šä¸ç”¨è€ƒè™‘å…¶ä»–å½±å“å› ç´ ï¼Œåªéœ€è¦ä½¿ç”¨åŒæ ·çš„é€šçŸ¥åç§°ï¼Œç›‘å¬è¯¥é€šçŸ¥çš„å¯¹è±¡ï¼ˆå³è§‚å¯Ÿè€…ï¼‰å†å¯¹é€šçŸ¥åšå‡ºååº”å³å¯ã€‚</p></blockquote><h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><h3 id="1-ä¼˜ç‚¹"><a href="#1-ä¼˜ç‚¹" class="headerlink" title="1.ä¼˜ç‚¹"></a>1.ä¼˜ç‚¹</h3><ul><li><p>ä»£ç ç®€çŸ­ï¼Œå®ç°ç®€å•ï¼›</p></li><li><p>å¯¹äºä¸€ä¸ªå‘å‡ºçš„é€šçŸ¥ï¼Œå¤šä¸ªå¯¹è±¡èƒ½å¤Ÿåšå‡ºååº”ï¼Œç®€å•å®ç°ä¸€å¯¹å¤šçš„æ–¹å¼ï¼Œè¾ƒä¹‹äºDelegateå¯ä»¥å®ç°æ›´å¤§è·¨åº¦çš„é€šä¿¡æœºåˆ¶ï¼›</p></li><li><p>èƒ½å¤Ÿé€šè¿‡objectå’ŒuserInfoä¼ é€’å‚æ•°ï¼Œobjectå’ŒuserInfoå¯ä»¥æºå¸¦å‘é€é€šçŸ¥æ—¶ä¼ é€’çš„ä¿¡æ¯ã€‚</p></li></ul><h3 id="2-ç¼ºç‚¹"><a href="#2-ç¼ºç‚¹" class="headerlink" title="2.ç¼ºç‚¹"></a>2.ç¼ºç‚¹</h3><ul><li><p>åœ¨ç¼–è¯‘æœŸé—´ä¸ä¼šæ£€æŸ¥é€šçŸ¥æ˜¯å¦èƒ½å¤Ÿè¢«è§‚å¯Ÿè€…æ­£ç¡®å¤„ç†ï¼›</p></li><li><p>åœ¨é‡Šæ”¾é€šçŸ¥çš„è§‚å¯Ÿè€…æ—¶ï¼Œéœ€è¦åœ¨é€šçŸ¥ä¸­å¿ƒç§»é™¤è§‚å¯Ÿè€…ï¼›</p></li><li><p>åœ¨è°ƒè¯•çš„æ—¶å€™é€šçŸ¥ä¼ é€’çš„è¿‡ç¨‹å¾ˆéš¾æ§åˆ¶å’Œè·Ÿè¸ªï¼›</p></li><li><p>å‘é€é€šçŸ¥å’Œæ¥æ”¶é€šçŸ¥çš„æ—¶å€™å¿…é¡»ä¿æŒé€šçŸ¥åç§°ä¸€è‡´ï¼›</p></li><li><p>é€šçŸ¥å‘å‡ºåï¼Œä¸èƒ½ä»è§‚å¯Ÿè€…è·å¾—ä»»ä½•åé¦ˆä¿¡æ¯ã€‚</p></li></ul><h2 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h2><h3 id="1-ä¸ä¼ å‚æ•°"><a href="#1-ä¸ä¼ å‚æ•°" class="headerlink" title="1.ä¸ä¼ å‚æ•°"></a>1.ä¸ä¼ å‚æ•°</h3><p>å‘é€é€šçŸ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] postNotificationName:@&quot;notificationWithoutParameter&quot; object:nil];</span><br></pre></td></tr></table></figure><p>ç›‘å¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notiWithoutParam) name:@&quot;notificationWithoutParameter&quot; object:nil];</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notiWithoutParam) name:@&quot;notificationWithoutParameter&quot; object:nil];</span><br></pre></td></tr></table></figure><h3 id="2-ä½¿ç”¨objectä¼ é€’å‚æ•°"><a href="#2-ä½¿ç”¨objectä¼ é€’å‚æ•°" class="headerlink" title="2.ä½¿ç”¨objectä¼ é€’å‚æ•°"></a>2.ä½¿ç”¨objectä¼ é€’å‚æ•°</h3><p>å‘é€é€šçŸ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSString *object = @&quot;notiObject&quot;;</span><br><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] postNotificationName:@&quot;notificationWithObject&quot; object:object];</span><br></pre></td></tr></table></figure><p>ç›‘å¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notiWithObject:) name:@&quot;notificationWithObject&quot; object:nil];</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (void)notiWithObject:(NSNotification *)notiication &#123;</span><br><span class="line"></span><br><span class="line">    id object = notiication.object;</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;Received the notification with object&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-ä½¿ç”¨userInfoä¼ é€’å‚æ•°"><a href="#3-ä½¿ç”¨userInfoä¼ é€’å‚æ•°" class="headerlink" title="3.ä½¿ç”¨userInfoä¼ é€’å‚æ•°"></a>3.ä½¿ç”¨userInfoä¼ é€’å‚æ•°</h3><p>å‘é€é€šçŸ¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSDictionary *userInfoDict = @&#123;@&quot;userInfo&quot;:@&quot;130293739&quot;&#125;;</span><br><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] postNotificationName:@&quot;notificationWithUserInfo&quot; object:nil userInfo:userInfoDict];</span><br></pre></td></tr></table></figure><p>ç›‘å¬</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notiWithUserInfo:) name:@&quot;notificationWithUserInfo&quot; object:nil];</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (void)notiWithUserInfo:(NSNotification *)notiication &#123;</span><br><span class="line"></span><br><span class="line">    NSDictionary *userInfo = notiication.userInfo;</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;Received the notification with userInfo:%@&quot;,userInfo);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Notification-Center&quot;&gt;&lt;a href=&quot;#Notification-Center&quot; class=&quot;headerlink&quot; title=&quot;Notification Center&quot;&gt;&lt;/a&gt;Notification Center&lt;/h1&gt;&lt;h2 i
      
    
    </summary>
    
      <category term="Objective-C" scheme="https://fusugz.github.io/categories/Objective-C/"/>
    
    
      <category term="NSNotificationCenter" scheme="https://fusugz.github.io/tags/NSNotificationCenter/"/>
    
  </entry>
  
  <entry>
    <title>iOSåŸºç¡€çŸ¥è¯†æ•´ç†ä¹‹äº‹ä»¶ä¼ é€’å“åº”é“¾</title>
    <link href="https://fusugz.github.io/2018/11/09/responder-chain/"/>
    <id>https://fusugz.github.io/2018/11/09/responder-chain/</id>
    <published>2018-11-09T02:48:55.000Z</published>
    <updated>2018-11-09T02:53:28.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="äº‹ä»¶ä¼ é€’å“åº”é“¾"><a href="#äº‹ä»¶ä¼ é€’å“åº”é“¾" class="headerlink" title="äº‹ä»¶ä¼ é€’å“åº”é“¾"></a>äº‹ä»¶ä¼ é€’å“åº”é“¾</h1><h2 id="UIResponder"><a href="#UIResponder" class="headerlink" title="UIResponder"></a>UIResponder</h2><p>åœ¨iOSä¸­ï¼Œèƒ½å¤Ÿå“åº”äº‹ä»¶çš„å¯¹è±¡éƒ½æ˜¯UIResponderçš„å­ç±»å¯¹è±¡ã€‚UIResponderæä¾›äº†å››ä¸ªç‚¹å‡»çš„å›è°ƒæ–¹æ³•ï¼Œåˆ†åˆ«å¯¹åº”ç”¨æˆ·ç‚¹å‡»å¼€å§‹ã€ç§»åŠ¨ã€ç»“æŸå’Œå–æ¶ˆï¼Œå…¶ä¸­åªæœ‰åœ¨ç¨‹åºå¼ºåˆ¶é€€å‡ºæˆ–è€…æ¥ç”µæ—¶ï¼Œå–æ¶ˆç‚¹å‡»äº‹ä»¶æ‰ä¼šè°ƒç”¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)touchesEnded:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)touchesMoved:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)touchesCancelled:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event &#123;&#125;</span><br></pre></td></tr></table></figure><p>##1. å“åº”é“¾çš„ä¼ é€’</p><p>iOSåº”ç”¨ç¨‹åºåŠ è½½æ—¶ä¼šå…ˆæ‰§è¡Œmainå‡½æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">int main(int argc, char * argv[]) &#123;</span><br><span class="line"></span><br><span class="line">    @autoreleasepool &#123;</span><br><span class="line"></span><br><span class="line">        return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾æ¬¡åŠ è½½ï¼šUIApplication-&gt;AppDelegate-&gt;UIWindow-&gt;UIViewController-&gt;superView-&gt;subviews</p><p>å…³ç³»ä¸ºï¼š[UIApplication sharedApplication].keyWindow.rootViewController.view.subviews</p><h3 id="äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’"><a href="#äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’" class="headerlink" title="äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’"></a>äº‹ä»¶çš„äº§ç”Ÿå’Œä¼ é€’</h3><ul><li><p>å‘ç”Ÿè§¦æ‘¸äº‹ä»¶åï¼Œç³»ç»Ÿä¼šå°†è¯¥äº‹ä»¶åŠ å…¥åˆ°ä¸€ä¸ªç”±UIApplicationç®¡ç†çš„äº‹ä»¶é˜Ÿåˆ—ä¸­ã€‚</p></li><li><p>UIApplicationä¼šä»äº‹ä»¶é˜Ÿåˆ—ä¸­å–å‡ºæœ€å‰é¢çš„äº‹ä»¶ï¼Œå¹¶å°†äº‹ä»¶åˆ†å‘ä¸‹å»ä»¥ä¾¿å¤„ç†ï¼Œé€šå¸¸å…ˆå‘é€äº‹ä»¶ç»™åº”ç”¨ç¨‹åºä¸»çª—å£ï¼ˆkeyWindowï¼‰ã€‚</p></li><li><p>ä¸»çª—å£ä¼šåœ¨è§†å›¾å±‚æ¬¡ç»“æ„ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€é€‚åˆçš„è§†å›¾æ¥å¤„ç†å½“å‰è§¦æ‘¸äº‹ä»¶ï¼Œè¿™ä¹Ÿæ˜¯æ•´ä¸ªäº‹ä»¶å¤„ç†è¿‡ç¨‹çš„ç¬¬ä¸€æ­¥ã€‚</p></li><li><p>æ‰¾åˆ°åˆé€‚çš„è§†å›¾æ§ä»¶åï¼Œå°±ä¼šè°ƒç”¨è§†å›¾æ§ä»¶çš„touchesæ–¹æ³•æ¥åšå…·ä½“äº‹ä»¶çš„å¤„ç†ã€‚</p></li></ul><h2 id="2-Hit-Testingæœºåˆ¶"><a href="#2-Hit-Testingæœºåˆ¶" class="headerlink" title="2. Hit-Testingæœºåˆ¶"></a>2. Hit-Testingæœºåˆ¶</h2><p>iOSä½¿ç”¨Hit-Testingå¯»æ‰¾è§¦æ‘¸çš„viewã€‚ Hit-Testingé€šè¿‡æ£€æŸ¥è§¦æ‘¸ç‚¹æ˜¯å¦åœ¨å…³è”çš„viewè¾¹ç•Œå†…ï¼Œå¦‚æœåœ¨ï¼Œåˆ™é€’å½’åœ°ï¼ˆrecursivelyï¼‰æ£€æŸ¥è¯¥viewçš„æ‰€æœ‰å­viewã€‚åœ¨å±‚çº§ä¸Šå¤„äºæœ€è¿‘ä¸”è¾¹ç•ŒèŒƒå›´åŒ…å«è§¦æ‘¸ç‚¹çš„viewæˆä¸ºhit-test viewã€‚ç¡®å®šhit-test viewåï¼Œå®ƒä¼ é€’è§¦æ‘¸äº‹ä»¶ç»™è¯¥viewã€‚</p><p>é‡å†™<code>hitTest</code>æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    // 1.åˆ¤æ–­å½“å‰æ§ä»¶èƒ½å¦æ¥æ”¶äº‹ä»¶</span><br><span class="line"></span><br><span class="line">    if (self.userInteractionEnabled == NO || self.hidden == YES || self.alpha &lt;= 0.01) return nil;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // 2. åˆ¤æ–­ç‚¹åœ¨ä¸åœ¨å½“å‰æ§ä»¶</span><br><span class="line"></span><br><span class="line">    if ([self pointInside:point withEvent:event] == NO) return nil;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // 3.ä»åå¾€å‰éå†è‡ªå·±çš„å­æ§ä»¶</span><br><span class="line"></span><br><span class="line">    NSInteger count = self.subviews.count;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    for (NSInteger i = count - 1; i &gt;= 0; i--) &#123;</span><br><span class="line"></span><br><span class="line">        UIView *childView = self.subviews[i];</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        // æŠŠå½“å‰æ§ä»¶ä¸Šçš„åæ ‡ç³»è½¬æ¢æˆå­æ§ä»¶ä¸Šçš„åæ ‡ç³»</span><br><span class="line"></span><br><span class="line">        CGPoint childP = [self convertPoint:point toView:childView];</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        UIView *fitView = [childView hitTest:childP withEvent:event];</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        if (fitView) &#123; // å¯»æ‰¾åˆ°æœ€åˆé€‚çš„view</span><br><span class="line"></span><br><span class="line">            return fitView;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // å¾ªç¯ç»“æŸ,è¡¨ç¤ºæ²¡æœ‰æ¯”è‡ªå·±æ›´åˆé€‚çš„view</span><br><span class="line"></span><br><span class="line">    return self;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å“åº”é“¾çš„äº‹ä»¶ä¼ é€’è¿‡ç¨‹"><a href="#å“åº”é“¾çš„äº‹ä»¶ä¼ é€’è¿‡ç¨‹" class="headerlink" title="å“åº”é“¾çš„äº‹ä»¶ä¼ é€’è¿‡ç¨‹"></a>å“åº”é“¾çš„äº‹ä»¶ä¼ é€’è¿‡ç¨‹</h3><ul><li><p>å¦‚æœå½“å‰viewçš„æ§åˆ¶å™¨å­˜åœ¨ï¼Œå°±ä¼ é€’ç»™æ§åˆ¶å™¨ï¼›å¦‚æœæ§åˆ¶å™¨ä¸å­˜åœ¨ï¼Œåˆ™å°†å…¶ä¼ ç»™å®ƒçš„çˆ¶è§†å›¾ã€‚</p></li><li><p>åœ¨è§†å›¾å±‚æ¬¡ç»“æ„çš„æœ€é¡¶çº§è§†å›¾ï¼Œå¦‚æœä¹Ÿä¸èƒ½å¤„ç†æ”¶åˆ°çš„äº‹ä»¶æˆ–æ¶ˆæ¯ï¼Œæ­¤æ—¶ä¼šå°†äº‹ä»¶æˆ–æ¶ˆæ¯ä¼ é€’ç»™windowå¯¹è±¡è¿›è¡Œå¤„ç†ã€‚</p></li><li><p>å¦‚æœwindowå¯¹è±¡ä¹Ÿä¸å¤„ç†ï¼Œåˆ™å°†äº‹ä»¶æˆ–æ¶ˆæ¯ä¼ é€’ç»™UIApplicationå¯¹è±¡ã€‚</p></li><li><p>å¦‚æœUIApplicationä¹Ÿä¸èƒ½å¤„ç†è¯¥äº‹ä»¶æˆ–æ¶ˆæ¯ï¼Œåˆ™å°†å…¶ä¸¢å¼ƒã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;äº‹ä»¶ä¼ é€’å“åº”é“¾&quot;&gt;&lt;a href=&quot;#äº‹ä»¶ä¼ é€’å“åº”é“¾&quot; class=&quot;headerlink&quot; title=&quot;äº‹ä»¶ä¼ é€’å“åº”é“¾&quot;&gt;&lt;/a&gt;äº‹ä»¶ä¼ é€’å“åº”é“¾&lt;/h1&gt;&lt;h2 id=&quot;UIResponder&quot;&gt;&lt;a href=&quot;#UIResponder&quot; class=&quot;he
      
    
    </summary>
    
      <category term="iOS" scheme="https://fusugz.github.io/categories/iOS/"/>
    
    
      <category term="responder-chain" scheme="https://fusugz.github.io/tags/responder-chain/"/>
    
  </entry>
  
  <entry>
    <title>iOSåŸºç¡€çŸ¥è¯†æ•´ç†ä¹‹å¤šçº¿ç¨‹æŠ€æœ¯</title>
    <link href="https://fusugz.github.io/2018/11/09/multithreading/"/>
    <id>https://fusugz.github.io/2018/11/09/multithreading/</id>
    <published>2018-11-09T02:44:05.000Z</published>
    <updated>2018-11-09T02:45:32.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¤šçº¿ç¨‹æŠ€æœ¯"><a href="#å¤šçº¿ç¨‹æŠ€æœ¯" class="headerlink" title="å¤šçº¿ç¨‹æŠ€æœ¯"></a>å¤šçº¿ç¨‹æŠ€æœ¯</h1><h2 id="å¤šçº¿ç¨‹ï¼ˆmultithreadingï¼‰"><a href="#å¤šçº¿ç¨‹ï¼ˆmultithreadingï¼‰" class="headerlink" title="å¤šçº¿ç¨‹ï¼ˆmultithreadingï¼‰"></a>å¤šçº¿ç¨‹ï¼ˆmultithreadingï¼‰</h2><p>æ˜¯æŒ‡è½¯ä»¶æˆ–è€…ç¡¬ä»¶ä¸Šå®ç°å¤šä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„æŠ€æœ¯ã€‚å…·æœ‰å¤šçº¿ç¨‹èƒ½åŠ›çš„è®¡ç®—æœºå› æœ‰ç¡¬ä»¶æ”¯æŒè€Œèƒ½å¤Ÿåœ¨åŒä¸€æ—¶é—´æ‰§è¡Œå¤šäºä¸€ä¸ªçº¿ç¨‹ï¼Œè¿›è€Œæå‡æ•´ä½“å¤„ç†æ€§èƒ½ã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><ul><li><p>åŒä¸€æ—¶é—´ï¼ŒCPUåªèƒ½å¤„ç†ä¸€æ¡çº¿ç¨‹ï¼Œåªæœ‰ä¸€æ¡çº¿ç¨‹åœ¨å·¥ä½œã€‚</p></li><li><p>å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œï¼Œå…¶å®æ˜¯CPUå¿«é€Ÿåœ°åœ¨å¤šçº¿ç¨‹ä¹‹é—´è°ƒåº¦ï¼ˆåˆ‡æ¢ï¼‰ã€‚</p></li><li><p>å¦‚æœCPUè°ƒåº¦çº¿ç¨‹çš„æ—¶é—´è¶³å¤Ÿå¿«ï¼Œå°±é€ æˆäº†å¤šçº¿ç¨‹å¹¶å‘æ‰§è¡Œçš„å‡è±¡ï¼ˆCPUå¹¶ä¸æ˜¯çœŸæ­£çš„åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼‰ã€‚</p></li></ul><h2 id="å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”"><a href="#å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”" class="headerlink" title="å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”"></a>å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå¯¹æ¯”</h2><table><thead><tr><th>å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆ</th><th>ç®€ä»‹</th><th>è¯­è¨€</th><th>çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ</th><th>ä½¿ç”¨é¢‘ç‡</th></tr></thead><tbody><tr><td>pthread</td><td>ä¸€å¥—é€šç”¨çš„å¤šçº¿ç¨‹APIï¼›é€‚ç”¨äºUnix/Linux/Windowsç­‰ç³»ç»Ÿï¼›è·¨å¹³å°ï¼Œå¯ç§»æ¤ï¼›ä½¿ç”¨éš¾åº¦å¤§</td><td>C</td><td>ç¨‹åºå‘˜ç®¡ç†</td><td>å‡ ä¹ä¸ç”¨</td></tr><tr><td>NSThread</td><td>ä½¿ç”¨æ›´åŠ é¢å‘å¯¹è±¡ï¼›ç®€å•æ˜“ç”¨ï¼Œå¯ç›´æ¥æ“ä½œçº¿ç¨‹å¯¹è±¡</td><td>OC</td><td>ç¨‹åºå‘˜ç®¡ç†</td><td>å¶å°”ä½¿ç”¨</td></tr><tr><td>GCD</td><td>æ—¨åœ¨æ›¿ä»£NSThreadç­‰çº¿ç¨‹æŠ€æœ¯ï¼›å……åˆ†åˆ©ç”¨è®¾å¤‡çš„å¤šæ ¸</td><td>C</td><td>è‡ªåŠ¨ç®¡ç†</td><td>ç»å¸¸ä½¿ç”¨</td></tr><tr><td>NSOperation</td><td>åŸºäºGCDï¼ˆåº•å±‚æ˜¯GCDï¼‰ï¼›æ¯”GCDå¤šäº†ä¸€äº›ç®€å•å®ç”¨çš„åŠŸèƒ½ï¼›ä½¿ç”¨æ›´åŠ é¢å‘å¯¹è±¡</td><td>OC</td><td>è‡ªåŠ¨ç®¡ç†</td><td>ç»å¸¸ä½¿ç”¨</td></tr></tbody></table><h2 id="å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå®ç°"><a href="#å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå®ç°" class="headerlink" title="å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå®ç°"></a>å¤šçº¿ç¨‹æŠ€æœ¯æ–¹æ¡ˆå®ç°</h2><h3 id="1-NSThread"><a href="#1-NSThread" class="headerlink" title="1. NSThread"></a>1. NSThread</h3><blockquote><p>ï¼ˆ1ï¼‰ä½¿ç”¨NSThreadå¯¹è±¡å»ºç«‹ä¸€ä¸ªçº¿ç¨‹éå¸¸æ–¹ä¾¿ï¼›<br>ï¼ˆ2ï¼‰ä½¿ç”¨NSThreadç®¡ç†å¤šä¸ªçº¿ç¨‹éå¸¸å›°éš¾ï¼Œä¸æ¨èä½¿ç”¨ï¼›<br>ï¼ˆ3ï¼‰ä½¿ç”¨[NSThread currentThread]è·å¾—ä»»åŠ¡æ‰€åœ¨çº¿ç¨‹ï¼Œé€‚ç”¨äºè¿™ä¸‰ç§æŠ€æœ¯ã€‚</p></blockquote><h3 id="2-GCDï¼ˆGrand-Central-Dispatchï¼‰"><a href="#2-GCDï¼ˆGrand-Central-Dispatchï¼‰" class="headerlink" title="2. GCDï¼ˆGrand Central Dispatchï¼‰"></a>2. GCDï¼ˆGrand Central Dispatchï¼‰</h3><blockquote><p>ï¼ˆ1ï¼‰æ˜¯åŸºäºCè¯­è¨€çš„åº•å±‚APIï¼Œå¯ç”¨äºå¤šæ ¸å¹¶è¡Œè®¡ç®—ï¼›<br>ï¼ˆ2ï¼‰ç”¨Blockå®šä¹‰ä»»åŠ¡ï¼Œä½¿ç”¨èµ·æ¥éå¸¸çµæ´»ï¼ŒGCDä¼šè‡ªåŠ¨ç®¡ç†çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåˆ›å»ºçº¿ç¨‹ã€è°ƒåº¦ä»»åŠ¡ã€é”€æ¯çº¿ç¨‹ï¼‰ï¼›<br>ï¼ˆ3ï¼‰æä¾›äº†æ›´å¤šçš„æ§åˆ¶èƒ½åŠ›ä»¥åŠæ“ä½œé˜Ÿåˆ—ä¸­æ‰€ä¸èƒ½ä½¿ç”¨çš„åº•å±‚å‡½æ•°ã€‚</p></blockquote><h4 id="ä»»åŠ¡ä¸é˜Ÿåˆ—"><a href="#ä»»åŠ¡ä¸é˜Ÿåˆ—" class="headerlink" title="ä»»åŠ¡ä¸é˜Ÿåˆ—"></a>ä»»åŠ¡ä¸é˜Ÿåˆ—</h4><ol><li>ä»»åŠ¡</li></ol><p>å³éœ€è¦æ‰§è¡Œçš„æ“ä½œï¼Œåœ¨GCDä¸­ä»»åŠ¡æ˜¯æ”¾åœ¨blocké‡Œã€‚æ‰§è¡Œçš„æ–¹å¼æœ‰ä¸¤ç§ï¼šåŒæ­¥ï¼ˆsyncï¼‰ä¸å¼‚æ­¥ï¼ˆasyncï¼‰ï¼Œä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºæ˜¯å¦å…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›ã€‚</p><ul><li>åŒæ­¥ï¼ˆsyncï¼‰</li></ul><blockquote><p>åŒæ­¥æ·»åŠ ä»»åŠ¡åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ä¸­ï¼Œåœ¨é˜Ÿåˆ—ä¸­çš„æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡æ‰§è¡Œç»“æŸä¹‹å‰ï¼Œä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°è¯¥ä»»åŠ¡åœ¨æ‰€åœ¨é˜Ÿåˆ—ä¸­ä¼˜å…ˆçº§é«˜äºæœ¬èº«çš„ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚<br>ä¸å…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›ã€‚</p></blockquote><ul><li>å¼‚æ­¥ï¼ˆasyncï¼‰</li></ul><blockquote><p>å¼‚æ­¥æ·»åŠ ä»»åŠ¡åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ä¸­ï¼Œæ— éœ€ç­‰å¾…å³å¯ç›´æ¥æ‰§è¡Œã€‚<br>å…·å¤‡å¼€å¯æ–°çº¿ç¨‹çš„èƒ½åŠ›ã€‚</p></blockquote><ol><li>é˜Ÿåˆ—</li></ol><p>å³æ‰§è¡Œä»»åŠ¡çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œç”¨æ¥å­˜æ”¾ä»»åŠ¡çš„é˜Ÿåˆ—ã€‚é˜Ÿåˆ—æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§è¡¨ï¼Œé‡‡ç”¨FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„åŸåˆ™ã€‚</p><p>åœ¨GCDä¸­é˜Ÿåˆ—åˆ†ä¸ºä¸²è¡Œé˜Ÿåˆ—ï¼ˆSerial Dispatch Queueï¼‰å’Œå¹¶è¡Œé˜Ÿåˆ—ï¼ˆConcurrent Dispatch Queueï¼‰ä¸¤ç§ï¼Œä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼šæ‰§è¡Œçš„é¡ºåºä¸åŒï¼Œå¼€å¯çº¿ç¨‹æ•°ä¸åŒã€‚</p><ul><li>ä¸²è¡Œé˜Ÿåˆ—</li></ul><blockquote><p>æ¯æ¬¡åªæœ‰ä¸€ä¸ªä»»åŠ¡è¢«æ‰§è¡Œï¼Œè®©ä»»åŠ¡ä¸€ä¸ªæ¥ç€ä¸€ä¸ªæ‰§è¡Œã€‚ï¼ˆåªå¼€å¯ä¸€ä¸ªå­çº¿ç¨‹ï¼‰</p></blockquote><ul><li>å¹¶è¡Œé˜Ÿåˆ—</li></ul><blockquote><p>å¯ä»¥è®©å¤šä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œã€‚ï¼ˆå¯ä»¥å¼€å¯å¤šä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸”åŒæ—¶æ‰§è¡Œä»»åŠ¡ï¼‰</p></blockquote><p><strong>æ³¨æ„ï¼šå¹¶å‘é˜Ÿåˆ—çš„å¹¶å‘åŠŸèƒ½åªæœ‰åœ¨å¼‚æ­¥ä¸‹æ‰æœ‰æ•ˆ</strong></p><h3 id="3-NSOperation"><a href="#3-NSOperation" class="headerlink" title="3. NSOperation"></a>3. NSOperation</h3><blockquote><p>ï¼ˆ1ï¼‰æ˜¯ä½¿ç”¨GCDå®ç°çš„ä¸€å¥—Objective-Cçš„APIï¼›<br>ï¼ˆ2ï¼‰æ˜¯é¢å‘å¯¹è±¡çš„çº¿ç¨‹æŠ€æœ¯ï¼›<br>ï¼ˆ3ï¼‰æä¾›äº†ä¸€äº›GCDä¸­ä¸å®¹æ˜“å®ç°çš„ç‰¹æ€§ï¼Œå¦‚ï¼šç°åœ¨æœ€å¤§å¹¶å‘æ•°é‡ã€æ“ä½œä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¤šçº¿ç¨‹æŠ€æœ¯&quot;&gt;&lt;a href=&quot;#å¤šçº¿ç¨‹æŠ€æœ¯&quot; class=&quot;headerlink&quot; title=&quot;å¤šçº¿ç¨‹æŠ€æœ¯&quot;&gt;&lt;/a&gt;å¤šçº¿ç¨‹æŠ€æœ¯&lt;/h1&gt;&lt;h2 id=&quot;å¤šçº¿ç¨‹ï¼ˆmultithreadingï¼‰&quot;&gt;&lt;a href=&quot;#å¤šçº¿ç¨‹ï¼ˆmultithreadingï¼‰&quot; c
      
    
    </summary>
    
    
      <category term="multithreading" scheme="https://fusugz.github.io/tags/multithreading/"/>
    
  </entry>
  
  <entry>
    <title>iOSåŸºç¡€çŸ¥è¯†æ•´ç†ä¹‹ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«</title>
    <link href="https://fusugz.github.io/2018/11/09/oc-modifiers/"/>
    <id>https://fusugz.github.io/2018/11/09/oc-modifiers/</id>
    <published>2018-11-09T02:38:51.000Z</published>
    <updated>2018-11-09T02:43:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«"><a href="#ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«" class="headerlink" title="ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«"></a>ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«</h1><p>åœ¨ARCç¯å¢ƒä¸‹ï¼Œä¿®é¥°ç¬¦æœ‰assignï¼Œstrongï¼Œweakï¼Œcopyï¼Œreadwriteï¼Œreadonlyï¼Œnonatomicï¼Œatomic</p><h2 id="å±æ€§ä¿®é¥°ç¬¦å¯¹å¼•ç”¨è®¡æ•°ï¼ˆretainCountï¼‰çš„å½±å“"><a href="#å±æ€§ä¿®é¥°ç¬¦å¯¹å¼•ç”¨è®¡æ•°ï¼ˆretainCountï¼‰çš„å½±å“" class="headerlink" title="å±æ€§ä¿®é¥°ç¬¦å¯¹å¼•ç”¨è®¡æ•°ï¼ˆretainCountï¼‰çš„å½±å“"></a>å±æ€§ä¿®é¥°ç¬¦å¯¹å¼•ç”¨è®¡æ•°ï¼ˆretainCountï¼‰çš„å½±å“</h2><blockquote><ol><li>allocä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼ŒretainCountä¸º1ï¼›</li><li>retain,retainCount+1ï¼›</li><li>copyä¸€ä¸ªå¯¹è±¡å˜æˆå¦ä¸€ä¸ªå¯¹è±¡ï¼ŒretainCountä¸º1ï¼ŒåŸæœ‰å¯¹è±¡è®¡æ•°ä¸å˜ï¼›</li><li>releaseï¼ŒetainCount-1ï¼›</li><li>autoreleaseï¼ŒretainCount-1ã€‚</li></ol></blockquote><h2 id="assignã€retainã€copyåˆ†åˆ«å¯¹åº”çš„setteræ–¹æ³•"><a href="#assignã€retainã€copyåˆ†åˆ«å¯¹åº”çš„setteræ–¹æ³•" class="headerlink" title="assignã€retainã€copyåˆ†åˆ«å¯¹åº”çš„setteræ–¹æ³•"></a>assignã€retainã€copyåˆ†åˆ«å¯¹åº”çš„setteræ–¹æ³•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// assign</span><br><span class="line">- (void)setAssignObject:(id)newValue &#123;</span><br><span class="line">assignObject = newValue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// retain </span><br><span class="line">- (void)setRetainObject:(id)newValue &#123;</span><br><span class="line">if (retainObject != newValue) &#123;</span><br><span class="line">[retainObject release];</span><br><span class="line">retainObject = [newValue retain];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// copy</span><br><span class="line">- (void)setCopyObject:(id)newValue &#123;</span><br><span class="line">if (copyObject != newValue) &#123;</span><br><span class="line">[copyObjectrelease];</span><br><span class="line">copyObject = [newValuecopy];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="nonatomicå’Œatomicçš„åŒºåˆ«"><a href="#nonatomicå’Œatomicçš„åŒºåˆ«" class="headerlink" title="nonatomicå’Œatomicçš„åŒºåˆ«"></a>nonatomicå’Œatomicçš„åŒºåˆ«</h2><p>atomicä¸ºé»˜è®¤å±æ€§ï¼Œå¤šçº¿ç¨‹å®‰å…¨ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸ºäº†ä¿è¯ç¨‹åºåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆä¸€äº›äº’æ–¥åŠ é”ä»£ç ï¼Œé¿å…è¯¥å˜é‡çš„è¯»å†™ä¸åŒæ­¥é—®é¢˜ï¼Œå¯¹æ€§èƒ½çš„æ¶ˆè€—éå¸¸å¤§ï¼›<br>nonatomicï¼šç¦æ­¢å¤šçº¿ç¨‹ï¼Œå˜é‡ä¿æŠ¤ï¼Œæé«˜æ€§èƒ½ã€‚å¦‚æœè¯¥å¯¹è±¡æ— éœ€è€ƒè™‘å¤šçº¿ç¨‹çš„æƒ…å†µï¼Œå»ºè®®åŠ å…¥æ­¤å±æ€§ï¼Œè¿™æ ·ä¼šè®©ç¼–è¯‘å™¨å°‘äº§ç”Ÿä¸€äº›äº’æ–¥åŠ é”ä»£ç ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜æ•ˆç‡ã€‚</p><h2 id="readwriteå’Œreadonlyçš„åŒºåˆ«"><a href="#readwriteå’Œreadonlyçš„åŒºåˆ«" class="headerlink" title="readwriteå’Œreadonlyçš„åŒºåˆ«"></a>readwriteå’Œreadonlyçš„åŒºåˆ«</h2><p>readonlyè¡¨ç¤ºè¿™ä¸ªå±æ€§æ˜¯åªè¯»çš„ï¼Œå°±æ˜¯åªç”Ÿæˆ getteræ–¹æ³•ï¼Œä¸ä¼šç”Ÿæˆsetteræ–¹æ³•ã€‚<br>readwriteè¡¨ç¤ºå¯è¯»å†™ï¼Œç”Ÿæˆgetterå’Œsetteræ–¹æ³•ã€‚</p><h2 id="weakå’Œstrongçš„åŒºåˆ«"><a href="#weakå’Œstrongçš„åŒºåˆ«" class="headerlink" title="weakå’Œstrongçš„åŒºåˆ«"></a>weakå’Œstrongçš„åŒºåˆ«</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæŒ‡é’ˆéƒ½ä¼šä½¿ç”¨strongå±æ€§ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå¼ºå¼•ç”¨ã€‚è¿™æ„å‘³ç€ï¼Œåªè¦å¼•ç”¨å­˜åœ¨ï¼Œå¯¹è±¡å°±ä¸èƒ½è¢«é”€æ¯ã€‚<br>weakæ˜¯å¼±å¼•ç”¨ï¼Œä½¿ç”¨weakä¿®é¥°ä¸»è¦æ˜¯ä¸ºäº†è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</p><ol><li>åœ¨ä¿®é¥°ä»£ç†å±æ€§çš„æ—¶å€™ä½¿ç”¨weakï¼›</li><li>é€šè¿‡è¿çº¿æ–¹å¼åˆ›å»ºæ§ä»¶æ—¶ç”¨weakï¼›</li><li>åœ¨blockä¸­ï¼Œä¸ºé¿å…å¾ªç¯å¼•ç”¨ï¼Œä½¿ç”¨weakä¿®é¥°selfï¼Œ__weak typeof(self) weakSelf = selfã€‚</li></ol><h2 id="copyå’Œstrongçš„åŒºåˆ«"><a href="#copyå’Œstrongçš„åŒºåˆ«" class="headerlink" title="copyå’Œstrongçš„åŒºåˆ«"></a>copyå’Œstrongçš„åŒºåˆ«</h2><p>å½“æºå­—ç¬¦ä¸²æ˜¯NSStringæ—¶ï¼Œç”±äºå­—ç¬¦æ˜¯ä¸å¯å˜çš„ï¼Œä¸è®ºstrongè¿˜æ˜¯copyå±æ€§ï¼Œéƒ½æ˜¯æŒ‡å‘æºå¯¹è±¡ï¼Œcopyæ“ä½œåªæ˜¯åšäº†æ¬¡æµ…æ‹·è´ã€‚<br>å½“æºå­—ç¬¦ä¸²æ˜¯NSMutableStringæ—¶ï¼Œstrongå±æ€§åªæ˜¯å¢åŠ äº†æºå­—ç¬¦ä¸²çš„å¼•ç”¨è®¡æ•°ï¼Œè€Œcopyå±æ€§åˆ™æ˜¯å¯¹æºå­—ç¬¦ä¸²åšäº†æ¬¡æ·±æ‹·è´ï¼Œäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œä¸”copyå±æ€§å¯¹è±¡æŒ‡å‘è¿™ä¸ªæ–°çš„å¯¹è±¡ã€‚å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªcopyçš„å±æ€§å¯¹è±¡çš„ç±»å‹å§‹ç»ˆæ˜¯NSStringï¼Œè€Œä¸æ˜¯NSMutableStringï¼Œå› æ­¤å…¶æ˜¯ä¸å¯å˜çš„ã€‚è¿™é‡Œstrongå±æ€§åªæ˜¯å•çº¯å¢åŠ å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œè€Œcopyæ“ä½œåˆ™è¿›è¡Œäº†ä¸€æ¬¡æ·±æ‹·è´ï¼Œæ‰€ä»¥æ€§èƒ½ä¸Šæœ‰æ‰€å·®å¼‚ã€‚</p><h2 id="assignå’Œweakçš„åŒºåˆ«"><a href="#assignå’Œweakçš„åŒºåˆ«" class="headerlink" title="assignå’Œweakçš„åŒºåˆ«"></a>assignå’Œweakçš„åŒºåˆ«</h2><p>assigné€‚ç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œweaké€‚ç”¨äºNSObjectå¯¹è±¡ï¼Œå¹¶ä¸”æ˜¯å¼±å¼•ç”¨ã€‚å½“assignç”¨æ¥ä¿®é¥°å¯¹è±¡æ—¶å®¹æ˜“é€ æˆé‡æŒ‡é’ˆï¼Œå¯¹è±¡ä¸€èˆ¬ä¼šåˆ†é…åœ¨å †ä¸Šçš„æŸå—å†…å­˜ï¼Œå¦‚æœåœ¨åç»­çš„å†…å­˜åˆ†é…ä¸­ï¼Œåˆšå¥½åˆ†åˆ°äº†è¿™å—åœ°å€ï¼Œç¨‹åºå°±ä¼šå´©æºƒã€‚<br>ä¹‹æ‰€ä»¥assignå¯ä»¥ç”¨æ¥ä¿®é¥°åŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ˜¯å› ä¸ºåŸºç¡€æ•°æ®ç±»å‹ä¸€èˆ¬åˆ†é…åœ¨æ ˆä¸Šï¼Œæ ˆçš„å†…å­˜ä¼šç”±ç³»ç»Ÿè‡ªå·±è‡ªåŠ¨å¤„ç†ï¼Œä¸ä¼šé€ æˆé‡æŒ‡é’ˆã€‚<br>weakä¿®é¥°çš„å¯¹è±¡åœ¨è¢«é‡Šæ”¾ä»¥åï¼ŒæŒ‡é’ˆåœ°å€ä¼šè¢«ç½®ä¸ºnilï¼Œæ‰€ä»¥ç°åœ¨ä¸€èˆ¬å¼±å¼•ç”¨å°±æ˜¯ç”¨weakã€‚</p><h2 id="blockå˜é‡å®šä¹‰æ—¶ç”¨copy"><a href="#blockå˜é‡å®šä¹‰æ—¶ç”¨copy" class="headerlink" title="blockå˜é‡å®šä¹‰æ—¶ç”¨copy"></a>blockå˜é‡å®šä¹‰æ—¶ç”¨copy</h2><p>blockçš„å¾ªç¯å¼•ç”¨å¹¶ä¸æ˜¯strongå¯¼è‡´çš„ï¼Œåœ¨ARCç¯å¢ƒä¸‹ï¼Œç³»ç»Ÿåº•å±‚ä¹Ÿä¼šåšä¸€æ¬¡copyæ“ä½œä½¿blockä»æ ˆåŒºå¤åˆ¶ä¸€å—å†…å­˜ç©ºé—´åˆ°å †é‡Œï¼Œæ‰€ä»¥strongå’Œcopyåœ¨å¯¹blockä¿®é¥°ä¸Šæ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåªä¸è¿‡copyæ“ä½œçš„æ•ˆç‡é«˜è€Œå·²ï¼Œä¸€èˆ¬ç”¨copyæ¥ä¿®é¥°blockã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«&quot;&gt;&lt;a href=&quot;#ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«&quot; class=&quot;headerlink&quot; title=&quot;ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«&quot;&gt;&lt;/a&gt;ä¿®é¥°ç¬¦çš„ä½¿ç”¨å’ŒåŒºåˆ«&lt;/h1&gt;&lt;p&gt;åœ¨ARCç¯å¢ƒä¸‹ï¼Œä¿®é¥°ç¬¦æœ‰assignï¼Œstrongï¼Œweakï¼Œcopyï¼Œreadwr
      
    
    </summary>
    
      <category term="Objective-C" scheme="https://fusugz.github.io/categories/Objective-C/"/>
    
    
      <category term="modifiers" scheme="https://fusugz.github.io/tags/modifiers/"/>
    
  </entry>
  
  <entry>
    <title>iOSåŸºç¡€çŸ¥è¯†æ•´ç†ä¹‹ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ</title>
    <link href="https://fusugz.github.io/2018/11/09/vc-life-circle/"/>
    <id>https://fusugz.github.io/2018/11/09/vc-life-circle/</id>
    <published>2018-11-09T02:33:46.000Z</published>
    <updated>2018-11-09T02:35:06.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ"></a>ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="1-init"><a href="#1-init" class="headerlink" title="1.init"></a>1.init</h2><p>initå‡½æ•°å¹¶ä¸ä¼šæ¯æ¬¡åˆ›å»ºå¯¹è±¡éƒ½è°ƒç”¨ï¼Œåªæœ‰åœ¨è¿™ä¸ªç±»ç¬¬ä¸€æ¬¡åˆ›å»ºå¯¹è±¡æ—¶æ‰ä¼šè°ƒç”¨ï¼Œåšä¸€äº›ç±»çš„å‡†å¤‡å·¥ä½œï¼Œå†æ¬¡åˆ›å»ºè¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œinitalizeæ–¹æ³•å°†ä¸ä¼šè¢«è°ƒç”¨ï¼Œå¯¹äºè¿™ä¸ªç±»çš„å­ç±»ï¼Œå¦‚æœå®ç°äº†initializeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªå­ç±»ç¬¬ä¸€æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ä¼šè°ƒç”¨è‡ªå·±çš„initalizeæ–¹æ³•ï¼Œä¹‹åä¸ä¼šè°ƒç”¨ï¼Œå¦‚æœæ²¡æœ‰å®ç°ï¼Œé‚£ä¹ˆå®ƒçš„çˆ¶ç±»å°†æ›¿å®ƒå†æ¬¡è°ƒç”¨ä¸€ä¸‹è‡ªå·±çš„initializeæ–¹æ³•ï¼Œä»¥ååˆ›å»ºä¹Ÿéƒ½ä¸ä¼šå†è°ƒç”¨ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€äº›å’Œè¿™ä¸ªç›¸å…³çš„å…¨å±€å˜é‡ï¼Œå¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œåˆå§‹åŒ–ã€‚</p><h2 id="2-initCoder"><a href="#2-initCoder" class="headerlink" title="2. initCoder"></a>2. initCoder</h2><p>initCoderæ–¹æ³•å’Œinitæ–¹æ³•ç›¸ä¼¼ï¼Œåªæ˜¯è¢«è°ƒç”¨çš„ç¯å¢ƒä¸ä¸€æ ·ï¼Œå¦‚æœç”¨ä»£ç è¿›è¡Œåˆå§‹åŒ–ï¼Œä¼šè°ƒç”¨initï¼Œä»nibæ–‡ä»¶æˆ–è€…å½’æ¡£è¿›è¡Œåˆå§‹åŒ–ï¼Œä¼šè°ƒç”¨initCoderã€‚</p><h2 id="3-loadView"><a href="#3-loadView" class="headerlink" title="3. loadView"></a>3. loadView</h2><p>loadViewæ–¹æ³•æ˜¯å¼€å§‹åŠ è½½è§†å›¾çš„èµ·å§‹æ–¹æ³•ï¼Œé™¤éæ‰‹åŠ¨è°ƒç”¨ï¼Œå¦åˆ™åœ¨ViewControllerçš„ç”Ÿå‘½å‘¨æœŸä¸­æ²¡ç‰¹æ®Šæƒ…å†µåªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚</p><h2 id="4-viewDidLoad"><a href="#4-viewDidLoad" class="headerlink" title="4. viewDidLoad"></a>4. viewDidLoad</h2><p>viewDidLoadæ–¹æ³•æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ–¹æ³•çš„ï¼Œç±»ä¸­æˆå‘˜å¯¹è±¡å’Œå˜é‡çš„åˆå§‹åŒ–æˆ‘ä»¬éƒ½ä¼šæ”¾åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œåœ¨ç±»åˆ›å»ºåï¼Œæ— è®ºè§†å›¾çš„å±•ç°æˆ–æ¶ˆå¤±ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿæ˜¯åªä¼šåœ¨å°†è¦å¸ƒå±€æ—¶è°ƒç”¨ä¸€æ¬¡ã€‚</p><h2 id="5-viewWillAppear"><a href="#5-viewWillAppear" class="headerlink" title="5. viewWillAppear"></a>5. viewWillAppear</h2><p>è§†å›¾å°†è¦å±•ç°æ—¶ä¼šè°ƒç”¨ã€‚</p><h2 id="6-viewWillLayoutSubviews"><a href="#6-viewWillLayoutSubviews" class="headerlink" title="6. viewWillLayoutSubviews"></a>6. viewWillLayoutSubviews</h2><p>åœ¨viewWillAppearåè°ƒç”¨ï¼Œå°†è¦å¯¹å­è§†å›¾è¿›è¡Œå¸ƒå±€ã€‚</p><h2 id="7-viewDidLayoutSubviews"><a href="#7-viewDidLayoutSubviews" class="headerlink" title="7. viewDidLayoutSubviews"></a>7. viewDidLayoutSubviews</h2><p>å·²ç»å¸ƒå±€å®Œæˆå­è§†å›¾ã€‚</p><h2 id="8-viewDidAppar"><a href="#8-viewDidAppar" class="headerlink" title="8. viewDidAppar"></a>8. viewDidAppar</h2><p>è§†å›¾å®Œæˆæ˜¾ç¤ºæ—¶è°ƒç”¨ã€‚</p><h2 id="9-viewWillDisappear"><a href="#9-viewWillDisappear" class="headerlink" title="9. viewWillDisappear"></a>9. viewWillDisappear</h2><p>è§†å›¾å°†è¦æ¶ˆå¤±æ—¶è°ƒç”¨ã€‚</p><h2 id="10-viewDidDisappear"><a href="#10-viewDidDisappear" class="headerlink" title="10. viewDidDisappear"></a>10. viewDidDisappear</h2><p>è§†å›¾å·²ç»æ¶ˆå¤±æ—¶è°ƒç”¨ã€‚</p><h2 id="11-dealloc"><a href="#11-dealloc" class="headerlink" title="11. dealloc"></a>11. dealloc</h2><p>controllerè¢«é‡Šæ”¾æ—¶è°ƒç”¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;&lt;a href=&quot;#ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ&quot; class=&quot;headerlink&quot; title=&quot;ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;&lt;/a&gt;ViewControllerçš„ç”Ÿå‘½å‘¨æœŸ&lt;/h1&gt;&lt;h2 i
      
    
    </summary>
    
      <category term="Objective-C" scheme="https://fusugz.github.io/categories/Objective-C/"/>
    
    
      <category term="lifeCircle" scheme="https://fusugz.github.io/tags/lifeCircle/"/>
    
  </entry>
  
  <entry>
    <title>iOSåŸºç¡€çŸ¥è¯†æ•´ç†ä¹‹åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</title>
    <link href="https://fusugz.github.io/2018/11/09/app-life-circle/"/>
    <id>https://fusugz.github.io/2018/11/09/app-life-circle/</id>
    <published>2018-11-09T02:28:53.000Z</published>
    <updated>2018-11-09T02:30:22.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ"><a href="#åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ"></a>åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ</h1><h2 id="Mainå‡½æ•°å…¥å£"><a href="#Mainå‡½æ•°å…¥å£" class="headerlink" title="Mainå‡½æ•°å…¥å£"></a>Mainå‡½æ•°å…¥å£</h2><p>UIApplicationMain</p><ol><li>ä»å¯ç”¨Storyboardæ–‡ä»¶åŠ è½½ç”¨æˆ·ç•Œé¢</li><li>è°ƒç”¨AppDelegateè‡ªå®šä¹‰ä»£ç æ¥åˆå§‹åŒ–è®¾ç½®</li><li>å°†appæ”¾å…¥Main Run Loopç¯å¢ƒä¸­æ¥å“åº”å’Œå¤„ç†ä¸ç”¨æˆ·äº¤äº’äº§ç”Ÿçš„äº‹ä»¶</li></ol><h2 id="åº”ç”¨ç¨‹åºçš„äº”ç§çŠ¶æ€"><a href="#åº”ç”¨ç¨‹åºçš„äº”ç§çŠ¶æ€" class="headerlink" title="åº”ç”¨ç¨‹åºçš„äº”ç§çŠ¶æ€"></a>åº”ç”¨ç¨‹åºçš„äº”ç§çŠ¶æ€</h2><ul><li>Not Runningï¼ˆéè¿è¡ŒçŠ¶æ€ï¼‰<br>åº”ç”¨æ²¡æœ‰è¿è¡Œæˆ–è¢«ç³»ç»Ÿç»ˆæ­¢ã€‚</li><li>Inactiveï¼ˆå‰å°éæ´»åŠ¨çŠ¶æ€ï¼‰<br>åº”ç”¨æ­£åœ¨è¿›å…¥å‰å°çŠ¶æ€ï¼Œä½†æ˜¯è¿˜ä¸èƒ½æ¥å—äº‹ä»¶å¤„ç†ã€‚</li><li>Activeï¼ˆå‰å°æ´»åŠ¨çŠ¶æ€ï¼‰<br>åº”ç”¨è¿›å…¥å‰å°çŠ¶æ€ï¼Œèƒ½æ¥å—äº‹ä»¶å¤„ç†</li><li>Backgroundï¼ˆåå°çŠ¶æ€ï¼‰<br>åº”ç”¨è¿›å…¥åå°åï¼Œä¾ç„¶èƒ½å¤Ÿæ‰§è¡Œä»£ç ï¼Œå¦‚æœæœ‰å¯æ‰§è¡Œçš„ä»£ç ï¼Œå°±ä¼šæ‰§è¡Œä»£ç ï¼Œå¦‚æœæ²¡æœ‰å¯æ‰§è¡Œçš„ä»£ç æ´»ç€å°†å¯æ‰§è¡Œçš„ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œåº”ç”¨ä¼šé©¬ä¸Šè¿›å…¥æŒ‚èµ·çŠ¶æ€ã€‚æœ‰çš„ç¨‹åºç»è¿‡ç‰¹æ®Šçš„è¯·æ±‚åå¯ä»¥é•¿æœŸå¤„äºBackgroundçŠ¶æ€ã€‚</li><li>Suspendedï¼ˆæŒ‚èµ·çŠ¶æ€ï¼‰<br>å¤„äºæŒ‚èµ·çš„åº”ç”¨è¿›å…¥ä¸€ç§â€œå†·å†»â€çŠ¶æ€ï¼Œä¸èƒ½æ‰§è¡Œä»£ç ï¼Œå¦‚æœç³»ç»Ÿå†…å­˜ä¸å¤Ÿï¼Œç³»ç»Ÿå°±æŠŠæŒ‚èµ·çš„ç¨‹åºæ¸…é™¤æ‰ï¼Œä¸ºå‰å°ç¨‹åºæä¾›æ›´å¤šçš„å†…å­˜ï¼Œåº”ç”¨ä¼šè¢«ç»ˆæ­¢ã€‚</li></ul><h2 id="AppDelegateçš„ä»£ç†æ–¹æ³•"><a href="#AppDelegateçš„ä»£ç†æ–¹æ³•" class="headerlink" title="AppDelegateçš„ä»£ç†æ–¹æ³•"></a>AppDelegateçš„ä»£ç†æ–¹æ³•</h2><p>ä½œä¸ºåº”ç”¨ç¨‹åºçš„å§”æ‰˜å¯¹è±¡ï¼ŒAppDelegateç±»åœ¨åº”ç”¨ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒé˜¶æ®µä¼šè°ƒç”¨ä¸åŒçš„æ–¹æ³•ã€‚</p><table><thead><tr><th>æ–¹æ³•</th><th>æœ¬åœ°é€šçŸ¥</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>application: didFinishLaunchingWithOptions:</td><td>UIApplicationDidFinishLaunching-Notification</td><td>åº”ç”¨å¯åŠ¨å¹¶è¿›è¡Œåˆå§‹åŒ–æ—¶ä¼šè°ƒç”¨è¯¥æ–¹æ³•å¹¶å‘å‡ºé€šçŸ¥ã€‚è¿™ä¸ªé˜¶æ®µä¼šç¤ºä¾‹åŒ–æ ¹è§†å›¾æ§åˆ¶å™¨</td></tr><tr><td>application: DidBecomeActiveï¼š</td><td>UIApplicationDidBecomeActive-Notification</td><td>åº”ç”¨è¿›å…¥å‰å°å¹¶å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶è°ƒç”¨è¯¥æ–¹æ³•å¹¶å‘å‡ºé€šçŸ¥ï¼Œè¿™ä¸ªé˜¶æ®µå¯æ¢å¤UIçš„çŠ¶æ€ï¼ˆä¾‹å¦‚æ¸¸æˆçŠ¶æ€ç­‰ï¼‰</td></tr><tr><td>application:WillResignActiveï¼š</td><td>UIApplicationWillResignActive-Notification</td><td>åº”ç”¨ä»æ´»åŠ¨çŠ¶æ€è¿›å…¥åˆ°éæ´»åŠ¨çŠ¶æ€æ—¶è°ƒç”¨è¯¥æ–¹æ³•å¹¶å‘å‡ºé€šçŸ¥ã€‚è¿™ä¸ªé˜¶æ®µå¯ä»¥ä¿å­˜UIçš„çŠ¶æ€ï¼ˆä¾‹å¦‚æ¸¸æˆçŠ¶æ€ç­‰ï¼‰</td></tr><tr><td>application:DidEnterBackgroundï¼š</td><td>UIApplicationDidEnterBcakground-Notification</td><td>åº”ç”¨è¿›å…¥åå°æ—¶è°ƒç”¨è¯¥æ–¹æ³•å¹¶å‘å‡ºé€šçŸ¥ã€‚è¿™ä¸ªé˜¶æ®µå¯ä»¥ä¿å­˜ç”¨æˆ·æ•°æ®ï¼Œé‡Šæ”¾ä¸€äº›èµ„æºï¼ˆä¾‹å¦‚é‡Šæ”¾æ•°æ®åº“èµ„æºç­‰ï¼‰</td></tr><tr><td>application:WillEnterForegroundï¼š</td><td>UIApplicationWillEnterForeground-Notification</td><td>åº”ç”¨è¿›å…¥åˆ°å‰å°ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶è°ƒç”¨è¯¥æ–¹æ³•å¹¶å‘å‡ºé€šçŸ¥ã€‚è¿™ä¸ªé˜¶æ®µå¯ä»¥æ¢å¤ç”¨æˆ·æ•°æ®</td></tr><tr><td>application:WillTerminateï¼š</td><td>UIApplicationWillTerminate-Notification</td><td>åº”ç”¨è¢«ç»ˆæ­¢æ—¶è°ƒç”¨è¯¥æ–¹æ³•å¹¶å‘å‡ºé€šçŸ¥ï¼Œä½†å†…å­˜æ¸…é™¤æ—¶é™¤å¤–ã€‚è¿™ä¸ªé˜¶æ®µå¯ä»¥é‡Šæ”¾ä¸€äº›æ•°æ®ï¼Œä¹Ÿå¯ä»¥ä¿å­˜ç”¨æˆ·æ•°æ®ã€‚</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;&lt;a href=&quot;#åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ&quot; class=&quot;headerlink&quot; title=&quot;åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ&quot;&gt;&lt;/a&gt;åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ&lt;/h1&gt;&lt;h2 id=&quot;Mainå‡½æ•°å…¥å£&quot;&gt;&lt;a href=&quot;#Mainå‡½æ•°å…¥å£&quot; class=&quot;headerli
      
    
    </summary>
    
      <category term="iOS" scheme="https://fusugz.github.io/categories/iOS/"/>
    
    
      <category term="application" scheme="https://fusugz.github.io/tags/application/"/>
    
  </entry>
  
  <entry>
    <title>Socketç®€æä¸iOSå®ç°</title>
    <link href="https://fusugz.github.io/2018/11/09/socket-ios-use/"/>
    <id>https://fusugz.github.io/2018/11/09/socket-ios-use/</id>
    <published>2018-11-09T02:19:36.000Z</published>
    <updated>2018-11-09T02:21:48.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/2251123-382d6dedb145f607.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="WebSocket"></p><h1 id="Socketçš„åŸºæœ¬æ¦‚å¿µ"><a href="#Socketçš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="Socketçš„åŸºæœ¬æ¦‚å¿µ"></a>Socketçš„åŸºæœ¬æ¦‚å¿µ</h1><h2 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1.å®šä¹‰"></a>1.å®šä¹‰</h2><blockquote><p>ç½‘ç»œä¸Šä¸¤ä¸ªç¨‹åºé€šè¿‡ä¸€ä¸ªåŒå‘é€šä¿¡è¿æ¥å®ç°æ•°æ®äº¤äº’ï¼Œè¿™ç§åŒå‘é€šä¿¡çš„è¿æ¥å«åšSocketï¼ˆå¥—æ¥å­—ï¼‰ã€‚</p></blockquote><h2 id="2-æœ¬è´¨"><a href="#2-æœ¬è´¨" class="headerlink" title="2.æœ¬è´¨"></a>2.æœ¬è´¨</h2><p>ç½‘ç»œæ¨¡å‹ä¸­åº”ç”¨å±‚ä¸TCP/IPåè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œæ˜¯å®ƒçš„ä¸€ç»„ç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰ï¼Œä¹Ÿå³å¯¹TCP/IPçš„å°è£…ã€‚TCP/IPä¹Ÿè¦æä¾›å¯ä¾›ç¨‹åºå‘˜åšç½‘ç»œå¼€å‘æ‰€ç”¨çš„æ¥å£ï¼Œå³Socketç¼–ç¨‹æ¥å£ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/2251123-097a5471af0515e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Socketçš„ä½ç½®"></p><h2 id="3-è¦ç´ "><a href="#3-è¦ç´ " class="headerlink" title="3.è¦ç´ "></a>3.è¦ç´ </h2><p>Socketæ˜¯ç½‘ç»œé€šä¿¡çš„åŸºçŸ³ï¼Œæ˜¯æ”¯æŒTCP/IPåè®®çš„ç½‘ç»œé€šä¿¡çš„åŸºæœ¬æ“ä½œå•å…ƒï¼ŒåŒ…å«è¿›è¡Œç½‘ç»œé€šä¿¡çš„å¿…é¡»çš„äº”ç§ä¿¡æ¯ï¼š</p><ul><li>è¿æ¥ä½¿ç”¨çš„åè®® </li><li>æœ¬åœ°ä¸»æœºçš„IPåœ°å€ </li><li>æœ¬åœ°è¿›ç¨‹çš„åè®®ç«¯å£</li><li>è¿œç¨‹ä¸»æœºçš„IPåœ°å€</li><li>è¿œç¨‹è¿›ç¨‹çš„åè®®ç«¯å£</li></ul><h2 id="4-ç‰¹æ€§"><a href="#4-ç‰¹æ€§" class="headerlink" title="4.ç‰¹æ€§"></a>4.ç‰¹æ€§</h2><p>Socketå¯ä»¥æ”¯æŒä¸åŒçš„ä¼ è¾“åè®®ï¼ˆTCPæˆ–UDPï¼‰ï¼Œå½“ä½¿ç”¨TCPåè®®è¿›è¡Œè¿æ¥æ—¶ï¼Œè¯¥Socketè¿æ¥å°±æ˜¯ä¸€ä¸ªTCPè¿æ¥ï¼›åŒç†ï¼Œå½“ä½¿ç”¨UDPåè®®è¿›è¡Œè¿æ¥æ—¶ï¼Œè¯¥Socketè¿æ¥å°±æ˜¯ä¸€ä¸ªUDPè¿æ¥ã€‚<br>å¤šä¸ªTCPè¿æ¥æˆ–å¤šä¸ªåº”ç”¨ç¨‹åºè¿›ç¨‹å¯èƒ½éœ€è¦é€šè¿‡åŒä¸€ä¸ªTCPåè®®ç«¯å£ä¼ è¾“æ•°æ®ã€‚ä¸ºäº†åŒºåˆ«ä¸åŒçš„åº”ç”¨ç¨‹åºè¿›ç¨‹å’Œè¿æ¥ï¼Œè®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºä¸TCP/IPåè®®äº¤äº’æä¾›äº†å¥—æ¥å­—ï¼ˆSocketï¼‰æ¥å£ã€‚åº”ç”¨å±‚å¯ä»¥å’Œä¼ è¾“å±‚é€šè¿‡Socketæ¥å£ï¼ŒåŒºåˆ†æ¥è‡ªä¸åŒåº”ç”¨ç¨‹åºè¿›ç¨‹æˆ–ç½‘ç»œè¿æ¥çš„é€šä¿¡ï¼Œå®ç°æ•°æ®ä¼ è¾“çš„å¹¶å‘æœåŠ¡ã€‚</p><h2 id="5-è¿æ¥"><a href="#5-è¿æ¥" class="headerlink" title="5.è¿æ¥"></a>5.è¿æ¥</h2><p>å»ºç«‹Socketè¿æ¥è‡³å°‘éœ€è¦ä¸€å¯¹å¥—æ¥å­—ï¼Œåˆ†åˆ«è¿è¡ŒäºæœåŠ¡ç«¯ï¼ˆServerSocketï¼‰å’Œå®¢æˆ·ç«¯ï¼ˆClientSocketï¼‰ã€‚å¥—æ¥å­—ç›´æ¥çš„è¿æ¥è¿‡ç¨‹æ°›å›´ä¸‰ä¸ªæ­¥éª¤ï¼š</p><h3 id="Step-1-æœåŠ¡å™¨ç›‘å¬"><a href="#Step-1-æœåŠ¡å™¨ç›‘å¬" class="headerlink" title="Step 1 æœåŠ¡å™¨ç›‘å¬"></a>Step 1 æœåŠ¡å™¨ç›‘å¬</h3><p>æœåŠ¡ç«¯Socketå§‹ç»ˆå¤„äºç­‰å¾…è¿æ¥çŠ¶æ€ï¼Œå®æ—¶ç›‘å¬æ˜¯å¦æœ‰å®¢æˆ·ç«¯è¯·æ±‚è¿æ¥ã€‚</p><h3 id="Step-2-å®¢æˆ·ç«¯è¯·æ±‚"><a href="#Step-2-å®¢æˆ·ç«¯è¯·æ±‚" class="headerlink" title="Step 2 å®¢æˆ·ç«¯è¯·æ±‚"></a>Step 2 å®¢æˆ·ç«¯è¯·æ±‚</h3><p>å®¢æˆ·ç«¯Socketæå‡ºè¿æ¥è¯·æ±‚ï¼ŒæŒ‡å®šæœåŠ¡ç«¯Socketçš„åœ°å€å’Œç«¯å£å·ï¼Œè¿™æ—¶å°±å¯ä»¥å‘å¯¹åº”çš„æœåŠ¡ç«¯æå‡ºSocketè¿æ¥è¯·æ±‚ã€‚</p><h3 id="Step-3-è¿æ¥ç¡®è®¤"><a href="#Step-3-è¿æ¥ç¡®è®¤" class="headerlink" title="Step 3 è¿æ¥ç¡®è®¤"></a>Step 3 è¿æ¥ç¡®è®¤</h3><p>å½“æœåŠ¡ç«¯Socketç›‘å¬åˆ°å®¢æˆ·ç«¯Socketæå‡ºçš„è¿æ¥è¯·æ±‚æ—¶ä½œå‡ºå“åº”ï¼Œå»ºç«‹ä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼ŒæŠŠæœåŠ¡ç«¯Socketçš„æè¿°å‘é€ç»™å®¢æˆ·ç«¯ï¼Œè¯¥æè¿°å¾—åˆ°å®¢æˆ·ç«¯ç¡®è®¤åå°±å¯å»ºç«‹èµ·Socketè¿æ¥ã€‚è€ŒæœåŠ¡ç«¯Socketåˆ™ç»§ç»­å¤„äºç›‘å¬çŠ¶æ€ï¼Œç»§ç»­æ¥æ”¶å…¶ä»–å®¢æˆ·ç«¯Socketçš„è¯·æ±‚ã€‚</p><h1 id="iOSå®¢æˆ·ç«¯Socketçš„å®ç°"><a href="#iOSå®¢æˆ·ç«¯Socketçš„å®ç°" class="headerlink" title="iOSå®¢æˆ·ç«¯Socketçš„å®ç°"></a>iOSå®¢æˆ·ç«¯Socketçš„å®ç°</h1><h2 id="1-æ•°æ®æµæ–¹å¼"><a href="#1-æ•°æ®æµæ–¹å¼" class="headerlink" title="1. æ•°æ®æµæ–¹å¼"></a>1. æ•°æ®æµæ–¹å¼</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)connectToServer:(id)sender &#123;</span><br><span class="line">// 1.ä¸æœåŠ¡å™¨é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥</span><br><span class="line">NSString *host = @&quot;192.168.1.58&quot;;</span><br><span class="line">int port = 1212;</span><br><span class="line"></span><br><span class="line">//åˆ›å»ºä¸€ä¸ªsocketå¯¹è±¡</span><br><span class="line">_socket = [[GCDAsyncSocket alloc] initWithDelegate:self</span><br><span class="line">delegateQueue:dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)];</span><br><span class="line"></span><br><span class="line">NSError *error = nil;</span><br><span class="line"></span><br><span class="line">// å¼€å§‹è¿æ¥</span><br><span class="line">[_socket connectToHost:host</span><br><span class="line">onPort:port</span><br><span class="line">error:&amp;error];</span><br><span class="line"></span><br><span class="line">if (error) &#123;</span><br><span class="line">NSLog(@&quot;%@&quot;,error);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#pragma mark - Socketä»£ç†æ–¹æ³•</span><br><span class="line">// è¿æ¥æˆåŠŸ</span><br><span class="line">- (void)socket:(GCDAsyncSocket *)sock</span><br><span class="line">didConnectToHost:(NSString *)host</span><br><span class="line">port:(uint16_t)port &#123;</span><br><span class="line">NSLog(@&quot;%s&quot;,__func__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ–­å¼€è¿æ¥</span><br><span class="line">- (void)socketDidDisconnect:(GCDAsyncSocket *)sock</span><br><span class="line">withError:(NSError *)err &#123;</span><br><span class="line">if (err) &#123;</span><br><span class="line">NSLog(@&quot;è¿æ¥å¤±è´¥&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">NSLog(@&quot;æ­£å¸¸æ–­å¼€&quot;);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å‘é€æ•°æ®</span><br><span class="line">- (void)socket:(GCDAsyncSocket *)sock</span><br><span class="line">didWriteDataWithTag:(long)tag &#123;</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%s&quot;,__func__);</span><br><span class="line"></span><br><span class="line">//å‘é€å®Œæ•°æ®æ‰‹åŠ¨è¯»å–ï¼Œ-1ä¸è®¾ç½®è¶…æ—¶</span><br><span class="line">[sock readDataWithTimeout:-1</span><br><span class="line">tag:tag];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è¯»å–æ•°æ®</span><br><span class="line">-(void)socket:(GCDAsyncSocket *)sock</span><br><span class="line">didReadData:(NSData *)data</span><br><span class="line">withTag:(long)tag &#123;</span><br><span class="line"></span><br><span class="line">NSString *receiverStr = [[NSString alloc] initWithData:data</span><br><span class="line">encoding:NSUTF8StringEncoding];</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%s %@&quot;,__func__,receiverStr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-åŸºäºç¬¬ä¸‰æ–¹å¼€æºåº“CocoaAsyncSocket"><a href="#2-åŸºäºç¬¬ä¸‰æ–¹å¼€æºåº“CocoaAsyncSocket" class="headerlink" title="2.åŸºäºç¬¬ä¸‰æ–¹å¼€æºåº“CocoaAsyncSocket"></a>2.åŸºäºç¬¬ä¸‰æ–¹å¼€æºåº“<a href="https://github.com/robbiehanson/CocoaAsyncSocket" target="_blank" rel="noopener">CocoaAsyncSocket</a></h2><h3 id="2-1å®¢æˆ·ç«¯é€šè¿‡åœ°å€å’Œç«¯å£å·ä¸æœåŠ¡ç«¯å»ºç«‹Socketè¿æ¥ï¼Œå¹¶å†™å…¥ç›¸å…³æ•°æ®ã€‚"><a href="#2-1å®¢æˆ·ç«¯é€šè¿‡åœ°å€å’Œç«¯å£å·ä¸æœåŠ¡ç«¯å»ºç«‹Socketè¿æ¥ï¼Œå¹¶å†™å…¥ç›¸å…³æ•°æ®ã€‚" class="headerlink" title="2.1å®¢æˆ·ç«¯é€šè¿‡åœ°å€å’Œç«¯å£å·ä¸æœåŠ¡ç«¯å»ºç«‹Socketè¿æ¥ï¼Œå¹¶å†™å…¥ç›¸å…³æ•°æ®ã€‚"></a>2.1å®¢æˆ·ç«¯é€šè¿‡åœ°å€å’Œç«¯å£å·ä¸æœåŠ¡ç«¯å»ºç«‹Socketè¿æ¥ï¼Œå¹¶å†™å…¥ç›¸å…³æ•°æ®ã€‚</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (void)connectToServerWithCommand:(NSString *)command</span><br><span class="line">&#123;</span><br><span class="line">_socket = [[GCDAsyncSocket alloc] initWithDelegate:self delegateQueue:dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)];</span><br><span class="line">[_socket setUserData:command];</span><br><span class="line"></span><br><span class="line">NSError *error = nil;</span><br><span class="line">[_socket connectToHost:WIFI_DIRECT_HOST onPort:WIFI_DIRECT_PORT error:&amp;error];</span><br><span class="line">if (error) &#123;</span><br><span class="line">NSLog(@&quot;__connect error:%@&quot;,error.userInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[_socket writeData:[command dataUsingEncoding:NSUTF8StringEncoding] withTimeout:10.0f tag:6];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-å®ç°CocoaAsyncSocketçš„ä»£ç†æ–¹æ³•"><a href="#2-2-å®ç°CocoaAsyncSocketçš„ä»£ç†æ–¹æ³•" class="headerlink" title="2.2 å®ç°CocoaAsyncSocketçš„ä»£ç†æ–¹æ³•"></a>2.2 å®ç°CocoaAsyncSocketçš„ä»£ç†æ–¹æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#pragma mark - Socket Delegate</span><br><span class="line"></span><br><span class="line">- (void)socket:(GCDAsyncSocket *)sock didConnectToHost:(NSString *)host port:(uint16_t)port</span><br><span class="line">&#123;</span><br><span class="line">NSLog(@&quot;Socketè¿æ¥æˆåŠŸï¼š%s&quot;,__func__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)socketDidDisconnect:(GCDAsyncSocket *)sock withError:(NSError *)err&#123;</span><br><span class="line">if (err) &#123;</span><br><span class="line">NSLog(@&quot;è¿æ¥å¤±è´¥&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">NSLog(@&quot;æ­£å¸¸æ–­å¼€&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ([sock.userData isEqualToString:[NSString stringWithFormat:@&quot;%d&quot;,SOCKET_CONNECT_SERVER]])</span><br><span class="line">&#123;</span><br><span class="line">//æœåŠ¡å™¨æ‰çº¿ é‡æ–°è¿æ¥</span><br><span class="line">[self connectToServerWithCommand:@&quot;battery&quot;];</span><br><span class="line">&#125;else</span><br><span class="line">&#123;</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)socket:(GCDAsyncSocket *)sock didWriteDataWithTag:(long)tag &#123;</span><br><span class="line">NSLog(@&quot;æ•°æ®å‘é€æˆåŠŸï¼š%s&quot;,__func__);</span><br><span class="line">//å‘é€å®Œæ•°æ®æ‰‹åŠ¨è¯»å–ï¼Œ-1ä¸è®¾ç½®è¶…æ—¶</span><br><span class="line">[sock readDataWithTimeout:-1 tag:tag];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(void)socket:(GCDAsyncSocket *)sock didReadData:(NSData *)data withTag:(long)tag &#123;</span><br><span class="line">NSString *receiverStr = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];</span><br><span class="line">NSLog(@&quot;è¯»å–æ•°æ®ï¼š%s %@&quot;,__func__,receiverStr);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç²˜åŒ…ä¸åŠåŒ…"><a href="#ç²˜åŒ…ä¸åŠåŒ…" class="headerlink" title="ç²˜åŒ…ä¸åŠåŒ…"></a>ç²˜åŒ…ä¸åŠåŒ…</h2><p>å…³äºç²˜åŒ…å’ŒåŠåŒ…ï¼Œè¯·çœ‹<a href="http://www.jb51.net/article/105278.htm" target="_blank" rel="noopener">iOS è¯¦è§£Socketç¼–ç¨‹ç²˜åŒ…ã€åŠåŒ…å¤„ç†</a>ã€‚</p><p>## </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/2251123-382d6dedb145f607.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="network" scheme="https://fusugz.github.io/categories/network/"/>
    
      <category term="iOS" scheme="https://fusugz.github.io/categories/network/iOS/"/>
    
    
      <category term="iOS" scheme="https://fusugz.github.io/tags/iOS/"/>
    
      <category term="socket" scheme="https://fusugz.github.io/tags/socket/"/>
    
  </entry>
  
  <entry>
    <title>EasyARåº”ç”¨ä¹‹æ‰«å¡æ’­æ”¾è§†é¢‘</title>
    <link href="https://fusugz.github.io/2018/11/09/easyar/"/>
    <id>https://fusugz.github.io/2018/11/09/easyar/</id>
    <published>2018-11-09T01:49:34.000Z</published>
    <updated>2018-11-09T02:16:38.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆé€‰EasyAR"><a href="#ä¸ºä»€ä¹ˆé€‰EasyAR" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰EasyAR"></a>ä¸ºä»€ä¹ˆé€‰EasyAR</h1><h2 id="ARçš„å¹¿æ³›åº”ç”¨"><a href="#ARçš„å¹¿æ³›åº”ç”¨" class="headerlink" title="ARçš„å¹¿æ³›åº”ç”¨"></a>ARçš„å¹¿æ³›åº”ç”¨</h2><blockquote><p>ARï¼ˆAugmented Realityï¼‰å³å¢å¼ºç°å®ï¼Œæ˜¯ä¸€ç§å®æ—¶åœ°è®¡ç®—æ‘„å½±æœºå½±åƒçš„ä½ç½®åŠè§’åº¦å¹¶åŠ ä¸Šç›¸åº”å›¾åƒã€è§†é¢‘ã€3Dæ¨¡å‹çš„æŠ€æœ¯ï¼Œè¿™ç§æŠ€æœ¯çš„ç›®æ ‡æ˜¯åœ¨å±å¹•ä¸ŠæŠŠè™šæ‹Ÿä¸–ç•Œå¥—åœ¨ç°å®ä¸–ç•Œå¹¶è¿›è¡Œäº’åŠ¨ã€‚</p></blockquote><p>è¿‘å‡ å¹´ARçš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ï¼Œæ ·å¼ç¹å¤šçš„ARåº”ç”¨åœºæ™¯ç»™appçš„æ•ˆæœæä¾›äº†æ›´å¤šçš„å¯èƒ½ï¼ŒARçš„äº’åŠ¨æ€§ä½“éªŒä¹Ÿé€æ¸1è¢«å¹¿æ³›æ¥å—ï¼Œæˆä¸ºç”¨æˆ·ååˆ†å–œçˆ±å¹¶ä¹äºå°è¯•çš„åŠŸèƒ½ã€‚</p><h2 id="ä¸»æµSDK"><a href="#ä¸»æµSDK" class="headerlink" title="ä¸»æµSDK"></a>ä¸»æµSDK</h2><ul><li><p>ARToolKit</p></li><li><p>Vuforia</p></li><li><p>ARKit</p></li><li><p>ARCore</p></li><li><p>HiAR</p></li><li><p>EasyAR</p></li></ul><h2 id="EasyARçš„ä¼˜åŠ¿"><a href="#EasyARçš„ä¼˜åŠ¿" class="headerlink" title="EasyARçš„ä¼˜åŠ¿"></a>EasyARçš„ä¼˜åŠ¿</h2><p>1. è¾ƒå®Œå–„çš„ä¸­æ–‡æ–‡æ¡£</p><p>1. äº‘è¯†åˆ«</p><h1 id="ä½¿ç”¨SDKåˆ›å»ºEasyARå·¥ç¨‹"><a href="#ä½¿ç”¨SDKåˆ›å»ºEasyARå·¥ç¨‹" class="headerlink" title="ä½¿ç”¨SDKåˆ›å»ºEasyARå·¥ç¨‹"></a>ä½¿ç”¨SDKåˆ›å»ºEasyARå·¥ç¨‹</h1><h2 id="èµ„æºä¸‹è½½ä¸æ–‡æ¡£æŸ¥çœ‹"><a href="#èµ„æºä¸‹è½½ä¸æ–‡æ¡£æŸ¥çœ‹" class="headerlink" title="èµ„æºä¸‹è½½ä¸æ–‡æ¡£æŸ¥çœ‹"></a>èµ„æºä¸‹è½½ä¸æ–‡æ¡£æŸ¥çœ‹</h2><p>å¼€å‘è€…å¯ä»¥ç™»å½•<a href="https://www.easyar.cn" target="_blank" rel="noopener">EasyARå®˜ç½‘</a>æŸ¥çœ‹EasyARçš„æœåŠ¡å’Œç›¸å…³æ–‡æ¡£ï¼›</p><p>é€šè¿‡<a href="https://www.easyar.cn/view/download.html" target="_blank" rel="noopener">èµ„æ–™ä¸‹è½½</a>å¯ä»¥ä¸‹è½½ç›¸å…³SDKï¼ˆå«Unityæˆ–ä¸å«Unityï¼‰å’Œç¤ºä¾‹ç¨‹åºã€‚</p><h2 id="æ³¨å†ŒLicence-Keyæ·»åŠ æ‰€éœ€SDK"><a href="#æ³¨å†ŒLicence-Keyæ·»åŠ æ‰€éœ€SDK" class="headerlink" title="æ³¨å†ŒLicence Keyæ·»åŠ æ‰€éœ€SDK"></a>æ³¨å†ŒLicence Keyæ·»åŠ æ‰€éœ€SDK</h2><p>é¦–å…ˆ<a href="https://www.easyar.cn/view/developCenter.html#license" target="_blank" rel="noopener">æ³¨å†ŒLicence Key</a>ï¼Œæ·»åŠ SDKåˆ°å·¥ç¨‹ä¸­ã€‚</p><p>æ‰€éœ€æ·»åŠ å…¶ä»–åº“å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/2251123-84ed3b8b738430b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ·»åŠ åº“"></p><h2 id="è¿è¡Œç¤ºä¾‹ç¨‹åº"><a href="#è¿è¡Œç¤ºä¾‹ç¨‹åº" class="headerlink" title="è¿è¡Œç¤ºä¾‹ç¨‹åº"></a>è¿è¡Œç¤ºä¾‹ç¨‹åº</h2><p>ä»å®˜ç½‘ä¸‹è½½çš„ç¤ºä¾‹ç¨‹åºå¿…é¡»è¿è¡Œåœ¨çœŸæœºä¸Šï¼Œä¸”éœ€è¦å°†Enable Bitcodeè®¾ç½®ä¸ºNOã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/2251123-f289aed7aac1fc6f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è®¾ç½®Bitcode"></p><h1 id="å®ç°æ‰«æå®ç‰©æ’­æ”¾å¯¹åº”è§†é¢‘åŠŸèƒ½"><a href="#å®ç°æ‰«æå®ç‰©æ’­æ”¾å¯¹åº”è§†é¢‘åŠŸèƒ½" class="headerlink" title="å®ç°æ‰«æå®ç‰©æ’­æ”¾å¯¹åº”è§†é¢‘åŠŸèƒ½"></a>å®ç°æ‰«æå®ç‰©æ’­æ”¾å¯¹åº”è§†é¢‘åŠŸèƒ½</h1><p>è¯¥åŠŸèƒ½åŸºäºæ¨¡å¼è¯†åˆ«å’ŒARæŠ€æœ¯ï¼Œå®˜æ–¹ç¤ºä¾‹ç¨‹åºä¸­çš„HelloARVideoå·²ç»å®ç°äº†æ ¹æ®æœ¬åœ°å›¾ç‰‡è¯†åˆ«æ’­æ”¾å¯¹åº”è§†é¢‘çš„åŠŸèƒ½ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæœ¬åšå®¢æ—¨åœ¨çµæ´»è¿ç”¨EasyARçš„ç›¸å…³åŠŸèƒ½ï¼ŒæŒ‰ç±»åˆ«å°†æ‰€è¦è¯†åˆ«çš„ç›®æ ‡å›¾ç‰‡å‚¨å­˜äºäº‘ç«¯ï¼Œç”¨æˆ·å¯æŒ‰éœ€ä¸»åŠ¨è·å–ç›¸å…³èµ„æºæ–‡ä»¶ï¼Œåœ¨è·å–ç›®æ ‡å›¾ç‰‡çš„åŸºç¡€ä¸‹å®ç°è¯†åˆ«å¹¶åœ¨çº¿æ’­æ”¾å¯¹åº”è§†é¢‘çš„åŠŸèƒ½ã€‚</p><h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><h3 id="1-ä»æœåŠ¡ç«¯ä¸‹è½½ç›®æ ‡å›¾ç‰‡å‹ç¼©åŒ…å¹¶è§£å‹"><a href="#1-ä»æœåŠ¡ç«¯ä¸‹è½½ç›®æ ‡å›¾ç‰‡å‹ç¼©åŒ…å¹¶è§£å‹" class="headerlink" title="1. ä»æœåŠ¡ç«¯ä¸‹è½½ç›®æ ‡å›¾ç‰‡å‹ç¼©åŒ…å¹¶è§£å‹"></a>1. ä»æœåŠ¡ç«¯ä¸‹è½½ç›®æ ‡å›¾ç‰‡å‹ç¼©åŒ…å¹¶è§£å‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (void)downloadFileWithURL:(NSURL *)URL &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  NSURLSessionConfiguration *configuration = [NSURLSessionConfiguration defaultSessionConfiguration];</span><br><span class="line"></span><br><span class="line">Â  Â  AFURLSessionManager *mannager = [[AFURLSessionManager alloc] initWithSessionConfiguration:configuration];</span><br><span class="line"></span><br><span class="line">Â  Â  NSURLRequest *request = [NSURLRequest requestWithURL:URL];</span><br><span class="line"></span><br><span class="line">Â  Â  MBProgressHUD *hud = [MBProgressHUD showHUDAddedTo:self.view animated:YES];</span><br><span class="line"></span><br><span class="line">Â  Â  hud.mode = MBProgressHUDModeAnnularDeterminate;</span><br><span class="line"></span><br><span class="line">Â  Â  hud.label.text = @&quot;æ­£åœ¨æ›´æ–°èµ„æºåŒ…â€¦&quot;;</span><br><span class="line"></span><br><span class="line">Â  Â  _downloadTask = [mannager downloadTaskWithRequest:request progress:^(NSProgress * _Nonnull downloadProgress) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  if (downloadProgress) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  CGFloat currentProgress = (CGFloat)downloadProgress.completedUnitCount / downloadProgress.totalUnitCount;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  dispatch_async(dispatch_get_main_queue(), ^&#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  hud.progress = currentProgress;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  hud.label.text = [NSString stringWithFormat:@&quot;æ­£åœ¨æ›´æ–°èµ„æºåŒ…:%.0f%%\n&quot;,currentProgress * 100];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  NSLog(@&quot;%@&quot;,[NSString stringWithFormat:@&quot;å½“å‰è¿›åº¦ä¸ºï¼š%.2f%%&quot;,currentProgress * 100]);</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  &#125; destination:^NSURL * _Nonnull(NSURL * _Nonnull targetPath, NSURLResponse * _Nonnull response) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  // å°†zipæ–‡ä»¶ä¸‹è½½ä¿å­˜åˆ°æ²™ç›’çš„Cacheè·¯å¾„ä¸‹</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  NSString *cachePath = [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) lastObject];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  NSString *path = [cachePath stringByAppendingString:response.suggestedFilename];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  return [NSURL fileURLWithPath:path];</span><br><span class="line"></span><br><span class="line">Â  Â  &#125; completionHandler:^(NSURLResponse * _Nonnull response, NSURL * _Nullable filePath, NSError * _Nullable error) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  [hud hideAnimated:YES];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  NSString *imgFilePath = [filePath path];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  NSFileManager *fileManger = [NSFileManager defaultManager];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  NSString *imgaesPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  // removeÂ </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  [fileManger removeItemAtPath:imgaesPath error:nil];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  [fileManger createDirectoryAtPath:imgaesPath withIntermediateDirectories:YES attributes:nil error:nil];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  // unzip å°†zipæ–‡ä»¶è§£å‹å¹¶ä¿å­˜åˆ°Documentä¸‹</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  [SSZipArchive unzipFileAtPath:imgFilePath toDestination:imgaesPath];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  // scanÂ </span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  ARViewController *arVC = [[ARViewController alloc] init];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  [self presentViewController:arVC animated:YES completion:nil];</span><br><span class="line"></span><br><span class="line">Â  Â  &#125;];</span><br><span class="line"></span><br><span class="line">Â  Â  [_downloadTask resume];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-åŠ è½½targets"><a href="#2-åŠ è½½targets" class="headerlink" title="2. åŠ è½½targets"></a>2. åŠ è½½targets</h3><p>åœ¨<code>helloar</code>çš„<code>initialize</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>loadFromImage</code>æ–¹æ³•åŠ è½½ç›®æ ‡å›¾ç‰‡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">for (int i = 0; i &lt; targetCount; i++) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  loadFromImage(tracker, imageName,i);</span><br><span class="line"></span><br><span class="line">Â  Â  &#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸­<code>loadFromImage</code>ä¿®æ”¹jsonç”Ÿå­˜æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSString *documentPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject];</span><br><span class="line"></span><br><span class="line">Â  Â  easyar_ImageTarget * target = [easyar_ImageTarget create];</span><br><span class="line"></span><br><span class="line">Â  Â  NSString * absolutePath = [documentPath stringByAppendingString:[NSString stringWithFormat:@&quot;/targets/%@&quot;,name]];</span><br><span class="line"></span><br><span class="line">Â  Â  NSString *uid = [NSString stringWithFormat:@&quot;%d&quot;,index];</span><br><span class="line"></span><br><span class="line">Â  Â  NSString * jstr = [@[@&quot;&#123;\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; \&quot;images\&quot; :\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; [\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; &#123;\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; \&quot;name\&quot; : \&quot;&quot;, name, @&quot;\&quot;,\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; \&quot;image\&quot; : \&quot;&quot;, absolutePath, @&quot;\&quot;,\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; \&quot;uid\&quot; : \&quot;&quot;, uid, @&quot;\&quot;\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; &#125;\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot; ]\n&quot;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  &quot;&#125;&quot;] componentsJoinedByString:@&quot;&quot;];</span><br><span class="line"></span><br><span class="line">Â  Â  [target setup:jstr storageType:(easyar_StorageType_Assets | easyar_StorageType_Json) name:@&quot;&quot;];</span><br><span class="line"></span><br><span class="line">Â  Â  [tracker loadTarget:target callback:^(easyar_Target * target, bool status) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  NSLog(@&quot;load target (%d): %@ (%d)&quot;, status, [target name], [target runtimeID]);</span><br><span class="line"></span><br><span class="line">Â  Â  &#125;];</span><br></pre></td></tr></table></figure><h3 id="3-æ ¹æ®ç›®æ ‡å›¾ç‰‡uidæŒ‡å®šç‰¹å®šè§†é¢‘é“¾æ¥"><a href="#3-æ ¹æ®ç›®æ ‡å›¾ç‰‡uidæŒ‡å®šç‰¹å®šè§†é¢‘é“¾æ¥" class="headerlink" title="3. æ ¹æ®ç›®æ ‡å›¾ç‰‡uidæŒ‡å®šç‰¹å®šè§†é¢‘é“¾æ¥"></a>3. æ ¹æ®ç›®æ ‡å›¾ç‰‡uidæŒ‡å®šç‰¹å®šè§†é¢‘é“¾æ¥</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">if (status == easyar_TargetStatus_Tracked) &#123; // è¿½è¸ªåˆ°ç›®æ ‡</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  int runtimeID = [target runtimeID];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  if (active_target != 0 &amp;&amp; active_target != runtimeID) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  [video onLost];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  video = nil;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  tracked_target = 0;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  active_target = 0;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  if (tracked_target == 0) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  if (video == nil &amp;&amp; [video_renderers count] &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  NSString * target_uid = [target uid];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  NSArray *videoArr = @[@&quot;http://img.dpm.org.cn/Uploads/File/2018/04/19/haitang.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/11/27/wanhean.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/10/30/fxyxd.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/05/03/u5909ad6a125e1.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/05/03/u5909ad888a6c0.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/05/03/repair_new.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/03/22/u58d21fa8ed99a.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/03/22/u58d21f1215622.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/03/22/u58d21f012d948.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/03/22/u58d21fa8ed99a.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/03/22/u58d21f1215622.mp4&quot;,</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  @&quot;http://img.dpm.org.cn/Uploads/File/2017/03/22/u58d21f012d948.mp4&quot;];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if ([[video_renderers objectAtIndex:[target_uid integerValue]] texid] != 0) &#123;</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  NSString *urlStr = [videoArr objectAtIndex:[target_uid integerValue]];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  video = [[ARVideo alloc] init];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  [video openStreamingVideo:urlStr texid:[[video_renderers objectAtIndex:[target_uid integerValue]] texid]];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  current_video_renderer = [video_renderers objectAtIndex:[target_uid integerValue]];</span><br><span class="line"></span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  &#125;</span><br></pre></td></tr></table></figure><p><strong><a href="https://github.com/fusugz/easyarVideo" target="_blank" rel="noopener">Demo</a>å·²ä¸Šä¼ è‡³GitHub</strong>1</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ä¸ºä»€ä¹ˆé€‰EasyAR&quot;&gt;&lt;a href=&quot;#ä¸ºä»€ä¹ˆé€‰EasyAR&quot; class=&quot;headerlink&quot; title=&quot;ä¸ºä»€ä¹ˆé€‰EasyAR&quot;&gt;&lt;/a&gt;ä¸ºä»€ä¹ˆé€‰EasyAR&lt;/h1&gt;&lt;h2 id=&quot;ARçš„å¹¿æ³›åº”ç”¨&quot;&gt;&lt;a href=&quot;#ARçš„å¹¿æ³›åº”ç”¨&quot; class
      
    
    </summary>
    
    
      <category term="AR" scheme="https://fusugz.github.io/tags/AR/"/>
    
  </entry>
  
  <entry>
    <title>H264è§†é¢‘iOSç¡¬è§£ï¼åŸºäºVideo Toolbox è·å–RGBåƒç´ </title>
    <link href="https://fusugz.github.io/2017/11/16/h264-decode-use-video-toolbox/"/>
    <id>https://fusugz.github.io/2017/11/16/h264-decode-use-video-toolbox/</id>
    <published>2017-11-16T08:17:21.000Z</published>
    <updated>2017-11-16T08:33:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬æ–‡è®°å½•åŸºäºVideo Toolboxçš„H264è§†é¢‘æµç¡¬ä»¶è§£ç è·å–RGB888åƒç´ æ•°æ®çš„æ–¹æ³•ã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/2251123-034f5458c6c9c699.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="h264"></p><h1 id="åˆå§‹åŒ–Video-Toolbox"><a href="#åˆå§‹åŒ–Video-Toolbox" class="headerlink" title="åˆå§‹åŒ–Video Toolbox"></a>åˆå§‹åŒ–Video Toolbox</h1><p>åˆå§‹åŒ–æ—¶é‡ç‚¹åœ¨äº<code>attrs</code>ä¸­çš„å‚æ•°,<code>attrs</code>å†³å®šäº†å›è°ƒè¿”å›çš„æ•°æ®ï¼Œå°†<code>values</code>ä¸­çš„<code>v</code>è®¾ä¸º<code>kCVPixelFormatType_32BGRA</code>å¯ä»¥åœ¨å›è°ƒä¸­å¾—åˆ°32bit BGRAæ•°æ®ï¼Œå¦å¤–å‡ ä¸ªå¸¸ç”¨çš„æšä¸¾ç±»å‹æœ‰ä¸º<code>kCVPixelFormatType_420YpCbCr8Planar</code>å’Œ<code>kCVPixelFormatType_420YpCbCr8BiPlanarFullRange</code>,åˆ†åˆ«å¯¹äºè¿”å›æ•°æ®ä¸ºYUV420å’ŒNV12ã€‚å¼€å‘è€…å°è¯•ä½¿ç”¨<code>kCVPixelFormatType_32RGBA</code>ä½œä¸ºå‚æ•°ï¼Œæµ‹è¯•å‘ç°å›è°ƒä¸­å¾—ä¸åˆ°<code>CVPixelBufferRef</code>,é‚æ”¹ç”¨<code>kCVPixelFormatType_32BGRA</code>ï¼Œæœ€ç»ˆè¾¾åˆ°é¢„æœŸã€‚</p><p>å®Œæ•´å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-(BOOL)initH264Decoder</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">if(_deocderSession) &#123;</span><br><span class="line"></span><br><span class="line">return YES;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const uint8_t* const parameterSetPointers[2] = &#123; _sps, _pps &#125;;</span><br><span class="line"></span><br><span class="line">const size_t parameterSetSizes[2] = &#123; _spsSize, _ppsSize &#125;;</span><br><span class="line"></span><br><span class="line">OSStatus status = CMVideoFormatDescriptionCreateFromH264ParameterSets(kCFAllocatorDefault,</span><br><span class="line"></span><br><span class="line">2, //param count</span><br><span class="line"></span><br><span class="line">parameterSetPointers,</span><br><span class="line"></span><br><span class="line">parameterSetSizes,</span><br><span class="line"></span><br><span class="line">4, //nal start code size</span><br><span class="line"></span><br><span class="line">&amp;_decoderFormatDescription);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(status == noErr) &#123;</span><br><span class="line"></span><br><span class="line">CFDictionaryRef attrs = NULL;</span><br><span class="line"></span><br><span class="line">const void *keys[] = &#123; kCVPixelBufferPixelFormatTypeKey &#125;;</span><br><span class="line"></span><br><span class="line">//      kCVPixelFormatType_420YpCbCr8Planar is YUV420</span><br><span class="line"></span><br><span class="line">//      kCVPixelFormatType_420YpCbCr8BiPlanarFullRange is NV12</span><br><span class="line"></span><br><span class="line">uint32_t v = kCVPixelFormatType_32BGRA;</span><br><span class="line"></span><br><span class="line">const void *values[] = &#123; CFNumberCreate(NULL, kCFNumberSInt32Type, &amp;v) &#125;;</span><br><span class="line"></span><br><span class="line">attrs = CFDictionaryCreate(NULL, keys, values, 1, NULL, NULL);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">VTDecompressionOutputCallbackRecord callBackRecord;</span><br><span class="line"></span><br><span class="line">callBackRecord.decompressionOutputCallback = didDecompress;</span><br><span class="line"></span><br><span class="line">callBackRecord.decompressionOutputRefCon = NULL;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">status = VTDecompressionSessionCreate(kCFAllocatorDefault,</span><br><span class="line"></span><br><span class="line">_decoderFormatDescription,</span><br><span class="line"></span><br><span class="line">NULL, attire</span><br><span class="line"></span><br><span class="line">&amp;callBackRecord,</span><br><span class="line"></span><br><span class="line">&amp;_deocderSession);</span><br><span class="line"></span><br><span class="line">CFRelease(attires</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;Current status:%d&quot;, (int)status);</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;IOS8VT: reset decoder session failed status=%d&quot;, (int)status);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return YES;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è§£ç ä¸å¤„ç†å›è°ƒ"><a href="#è§£ç ä¸å¤„ç†å›è°ƒ" class="headerlink" title="è§£ç ä¸å¤„ç†å›è°ƒ"></a>è§£ç ä¸å¤„ç†å›è°ƒ</h1><p>åœ¨å­çº¿ç¨‹ä¸­å¤„ç†è§£ç é€»è¾‘ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dispatch_async(dispatch_get_global_queue(0, 0), ^&#123;</span><br><span class="line"></span><br><span class="line">[self decodeFile:fileName fileExt:@&quot;h264&quot;];</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><code>decodeFile:fileExt:</code>æ–¹æ³•ä½“ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-(void)decodeFile:(NSString*)fileName fileExt:(NSString*)fileExt</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">NSInteger nalIndex = 0;</span><br><span class="line"></span><br><span class="line">CFAbsoluteTime startTime =CFAbsoluteTimeGetCurrent();</span><br><span class="line"></span><br><span class="line">NSString *path = [[NSBundle mainBundle] pathForResource:fileName ofType:fileExt];</span><br><span class="line"></span><br><span class="line">MEVideoFileParser *parser = [MEVideoFileParser alloc];</span><br><span class="line"></span><br><span class="line">[parser open:path];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;Decode start&quot;);</span><br><span class="line"></span><br><span class="line">VideoPacket *vp = nil;</span><br><span class="line"></span><br><span class="line">while(true) &#123;</span><br><span class="line"></span><br><span class="line">vp = [parser nextPacket];</span><br><span class="line"></span><br><span class="line">if(vp == nil) &#123;</span><br><span class="line"></span><br><span class="line">break;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">uint32_t nalSize = (uint32_t)(vp.size - 4);</span><br><span class="line"></span><br><span class="line">uint8_t *pNalSize = (uint8_t*)(&amp;nalSize);</span><br><span class="line"></span><br><span class="line">vp.buffer[0] = *(pNalSize + 3);</span><br><span class="line"></span><br><span class="line">vp.buffer[1] = *(pNalSize + 2);</span><br><span class="line"></span><br><span class="line">vp.buffer[2] = *(pNalSize + 1);</span><br><span class="line"></span><br><span class="line">vp.buffer[3] = *(pNalSize);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CVPixelBufferRef pixelBuffer = NULL;</span><br><span class="line"></span><br><span class="line">int nalType = vp.buffer[4] &amp; 0x1F;</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;Nal type is %d&quot;,nalType);</span><br><span class="line"></span><br><span class="line">switch (nalType) &#123;</span><br><span class="line"></span><br><span class="line">case 0x05:</span><br><span class="line"></span><br><span class="line">//Nal type is IDR frame</span><br><span class="line"></span><br><span class="line">if([self initH264Decoder]) &#123;</span><br><span class="line"></span><br><span class="line">pixelBuffer = [self decode:vp];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">break;</span><br><span class="line"></span><br><span class="line">case 0x07:</span><br><span class="line"></span><br><span class="line">//Nal type is SPS</span><br><span class="line"></span><br><span class="line">_spsSize = vp.size - 4;</span><br><span class="line"></span><br><span class="line">_sps = malloc(_spsSize);</span><br><span class="line"></span><br><span class="line">memcpy(_sps, vp.buffer + 4, _spsSize);</span><br><span class="line"></span><br><span class="line">break;</span><br><span class="line"></span><br><span class="line">case 0x08:</span><br><span class="line"></span><br><span class="line">//Nal type is PPS</span><br><span class="line"></span><br><span class="line">_ppsSize = vp.size - 4;</span><br><span class="line"></span><br><span class="line">_pps = malloc(_ppsSize);</span><br><span class="line"></span><br><span class="line">memcpy(_pps, vp.buffer + 4, _ppsSize);</span><br><span class="line"></span><br><span class="line">break;</span><br><span class="line"></span><br><span class="line">default:</span><br><span class="line"></span><br><span class="line">//Nal type is B/P frame</span><br><span class="line"></span><br><span class="line">pixelBuffer = [self decode:vp];</span><br><span class="line"></span><br><span class="line">break;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(pixelBuffer) &#123;</span><br><span class="line"></span><br><span class="line">dispatch_sync(dispatch_get_main_queue(), ^&#123;</span><br><span class="line"></span><br><span class="line">// æ’­æ”¾</span><br><span class="line"></span><br><span class="line">//_glLayer.pixelBuffer = pixelBuffer;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å¯¹CVPixelBufferRefè¿›è¡Œå¤„ç†ï¼Œè·å–RBGåƒç´ æ•°æ®</span><br><span class="line"></span><br><span class="line">[self writePixelBuffer:pixelBuffer];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åç»­æ“ä½œâ€¦â€¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CVPixelBufferRelease(pixelBuffer);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">nalIndex++;</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;Read Nalu size %ld&quot;, (long)vp.size);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CFAbsoluteTime linkTime = (CFAbsoluteTimeGetCurrent() - startTime);</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;Ellapse %f ms,frame count:%ld&quot;, linkTime * 1000.0,(long)nalIndex);</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;Decode end&quot;);</span><br><span class="line"></span><br><span class="line">[parser close];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[self clearH264Deocder];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œå¯¹VideoPacketè¿›è¡Œè§£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-(CVPixelBufferRef)decode:(VideoPacket*)vp</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">CVPixelBufferRef outputPixelBuffer = NULL;</span><br><span class="line"></span><br><span class="line">CMBlockBufferRef blockBuffer = NULL;</span><br><span class="line"></span><br><span class="line">OSStatus status  = CMBlockBufferCreateWithMemoryBlock(kCFAllocatorDefault,</span><br><span class="line"></span><br><span class="line">(void*)vp.buffer, vp.size,</span><br><span class="line"></span><br><span class="line">kCFAllocatorNull,</span><br><span class="line"></span><br><span class="line">NULL, 0, vp.size,</span><br><span class="line"></span><br><span class="line">0, &amp;blockBuffer);</span><br><span class="line"></span><br><span class="line">if(status == kCMBlockBufferNoErr) &#123;</span><br><span class="line"></span><br><span class="line">CMSampleBufferRef sampleBuffer = NULL;</span><br><span class="line"></span><br><span class="line">const size_t sampleSizeArray[] = &#123;vp.size&#125;;</span><br><span class="line"></span><br><span class="line">status = CMSampleBufferCreateReady(kCFAllocatorDefault,</span><br><span class="line"></span><br><span class="line">blockBuffer,</span><br><span class="line"></span><br><span class="line">_decoderFormatDescription ,</span><br><span class="line"></span><br><span class="line">1, 0, NULL, 1, sampleSizeArray,</span><br><span class="line"></span><br><span class="line">&amp;sampleBuffer);</span><br><span class="line"></span><br><span class="line">if (status == kCMBlockBufferNoErr &amp;&amp; sampleBuffer) &#123;</span><br><span class="line"></span><br><span class="line">VTDecodeFrameFlags flags = 0;</span><br><span class="line"></span><br><span class="line">VTDecodeInfoFlags flagOut = 0;</span><br><span class="line"></span><br><span class="line">OSStatus decodeStatus = VTDecompressionSessionDecodeFrame(_deocderSession,</span><br><span class="line"></span><br><span class="line">sampleBuffer,</span><br><span class="line"></span><br><span class="line">flags,</span><br><span class="line"></span><br><span class="line">&amp;outputPixelBuffer,</span><br><span class="line"></span><br><span class="line">&amp;flagOut);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(decodeStatus == kVTInvalidSessionErr) &#123;</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;IOS8VT: Invalid session, reset decoder session&quot;);</span><br><span class="line"></span><br><span class="line">&#125; else if(decodeStatus == kVTVideoDecoderBadDataErr) &#123;</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;IOS8VT: decode failed status=%d(Bad data)&quot;, (int)decodeStatus);</span><br><span class="line"></span><br><span class="line">&#125; else if(decodeStatus != noErr) &#123;</span><br><span class="line"></span><br><span class="line">DDLogDebug(@&quot;IOS8VT: decode failed status=%d&quot;, (int)decodeStatus);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CFRelease(sampleBuffer);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CFRelease(blockBuffer);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return outputPixelBuffer;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¤„ç†CVPixelBufferRefï¼Œè·å–RGBåƒç´ "><a href="#å¤„ç†CVPixelBufferRefï¼Œè·å–RGBåƒç´ " class="headerlink" title="å¤„ç†CVPixelBufferRefï¼Œè·å–RGBåƒç´ "></a>å¤„ç†<code>CVPixelBufferRef</code>ï¼Œè·å–RGBåƒç´ </h1><p>åœ¨<code>writePixelBuffer</code>æ–¹æ³•ä¸­ï¼Œå¯¹<code>CVPixelBufferRef</code>è¿›è¡Œå¤„ç†ï¼Œå¯å¾—åˆ°RGBåƒç´ ã€‚Video Toolboxè§£ç åçš„å¾—åˆ°çš„å›¾åƒæ•°æ®å¹¶ä¸èƒ½ç›´æ¥ç”±CPUè®¿é—®ï¼Œéœ€å…ˆç”¨<code>CVPixelBufferLockBaseAddress()</code>é”å®šåœ°å€æ‰èƒ½ä»ä¸»å­˜è®¿é—®ï¼Œå¦åˆ™è°ƒç”¨CVPixelBufferGetBaseAddressOfPlaneç­‰å‡½æ•°åˆ™è¿”å›NULLæˆ–æ— æ•ˆå€¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒCVPixelBufferLockBaseAddressè‡ªèº«çš„è°ƒç”¨å¹¶ä¸æ¶ˆè€—å¤šå°‘æ€§èƒ½ï¼Œä¸€èˆ¬æƒ…å†µï¼Œé”å®šä¹‹åï¼Œå¾€CVPixelBufferæ‹·è´å†…å­˜æ‰æ˜¯ç›¸å¯¹è€—æ—¶çš„æ“ä½œï¼Œæ¯”å¦‚è®¡ç®—å†…å­˜åç§»ã€‚å¾…æ•°æ®å¤„ç†å®Œæ¯•ï¼Œè¯·è®°å¾—ä½¿ç”¨<code>CVPixelBufferUnlockBaseAddress()</code> unlockåœ°å€ã€‚</p><p>Â¡</p><p>å°†<code>void *</code>çš„RGBæ•°æ®å¼ºè½¬ä¸º<code>unsigned char *</code>ç±»å‹çš„<code>images</code>æ•°æ®ï¼Œä»¥ä¾¿ç”¨Cè¯­è¨€ä»£ç è¿›è¡Œåç»­å¤„ç†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)writePixelBuffer:(CVPixelBufferRef)pixelBuffer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CVPixelBufferLockBaseAddress(pixelBuffer,kCVPixelBufferLock_ReadOnly);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void * rgb_data = CVPixelBufferGetBaseAddressOfPlane(pixelBuffer,0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">images = (unsigned char *)rgb_data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CVPixelBufferUnlockBaseAddress(pixelBuffer, 0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Clear"><a href="#Clear" class="headerlink" title="Clear"></a>Clear</h1><p>è§£ç å®Œæˆåï¼ŒClear H264è§£ç å™¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-(void)clearH264Deocder</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">if(_deocderSession) &#123;</span><br><span class="line"></span><br><span class="line">VTDecompressionSessionInvalidate(_deocderSession);</span><br><span class="line"></span><br><span class="line">CFRelease(_deocderSession);</span><br><span class="line"></span><br><span class="line">_deocderSession = NULL;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(_decoderFormatDescription) &#123;</span><br><span class="line"></span><br><span class="line">CFRelease(_decoderFormatDescription);</span><br><span class="line"></span><br><span class="line">_decoderFormatDescription = NULL;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">free(_sps);</span><br><span class="line"></span><br><span class="line">free(_pps);</span><br><span class="line"></span><br><span class="line">_spsSize = _ppsSize = 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="é¡¹ç›®ä¸­çš„å®ä¾‹åŒ–å˜é‡å®šä¹‰"><a href="#é¡¹ç›®ä¸­çš„å®ä¾‹åŒ–å˜é‡å®šä¹‰" class="headerlink" title="é¡¹ç›®ä¸­çš„å®ä¾‹åŒ–å˜é‡å®šä¹‰"></a>é¡¹ç›®ä¸­çš„å®ä¾‹åŒ–å˜é‡å®šä¹‰</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">uint8_t *_sps;</span><br><span class="line"></span><br><span class="line">NSInteger _spsSize;</span><br><span class="line"></span><br><span class="line">uint8_t *_pps;</span><br><span class="line"></span><br><span class="line">NSInteger _ppsSize;</span><br><span class="line"></span><br><span class="line">VTDecompressionSessionRef _deocderSession;</span><br><span class="line"></span><br><span class="line">CMVideoFormatDescriptionRef _decoderFormatDescription;</span><br><span class="line"></span><br><span class="line">AAPLEAGLLayer *_glLayer;</span><br><span class="line"></span><br><span class="line">unsigned char *images;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒï¼šiOS-Video-Toolboxï¼šè¯»å†™è§£ç å›è°ƒå‡½æ•°CVImageBufferRefçš„YUVå›¾åƒ"><a href="#å‚è€ƒï¼šiOS-Video-Toolboxï¼šè¯»å†™è§£ç å›è°ƒå‡½æ•°CVImageBufferRefçš„YUVå›¾åƒ" class="headerlink" title="å‚è€ƒï¼šiOS Video Toolboxï¼šè¯»å†™è§£ç å›è°ƒå‡½æ•°CVImageBufferRefçš„YUVå›¾åƒ"></a>å‚è€ƒï¼š<a href="http://www.jianshu.com/p/dac9857b34d0" target="_blank" rel="noopener">iOS Video Toolboxï¼šè¯»å†™è§£ç å›è°ƒå‡½æ•°CVImageBufferRefçš„YUVå›¾åƒ</a></h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ¬æ–‡è®°å½•åŸºäºVideo Toolboxçš„H264è§†é¢‘æµç¡¬ä»¶è§£ç è·å–RGB888åƒç´ æ•°æ®çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2251123-034f5458c6c9c699.p
      
    
    </summary>
    
      <category term="video processing" scheme="https://fusugz.github.io/categories/video-processing/"/>
    
    
      <category term="Objective-C" scheme="https://fusugz.github.io/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºOpenCVçš„iOSå›¾åƒå¤„ç†</title>
    <link href="https://fusugz.github.io/2017/09/07/use-opencv-on-ios/"/>
    <id>https://fusugz.github.io/2017/09/07/use-opencv-on-ios/</id>
    <published>2017-09-07T02:10:36.000Z</published>
    <updated>2017-09-07T02:37:54.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2251123-b1539f93bb74b474.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="OpenCV for iOS"></p><h1 id="å…³äºå›¾ç‰‡å¤„ç†"><a href="#å…³äºå›¾ç‰‡å¤„ç†" class="headerlink" title="å…³äºå›¾ç‰‡å¤„ç†"></a>å…³äºå›¾ç‰‡å¤„ç†</h1><hr><p>éšç€ç§‘æŠ€çš„å‘å±•ï¼ŒAIã€æœºå™¨å­¦ä¹ ã€ARã€VRç­‰å·²ç»é€æ¸èµ°è¿›ç”Ÿæ´»ï¼Œæ¨¡å¼è¯†åˆ«ã€å›¾åƒæ•æ‰ã€å›¾ç‰‡æ‹¼æ¥ç­‰å·²ç»æˆä¸ºå…¶ä¸­çš„é‡è¦ç¯èŠ‚ã€‚å› æ­¤ï¼Œå›¾åƒå¤„ç†æŠ€æœ¯åœ¨æœªæ¥ä¼šè¢«ç§»åŠ¨ç«¯å¹¿æ³›ä½¿ç”¨ã€‚å…¶ä¸­ï¼Œæœ‰å¾ˆå¤šC++çš„åº“çš„åº”ç”¨æ™®éï¼Œå¸¸ç”¨çš„æœ‰ï¼šOpenCVã€FreeImageã€CImgå’ŒCxImageã€‚</p><p>å…³äºè¿™å‡ ä¸ªåº“çš„ç‰¹ç‚¹å’Œä¼˜ç¼ºç‚¹å¯ä»¥å‚è€ƒ<a href="http://dataunion.org/20307.html" target="_blank" rel="noopener">å›¾åƒè¯†åˆ«å››å¤§å›¾åƒåº“æ¯”è¾ƒ</a>ã€‚</p><h1 id="å…³äºOpenCV"><a href="#å…³äºOpenCV" class="headerlink" title="å…³äºOpenCV"></a>å…³äºOpenCV</h1><hr><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><blockquote><p>OpenCV (Open Source Computer Vision Library)æ˜¯ä¸€ä¸ªåœ¨BSDè®¸å¯ä¸‹å‘å¸ƒçš„å¼€æºåº“ï¼Œå› æ­¤å®ƒæ˜¯å…è´¹æä¾›ç»™å­¦æœ¯å’Œå•†ä¸šç”¨é€”ã€‚æœ‰C++ã€Cã€Pythonå’ŒJavaæ¥å£ï¼Œæ”¯æŒWindowsã€Linuxã€MacOSã€iOSå’ŒAndroidç­‰ç³»ç»Ÿã€‚OpenCVæ˜¯ä¸ºè®¡ç®—æ•ˆç‡è€Œè®¾è®¡çš„ï¼Œè€Œä¸”å¯†åˆ‡å…³æ³¨å®æ—¶åº”ç”¨ç¨‹åºçš„å‘å±•å’Œæ”¯æŒã€‚è¯¥åº“ç”¨ä¼˜åŒ–çš„C/C++ç¼–å†™,å¯ä»¥åº”ç”¨äºå¤šæ ¸å¤„ç†ã€‚åœ¨å¯ç”¨OpenCLçš„åŸºç¡€ä¸Šï¼Œå®ƒå¯ä»¥åˆ©ç”¨åº•å±‚çš„å¼‚æ„è®¡ç®—å¹³å°çš„ç¡¬ä»¶åŠ é€Ÿã€‚</p></blockquote><p>â€”â€”opencv.org</p><h2 id="OpenCVçš„æ¨¡å—"><a href="#OpenCVçš„æ¨¡å—" class="headerlink" title="OpenCVçš„æ¨¡å—"></a>OpenCVçš„æ¨¡å—</h2><p>ä»<a href="[http://docs.opencv.org/2.4/modules/core/doc/intro.html">å®˜æ–¹æ–‡æ¡£</a>ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶åŒ…å«æ¨¡å—ä»¥åŠå¯¹iOSçš„æ”¯æŒæƒ…å†µã€‚</p><blockquote><ul><li>coreï¼šç®€æ´çš„æ ¸å¿ƒæ¨¡å—ï¼Œå®šä¹‰äº†åŸºæœ¬çš„æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬ç¨ å¯†å¤šç»´æ•°ç»„ Mat å’Œå…¶ä»–æ¨¡å—éœ€è¦çš„åŸºæœ¬å‡½æ•°ã€‚</li></ul></blockquote><blockquote><ul><li>imgprocï¼šå›¾åƒå¤„ç†æ¨¡å—ï¼ŒåŒ…æ‹¬çº¿æ€§å’Œéçº¿æ€§å›¾åƒæ»¤æ³¢ã€å‡ ä½•å›¾åƒè½¬æ¢ (ç¼©æ”¾ã€ä»¿å°„ä¸é€è§†å˜æ¢ã€ä¸€èˆ¬æ€§åŸºäºè¡¨çš„é‡æ˜ å°„)ã€é¢œè‰²ç©ºé—´è½¬æ¢ã€ç›´æ–¹å›¾ç­‰ç­‰ã€‚</li></ul></blockquote><blockquote><ul><li>videoï¼šè§†é¢‘åˆ†ææ¨¡å—ï¼ŒåŒ…æ‹¬è¿åŠ¨ä¼°è®¡ã€èƒŒæ™¯æ¶ˆé™¤ã€ç‰©ä½“è·Ÿè¸ªç®—æ³•ã€‚</li></ul></blockquote><blockquote><ul><li>calib3dï¼šåŒ…æ‹¬åŸºæœ¬çš„å¤šè§†è§’å‡ ä½•ç®—æ³•ã€å•ä½“å’Œç«‹ä½“ç›¸æœºçš„æ ‡å®šã€å¯¹è±¡å§¿æ€ä¼°è®¡ã€åŒç›®ç«‹ä½“åŒ¹é…ç®—æ³•å’Œå…ƒç´ çš„ä¸‰ç»´é‡å»ºã€‚</li></ul></blockquote><blockquote><ul><li>features2dï¼šåŒ…å«äº†æ˜¾è‘—ç‰¹å¾æ£€æµ‹ç®—æ³•ã€æè¿°ç®—å­å’Œç®—å­åŒ¹é…ç®—æ³•ã€‚</li></ul></blockquote><blockquote><ul><li>objdetectï¼šç‰©ä½“æ£€æµ‹å’Œä¸€äº›é¢„å®šä¹‰çš„ç‰©ä½“çš„æ£€æµ‹ (å¦‚äººè„¸ã€çœ¼ç›ã€æ¯å­ã€äººã€æ±½è½¦ç­‰)ã€‚</li></ul></blockquote><blockquote><ul><li>mlï¼šå¤šç§æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå¦‚ K å‡å€¼ã€æ”¯æŒå‘é‡æœºå’Œç¥ç»ç½‘ç»œã€‚</li></ul></blockquote><blockquote><ul><li>highguiï¼šä¸€ä¸ªç®€å•æ˜“ç”¨çš„æ¥å£ï¼Œæä¾›è§†é¢‘æ•æ‰ã€å›¾åƒå’Œè§†é¢‘ç¼–ç ç­‰åŠŸèƒ½ï¼Œè¿˜æœ‰ç®€å•çš„ UI æ¥å£ (iOS ä¸Šå¯ç”¨çš„ä»…æ˜¯å…¶ä¸€ä¸ªå­é›†)ã€‚</li></ul></blockquote><blockquote><ul><li>gpuï¼šOpenCV ä¸­ä¸åŒæ¨¡å—çš„ GPU åŠ é€Ÿç®—æ³• (iOS ä¸Šä¸å¯ç”¨)ã€‚</li></ul></blockquote><blockquote><ul><li>oclï¼šä½¿ç”¨ OpenCL å®ç°çš„é€šç”¨ç®—æ³• (iOS ä¸Šä¸å¯ç”¨)ã€‚</li></ul></blockquote><blockquote><ul><li>ä¸€äº›å…¶å®ƒè¾…åŠ©æ¨¡å—ï¼Œå¦‚ Python ç»‘å®šå’Œç”¨æˆ·è´¡çŒ®çš„ç®—æ³•ã€‚</li></ul></blockquote><h2 id="æˆ‘ä»¬å¯ä»¥åˆ©ç”¨OpenCVåœ¨iOSä¸Šåšä»€ä¹ˆ"><a href="#æˆ‘ä»¬å¯ä»¥åˆ©ç”¨OpenCVåœ¨iOSä¸Šåšä»€ä¹ˆ" class="headerlink" title="æˆ‘ä»¬å¯ä»¥åˆ©ç”¨OpenCVåœ¨iOSä¸Šåšä»€ä¹ˆ"></a>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨OpenCVåœ¨iOSä¸Šåšä»€ä¹ˆ</h2><p>åŸºäºOpenCVï¼ŒiOSåº”ç”¨ç¨‹åºå¯ä»¥å®ç°å¾ˆå¤šæœ‰è¶£çš„åŠŸèƒ½ï¼Œä¹Ÿå¯ä»¥æŠŠå¾ˆå¤šå¤æ‚çš„å·¥ä½œç®€å•åŒ–ã€‚ä¸€èˆ¬å¯ç”¨äºï¼š</p><ul><li><p>å¯¹å›¾ç‰‡è¿›è¡Œç°åº¦å¤„ç†ï¼ˆå®˜æ–¹ç¤ºä¾‹ï¼‰</p></li><li><p>äººè„¸è¯†åˆ«ï¼Œå³ç‰¹å¾è·Ÿè¸ªï¼ˆå®˜æ–¹ç¤ºä¾‹ï¼‰</p></li><li><p>è®­ç»ƒå›¾ç‰‡ç‰¹å¾åº“ï¼ˆå¯ç”¨äºæ¨¡å¼è¯†åˆ«ï¼‰</p></li><li><p>æå–ç‰¹å®šå›¾åƒå†…å®¹ï¼ˆæ ¹æ®éœ€æ±‚è¿˜åŸæœ‰ç”¨å›¾åƒä¿¡æ¯ï¼‰</p></li></ul><p>â€¦â€¦</p><h1 id="å¯¼å…¥OpenCV"><a href="#å¯¼å…¥OpenCV" class="headerlink" title="å¯¼å…¥OpenCV"></a>å¯¼å…¥OpenCV</h1><hr><p>opencvç›®å‰åˆ†ä¸ºä¸¤ä¸ªç‰ˆæœ¬ç³»åˆ—ï¼šopencv2.4.xå’Œopencv3.xã€‚</p><p>å¯¼å…¥é¡¹ç›®çš„ä¸¤ç§æ–¹å¼ï¼š</p><h2 id="1-ä»å®˜ç½‘ä¸‹è½½æ¡†æ¶ï¼Œå¼•å…¥å·¥ç¨‹ã€‚"><a href="#1-ä»å®˜ç½‘ä¸‹è½½æ¡†æ¶ï¼Œå¼•å…¥å·¥ç¨‹ã€‚" class="headerlink" title="1.ä»å®˜ç½‘ä¸‹è½½æ¡†æ¶ï¼Œå¼•å…¥å·¥ç¨‹ã€‚"></a>1.ä»å®˜ç½‘ä¸‹è½½æ¡†æ¶ï¼Œå¼•å…¥å·¥ç¨‹ã€‚</h2><ol><li><p>å‰å¾€<a href="http://opencv.org" target="_blank" rel="noopener">OpenCVå®˜ç½‘</a>æˆ–<a href="http://opencv.org.cn" target="_blank" rel="noopener">OpenCVä¸­æ–‡å®˜ç½‘</a>ä¸‹è½½ç›¸å…³iOSç‰ˆæœ¬frameworkæ–‡ä»¶ï¼Œä»é¡¹ç›®å¼•å…¥ï¼Œ</p></li><li><p>å¯¼å…¥OpenCVä¾èµ–åº“</p></li></ol><ul><li><p>libc++.tbd</p></li><li><p>AVFoundation.framework</p></li><li><p>CoreImage.framework</p></li><li><p>QuartzCore.framework</p></li><li><p>Accelerate.framework</p></li><li><p>CoreVideo.framework</p></li><li><p>CoreMedia.framework</p></li><li><p>AssetsLibrary.framework</p></li></ul><ol><li>å¼•å…¥ç›¸å…³å¤´æ–‡ä»¶</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#import &lt;opencv2/opencv.hpp&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &lt;opencv2/imgproc/types_c.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &lt;opencv2/imgcodecs/ios.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &lt;opencv2/highgui/highgui_c.h&gt;</span><br></pre></td></tr></table></figure><p><strong>æ³¨ï¼šä½¿ç”¨OpenCVçš„ç±»å¿…é¡»æ”¯æŒC++çš„ç¼–è¯‘ç¯å¢ƒï¼ŒæŠŠ.mæ–‡ä»¶æ”¹ä¸º.mmå³å¯ã€‚</strong></p><h2 id="2-ä½¿ç”¨CocoaPodså®‰è£…ã€‚"><a href="#2-ä½¿ç”¨CocoaPodså®‰è£…ã€‚" class="headerlink" title="2.ä½¿ç”¨CocoaPodså®‰è£…ã€‚"></a>2.ä½¿ç”¨CocoaPodså®‰è£…ã€‚</h2><p>å¾ˆç®€å•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">pod &apos;OpenCV&apos;</span><br></pre></td></tr></table></figure><h1 id="OpenCVçš„ç®€å•ä½¿ç”¨"><a href="#OpenCVçš„ç®€å•ä½¿ç”¨" class="headerlink" title="OpenCVçš„ç®€å•ä½¿ç”¨"></a>OpenCVçš„ç®€å•ä½¿ç”¨</h1><hr><p>å¤„ç†å›¾ç‰‡å¯ä»¥åˆ›å»ºä¸€ä¸ªUIImageçš„åˆ†ç±»ï¼ŒOpenCVå›¾åƒå¤„ç†çš„ç›¸å…³ä»£ç éƒ½å¯ä»¥åœ¨è¿™ä¸ªç±»ä¸­å®ç°ã€‚</p><p>ä»£ç å¯è§<a href="https://github.com/fusugz/OpenCVDemo" target="_blank" rel="noopener">ç¬”è€…Githubé¡¹ç›®åœ°å€</a></p><h2 id="å›¾åƒç°åº¦å¤„ç†"><a href="#å›¾åƒç°åº¦å¤„ç†" class="headerlink" title="å›¾åƒç°åº¦å¤„ç†"></a>å›¾åƒç°åº¦å¤„ç†</h2><p>1.åœ¨.hæ–‡ä»¶ä¸­å£°æ˜ä¸¤ä¸ªç±»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@property (nonatomic, readonly) cv::Mat CVMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@property (nonatomic, readonly) cv::Mat CVGrayscaleMat;</span><br></pre></td></tr></table></figure><p>2.å£°æ˜Matä¸UIImageäº’ç›¸è½¬æ¢ä»¥åŠç°åº¦å¤„ç†å¹¶è¿”å›UIImageå¯¹è±¡çš„å¤–éƒ¨æ–¹æ³•</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat --&gt; UIImage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@return UIImage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+ (UIImage *)imageWithCVMat:(const cv::Mat&amp;)cvMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UIImage --&gt; cv::Mat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@param image image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@return cv::Mat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+ (cv::Mat)cvMatFromUIImage:(UIImage *)image;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UIImage --&gt; cv::Mat (gray)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@param image image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@return cv::Mat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+ (cv::Mat)cvMatGrayFromUIImage:(UIImage *)image;</span><br></pre></td></tr></table></figure><p>3.åœ¨.mä¸­å®ç°ç›¸å…³æ–¹æ³•</p><p>ç”Ÿæˆcv::Matå¯¹è±¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (cv::Mat)CVMat &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGColorSpaceRef colorSpace = CGImageGetColorSpace(self.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat cols = self.size.width;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat rows = self.size.height;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat cvMat(rows,cols,CV_8UC(4)); // 8 bits per component,4 channels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRef contextRef = CGBitmapContextCreate(cvMat.data,                // Pointer to backing data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cols,                      // Width of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rows,                      // Height of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8,                         // Bits per conponent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvMat.step[0],             // Bytes per row</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">colorSpace,                // Colorspace</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGImageAlphaNoneSkipLast |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGBitmapByteOrderDefault);// Bitmap info flags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextDrawImage(contextRef, CGRectMake(0, 0, cols, rows), self.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRelease(contextRef);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return cvMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆç°åº¦cv::Matå¯¹è±¡</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (cv::Mat)CVGrayscaleMat &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceGray();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat cols = self.size.width;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat rows = self.size.height;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat cvMat = cv::Mat(rows,cols,CV_8SC1); // 8 bits per conponpent,1 channel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRef contextRef = CGBitmapContextCreate(cvMat.data,                // Pointer to backing data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cols,                      // Width of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rows,                      // Height of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8,                         // Bits of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvMat.step[0],             //Bytes per row</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">colorSpace,                // Colorspace</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGImageAlphaNone |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGBitmapByteOrderDefault);// Bitmap info flags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextDrawImage(contextRef, CGRectMake(0, 0, cols, rows), self.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRelease(contextRef);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGColorSpaceRelease(colorSpace);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return cvMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>cv::Mat â€“&gt; UIImage</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ (UIImage *)imageWithCVMat:(const cv::Mat &amp;)cvMat &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return [[UIImage alloc] initWithCVMat:cvMat];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+ (cv::Mat)cvMatFromUIImage:(UIImage *)image &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGColorSpaceRef colorSpace = CGImageGetColorSpace(image.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat cols = image.size.width;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat rows = image.size.height;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat cvMat(rows, cols, CV_8UC4); // 8 bits per component, 4 channels (color channels + alpha)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRef contextRef = CGBitmapContextCreate(cvMat.data,                 // Pointer to  data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cols,                       // Width of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rows,                       // Height of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8,                          // Bits per component</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvMat.step[0],              // Bytes per row</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">colorSpace,                 // Colorspace</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGImageAlphaNoneSkipLast |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGBitmapByteOrderDefault); // Bitmap info flags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextDrawImage(contextRef, CGRectMake(0, 0, cols, rows), image.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRelease(contextRef);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return cvMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UIimage â€“&gt; Gray cv::Mat</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ (cv::Mat)cvMatGrayFromUIImage:(UIImage *)image &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGColorSpaceRef colorSpace = CGImageGetColorSpace(image.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat cols = image.size.width;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGFloat rows = image.size.height;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat cvMat(rows, cols, CV_8UC1); // 8 bits per component, 1 channels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRef contextRef = CGBitmapContextCreate(cvMat.data,                 // Pointer to data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cols,                       // Width of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rows,                       // Height of bitmap</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">8,                          // Bits per component</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvMat.step[0],              // Bytes per row</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">colorSpace,                 // Colorspace</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGImageAlphaNoneSkipLast |</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">kCGBitmapByteOrderDefault); // Bitmap info flags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextDrawImage(contextRef, CGRectMake(0, 0, cols, rows), image.CGImage);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGContextRelease(contextRef);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return cvMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.åœ¨æ§åˆ¶å™¨ä¸­è°ƒç”¨UIImage+OpenCVç›¸å…³ä»£ç ï¼Œå®ç°å›¾ç‰‡ç°åº¦å¤„ç†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UIImage *image = [UIImage imageNamed:@&quot;icon.jpg&quot;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat inputMat = [UIImage cvMatFromUIImage:image];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat greyMat;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::cvtColor(inputMat, greyMat, CV_BGR2GRAY);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//cv::Mat greyMat = [UIImage cvMatGrayFromUIImage:image];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UIImage *greyImage = [UIImage imageWithCVMat:greyMat];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">self.imageView.image = greyImage;</span><br></pre></td></tr></table></figure><p>5.æ•ˆæœ</p><p><img src="http://upload-images.jianshu.io/upload_images/2251123-cf81da71909a46a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åŸå›¾"></p><p><img src="http://upload-images.jianshu.io/upload_images/2251123-693a4d64aaea3539.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="å¤„ç†å"></p><h2 id="äººè„¸è¯†åˆ«"><a href="#äººè„¸è¯†åˆ«" class="headerlink" title="äººè„¸è¯†åˆ«"></a>äººè„¸è¯†åˆ«</h2><p>å…³äºäººè„¸è¯†åˆ«çš„å®ç°ï¼Œå¯ä»¥å‚è€ƒ<a href="[https://objccn.io/issue-21-9/">åŸºäºOpenCVçš„äººè„¸è¯†åˆ«</a>ã€‚è¿™æ˜¯ObjCä¸­å›½ä¸Šä¸€ç¯‡è¯‘æ–‡ï¼Œä½œè€…æ˜¯å›½å¤–å¤§ç‰›ï¼Œè¿™ç‰‡åšå®¢å†™å¾—éå¸¸è¯¦å°½ã€‚</p><p>æˆ‘çš„Demoä¸­ä¸å«æœ‰æ‹ç…§éƒ¨åˆ†ï¼Œç›´æ¥å¯¹ä¸€å¼ å›¾ç‰‡ä¸­çš„äººè„¸è¿›è¡Œè¯†åˆ«ï¼Œå…¶å®ç°å¦‚ä¸‹ï¼š</p><p>1.åˆ›å»ºä¸€ä¸ªObjective-C++çš„ç±»FaceRecognitionï¼ˆå³æŠŠ.mæ–‡ä»¶.mmæ–‡ä»¶ï¼Œæ”¯æŒObjective-Cä¸C++æ··ç¼–ï¼‰</p><p>2.å¼•å…¥å¤´æ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &lt;opencv2/opencv.hpp&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &lt;opencv2/imgproc/types_c.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &lt;opencv2/imgcodecs/ios.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;UIImage+OpenCV.h&quot;</span><br></pre></td></tr></table></figure><p>3.å¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†è½¬åŒ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">+ (UIImage *)convertImage: (UIImage *)image &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åˆå§‹åŒ–ä¸€ä¸ªå›¾ç‰‡çš„äºŒç»´çŸ©é˜µcvImage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat cvImage;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å°†å›¾ç‰‡UIImageå¯¹è±¡è½¬ä¸ºMatå¯¹è±¡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvImage = [UIImage cvMatFromUIImage:image];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (!cvImage.empty()) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat gray;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// è¿›ä¸€æ­¥å°†å›¾ç‰‡è½¬ä¸ºç°åº¦æ˜¾ç¤º</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::cvtColor(cvImage, gray, CV_RGB2GRAY);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åˆ©ç”¨ææ­»æ»¤é•œå»é™¤è¾¹ç¼˜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::GaussianBlur(gray, gray, cv::Size(5, 5), 1.2, 1.2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// è®¡ç®—ç”»å¸ƒ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat edges;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Canny(gray, edges, 0, 50);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨ç™½è‰²å¡«å……</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvImage.setTo(cv::Scalar::all(225));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä¿®æ”¹è¾¹ç¼˜é¢œè‰²</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvImage.setTo(cv::Scalar(0,128,255,255),edges);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å°†Matè½¬æ¢ä¸ºUIImage</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return [UIImage imageWithCVMat:cvImage];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return nil;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.è¯»å–å›¾ç‰‡ä¸­äººè„¸çš„ç›¸å…³æ•°æ®å¹¶å­˜å‚¨</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ (NSArray*)facePointDetectForImage:(UIImage*)image&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">static cv::CascadeClassifier faceDetector;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">static dispatch_once_t onceToken;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ·»åŠ xmlæ–‡ä»¶</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString* cascadePath = [[NSBundle mainBundle]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pathForResource:@&quot;haarcascade_frontalface_alt2&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ofType:@&quot;xml&quot;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">faceDetector.load([cascadePath UTF8String]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat faceImage;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">faceImage = [UIImage cvMatFromUIImage:image];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// è½¬ä¸ºç°åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat gray;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvtColor(faceImage, gray, CV_BGR2GRAY);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ£€æµ‹äººè„¸å¹¶å‚¨å­˜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">std::vector&lt;cv::Rect&gt;faces;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">faceDetector.detectMultiScale(gray, faces,1.1,2,CV_HAAR_FIND_BIGGEST_OBJECT,cv::Size(30,30));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSMutableArray *array = [NSMutableArray array];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for(unsigned int i= 0;i &lt; faces.size();i++)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const cv::Rect&amp; face = faces[i];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">float height = (float)faceImage.rows;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">float width = (float)faceImage.cols;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CGRect rect = CGRectMake(face.x/width, face.y/height, face.width/width, face.height/height);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[array addObject:[NSNumber valueWithCGRect:rect]];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return [array copy];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.æ£€æµ‹äººè„¸å¹¶åœ¨å›¾ç‰‡ä¸Šäººè„¸éƒ¨åˆ†æ·»åŠ çº¢è‰²çŸ©å½¢çº¿æ¡†ä»¥æ ‡è¯†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ (UIImage*)faceDetectForImage:(UIImage*)image &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">static cv::CascadeClassifier faceDetector;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">static dispatch_once_t onceToken;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dispatch_once(&amp;onceToken, ^&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString* cascadePath = [[NSBundle mainBundle]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pathForResource:@&quot;haarcascade_frontalface_alt&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ofType:@&quot;xml&quot;];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">faceDetector.load([cascadePath UTF8String]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat faceImage;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">faceImage = [UIImage cvMatFromUIImage:image];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// è½¬ä¸ºç°åº¦</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Mat gray;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cvtColor(faceImage, gray, CV_BGR2GRAY);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// æ£€æµ‹äººè„¸å¹¶å‚¨å­˜</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">std::vector&lt;cv::Rect&gt;faces;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">faceDetector.detectMultiScale(gray, faces,1.1,2,0,cv::Size(30,30));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// åœ¨æ¯ä¸ªäººè„¸ä¸Šç”»ä¸€ä¸ªçº¢è‰²å››æ–¹å½¢</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for(unsigned int i= 0;i &lt; faces.size();i++)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const cv::Rect&amp; face = faces[i];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Point tl(face.x,face.y);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Point br = tl + cv::Point(face.width,face.height);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å››æ–¹å½¢çš„ç”»æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::Scalar magenta = cv::Scalar(255, 0, 0, 255);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cv::rectangle(faceImage, tl, br, magenta, 2, 2, 0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return [UIImage imageWithCVMat:faceImage];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>6.è¿è¡Œæ•ˆæœ</p><p><img src="http://upload-images.jianshu.io/upload_images/2251123-c1e60be522f96708.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Face Recognition"></p><h1 id="Objective-Cä¸C-æ··ç¼–"><a href="#Objective-Cä¸C-æ··ç¼–" class="headerlink" title="Objective-Cä¸C++æ··ç¼–"></a>Objective-Cä¸C++æ··ç¼–</h1><hr><p>å¾ˆå¤šåœ°æ–¹éœ€è¦ç”¨åˆ°Objective-Cä¸C++æ··ç¼–ï¼Œæ¥è§£å†³ä¸€äº›å¯¹è±¡çš„ä¼ é€’è½¬æ¢é—®é¢˜ã€‚</p><h2 id="å­—ç¬¦ä¸²çš„è½¬æ¢"><a href="#å­—ç¬¦ä¸²çš„è½¬æ¢" class="headerlink" title="å­—ç¬¦ä¸²çš„è½¬æ¢"></a>å­—ç¬¦ä¸²çš„è½¬æ¢</h2><p>åœ¨C++ä¸­ï¼Œå­—ç¬¦ä¸²å¯¹è±¡ä¸º<code>char *</code>,è€Œåœ¨Objective-Cä¸­å­—ç¬¦ä¸²å¯¹è±¡ä¸º<code>NSString</code>,åœ¨ç¼–ç¨‹ä¸­å¸¸å¸¸éœ€è¦åœ¨äºŒè€…ä¹‹é—´äº’ç›¸è½¬æ¢ã€‚</p><p>1.<code>NSString</code>è½¬æ¢ä¸º<code>char *</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString --&gt; char *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@param string NSString (Objective-C)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@return char *         (C++)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">char * string2Char(NSString *string) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const char *charString = [string UTF8String];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">char *result = new char[strlen(charString) + 1];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">strcpy(result, charString);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//    delete[] result;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return result;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>2.<code>char *</code>è½¬æ¢ä¸º<code>NSString</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSString *OCString = [NSString stringWithUTF8String:cppString];</span><br></pre></td></tr></table></figure><h2 id="å‚¨å­˜cv-Matå›¾ç‰‡å¯¹è±¡"><a href="#å‚¨å­˜cv-Matå›¾ç‰‡å¯¹è±¡" class="headerlink" title="å‚¨å­˜cv::Matå›¾ç‰‡å¯¹è±¡"></a>å‚¨å­˜cv::Matå›¾ç‰‡å¯¹è±¡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Write image to Document</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@param imageName image name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@param img cv::Mat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@return if complete</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bool writeImage2Document(const char *imageName, cv::Mat img) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">UIImage *stitchedImage = [[UIImage alloc] initWithCVMat:img];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString *docPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString *imagePath = [docPath stringByAppendingString:[NSString stringWithFormat:@&quot;/%@&quot;,[NSString stringWithUTF8String:imageName]]];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å°†UIImageå¯¹è±¡è½¬æ¢æˆNSDataå¯¹è±¡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSData *data = UIImageJPEGRepresentation(stitchedImage, 0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[data writeToFile:imagePath atomically:YES];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return true;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><hr><p>OpenCVå®åœ¨æ˜¯å¤ªå¼ºå¤§äº†ï¼Œç¬”è€…å†³å®šæ½œå¿ƒç ”ç©¶ï¼Œæš‚ä¸æ€»ç»“ï¼Œæ‰€ä»¥æ²¡æœ‰æ€»ç»“ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2251123-b1539f93bb74b474.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="OpenCV" scheme="https://fusugz.github.io/categories/OpenCV/"/>
    
    
      <category term="image" scheme="https://fusugz.github.io/tags/image/"/>
    
      <category term="OpenCV" scheme="https://fusugz.github.io/tags/OpenCV/"/>
    
      <category term="Recognition" scheme="https://fusugz.github.io/tags/Recognition/"/>
    
  </entry>
  
  <entry>
    <title>ä¸å¾—ä¸è¯´çš„iOSå­—ä½“åœ¨appä¸­çš„ä½¿ç”¨è§„èŒƒ</title>
    <link href="https://fusugz.github.io/2017/08/23/iOS-font-setting/"/>
    <id>https://fusugz.github.io/2017/08/23/iOS-font-setting/</id>
    <published>2017-08-23T08:54:24.000Z</published>
    <updated>2017-08-23T09:10:10.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily-fontï¼‰"><a href="#iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily-fontï¼‰" class="headerlink" title="iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily fontï¼‰"></a>iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily fontï¼‰</h1><p>ç³»ç»Ÿå­—ä½“æ„å‘³ç€å¯ä»¥ä¸éœ€è¦å¦å¤–å¯¼å…¥å­—ä½“åŒ…å°±å¯ä»¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œè€Œä¸”ä¸æ¶‰åŠå•†ç”¨ç‰ˆæƒé—®é¢˜ã€‚</p><p>1.ç³»ç»Ÿå®¶æ—å­—ä½“</p><p>å¯é€šè¿‡ä»¥ä¸‹ä»£ç åœ¨æ§åˆ¶å°æ‰“å°å‡ºç³»ç»Ÿå®¶æ—å­—ä½“çš„ä¸ªæ•°å’Œå­—ä½“åç§°ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSArray * nameArray = [UIFont familyNames];</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;iOS family font count:%ld&quot;,(long)[nameArray count]);</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;iOS family font list:\n&quot;);</span><br><span class="line"></span><br><span class="line">    for (NSString *fontName in nameArray) &#123;</span><br><span class="line"></span><br><span class="line">        NSLog(@&quot;---%@---&quot;,fontName);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼š</p><blockquote><p>iOS family font count:75</p></blockquote><p>iOS family font list:</p><p>â€”Copperplateâ€”</p><p>â€”Heiti SCâ€”</p><p>â€”Kohinoor Teluguâ€”</p><p>â€”Thonburiâ€”</p><p>â€”Heiti TCâ€”</p><p>â€”Courier Newâ€”</p><p>â€”Gill Sansâ€”</p><p>â€”Apple SD Gothic Neoâ€”</p><p>â€”Marker Feltâ€”</p><p>â€”Avenir Next Condensedâ€”</p><p>â€”Tamil Sangam MNâ€”</p><p>â€”Helvetica Neueâ€”</p><p>â€”Gurmukhi MNâ€”</p><p>â€”Times New Romanâ€”</p><p>â€”Georgiaâ€”</p><p>â€”Apple Color Emojiâ€”</p><p>â€”Arial Rounded MT Boldâ€”</p><p>â€”Kailasaâ€”</p><p>â€”Kohinoor Devanagariâ€”</p><p>â€”Kohinoor Banglaâ€”</p><p>â€”Chalkboard SEâ€”</p><p>â€”Sinhala Sangam MNâ€”</p><p>â€”PingFang TCâ€”</p><p>â€”Gujarati Sangam MNâ€”</p><p>â€”Damascusâ€”</p><p>â€”Noteworthyâ€”</p><p>â€”Geeza Proâ€”</p><p>â€”Avenirâ€”</p><p>â€”Academy Engraved LETâ€”</p><p>â€”Mishafiâ€”</p><p>â€”Futuraâ€”</p><p>â€”Farahâ€”</p><p>â€”Kannada Sangam MNâ€”</p><p>â€”Arial Hebrewâ€”</p><p>â€”Arialâ€”</p><p>â€”Party LETâ€”</p><p>â€”Chalkdusterâ€”</p><p>â€”Hoefler Textâ€”</p><p>â€”Optimaâ€”</p><p>â€”Palatinoâ€”</p><p>â€”Lao Sangam MNâ€”</p><p>â€”Malayalam Sangam MNâ€”</p><p>â€”Al Nileâ€”</p><p>â€”Bradley Handâ€”</p><p>â€”PingFang HKâ€”</p><p>â€”Trebuchet MSâ€”</p><p>â€”Helveticaâ€”</p><p>â€”Courierâ€”</p><p>â€”Cochinâ€”</p><p>â€”Hiragino Mincho ProNâ€”</p><p>â€”Devanagari Sangam MNâ€”</p><p>â€”Oriya Sangam MNâ€”</p><p>â€”Snell Roundhandâ€”</p><p>â€”Zapf Dingbatsâ€”</p><p>â€”Bodoni 72â€”</p><p>â€”Verdanaâ€”</p><p>â€”American Typewriterâ€”</p><p>â€”Avenir Nextâ€”</p><p>â€”Baskervilleâ€”</p><p>â€”Khmer Sangam MNâ€”</p><p>â€”Didotâ€”</p><p>â€”Savoye LETâ€”</p><p>â€”Bodoni Ornamentsâ€”</p><p>â€”Symbolâ€”</p><p>â€”Menloâ€”</p><p>â€”Bodoni 72 Smallcapsâ€”</p><p>â€”Papyrusâ€”</p><p>â€”Hiragino Sansâ€”</p><p>â€”PingFang SCâ€”</p><p>â€”Myanmar Sangam MNâ€”</p><p>â€”Euphemia UCASâ€”</p><p>â€”Telugu Sangam MNâ€”</p><p>â€”Bangla Sangam MNâ€”</p><p>â€”Zapfinoâ€”</p><p>â€”Bodoni 72 Oldstyleâ€”</p><p>2.family fontçš„ä½¿ç”¨</p><p>å¯çŸ¥ï¼ŒiOSå¯ç”¨çš„å­—ä½“å…±æœ‰75ç§ï¼ŒåŠ ä¸Šé»˜è®¤ç³»ç»Ÿå­—ä½“San Franciscoï¼Œæœ‰76ç§ï¼ŒåŸºæœ¬èƒ½æ»¡è¶³appå¼€å‘çš„éœ€æ±‚ï¼Œè¿™äº›ç³»ç»Ÿæä¾›çš„å­—ä½“çš„ä½¿ç”¨åªéœ€è¦æŒ‡å®šå…¶font nameå³å¯ã€‚</p><p>ç„¶è€Œï¼Œä¸€äº›è®¾è®¡å¸ˆåœ¨è®¾è®¡UIæ—¶å¸¸å¸¸ä½¿ç”¨ä¸€äº›ç¬¬ä¸‰æ–¹å­—ä½“ï¼Œè¿™å°±éœ€è¦åŒºåˆ«å¤„ç†ã€‚</p><h1 id="ç¬¬ä¸‰æ–¹å­—ä½“"><a href="#ç¬¬ä¸‰æ–¹å­—ä½“" class="headerlink" title="ç¬¬ä¸‰æ–¹å­—ä½“"></a>ç¬¬ä¸‰æ–¹å­—ä½“</h1><ol><li>å¿…é¡»è€ƒè™‘çš„é—®é¢˜</li></ol><p>é‡åˆ°éœ€è¦ä½¿ç”¨ç¬¬ä¸‰å­—ä½“çš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘ä¸¤æ–¹é¢é—®é¢˜ï¼š</p><ul><li><p>å¯¼å…¥å­—ä½“åº“ä¼šå¢å¤§appå ç”¨ç©ºé—´ï¼ˆè‹±æ–‡å­—ä½“ä¸€èˆ¬ä¸ºå‡ ååˆ°å‡ ç™¾Kï¼Œä¸­æ–‡å­—ä½“åŒ…å¤§å°å¯èƒ½è¾¾åˆ°åå‡ å…†ï¼‰ï¼›</p></li><li><p>ç¬¬ä¸‰æ–¹å­—ä½“å•†ç”¨å¯èƒ½æ¶‰åŠå•†ç”¨ç‰ˆæƒé—®é¢˜ï¼ˆéœ€è´­ä¹°å•†ç”¨ç‰ˆæƒï¼‰ã€‚</p></li></ul><ol start="2"><li>å¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨</li></ol><ul><li><p>å…ˆç¡®è®¤å•†ç”¨ç‰ˆæƒé—®é¢˜</p></li><li><p>å†ä¸‹è½½å­—ä½“åŒ…</p></li><li><p>é€‰æ‹©å¯¹åº”çš„TARGET</p></li><li><p>é€‰æ‹©Build Phases</p></li><li><p>é€‰æ‹©Compile Sources( xxx items ),ç‚¹å‡»åŠ å·æ·»åŠ å­—ä½“åº“æ–‡ä»¶</p></li><li><p>åœ¨info.plistä¸­æ·»åŠ key:â€Founts provided by applicationâ€ï¼Œåœ¨Valueä¸­è¾“å…¥å¯¹åº”ç¬¬ä¸‰æ–¹å­—ä½“åç§°</p></li><li><p>åœ¨éœ€è¦ç”¨åˆ°è¯¥ç¬¬ä¸‰æ–¹å­—ä½“å¤„ç”¨<code>[UIFont fontWithName:fontName size:fontSize];</code>å¼•ç”¨å¯¹åº”å­—ä½“</p></li></ul><h1 id="åŠ¨æ€ä¸‹è½½è‹¹æœå®˜æ–¹æä¾›å­—ä½“"><a href="#åŠ¨æ€ä¸‹è½½è‹¹æœå®˜æ–¹æä¾›å­—ä½“" class="headerlink" title="åŠ¨æ€ä¸‹è½½è‹¹æœå®˜æ–¹æä¾›å­—ä½“"></a>åŠ¨æ€ä¸‹è½½è‹¹æœå®˜æ–¹æä¾›å­—ä½“</h1><p>ä»iOS6å¼€å§‹ï¼Œé™¤äº†iOSç³»ç»Ÿæä¾›çš„å­—ä½“å¤–ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®éœ€è¦å®‰è£…é™„åŠ å­—ä½“åˆ—è¡¨ï¼Œå¯ä¾›å¼€å‘è€…åŠ¨æ€ä¸‹è½½ä½¿ç”¨ï¼Œè¿™äº›å­—ä½“åªé€‚ç”¨äºå®ç°ä¸‹è½½æ”¯æŒçš„åº”ç”¨ç¨‹åºï¼Œå­—ä½“ä»¥è¿™ç§æ–¹å¼ä¸‹è½½çš„åº”ç”¨ç¨‹åºæ²¡æœ‰æ°¸ä¹…å®‰è£…ï¼Œç³»ç»Ÿå¯èƒ½å†³å®šåœ¨æŸäº›ä½¿ç”¨åœºæ™¯ä¸‹åˆ é™¤å®ƒä»¬ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨Macçš„Font Bookåº”ç”¨ä¸­æ¥æŸ¥çœ‹è¿™äº›é™„åŠ å­—ä½“çš„åç§°ï¼Œä¸‹è½½æ—¶éœ€è¦ç”¨åˆ°å…¶PostScriptåç§°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="http://upload-images.jianshu.io/upload_images/2251123-4414f1c244b0e2bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="è·å–å­—ä½“PostScriptåç§°"></p><p>è‹¹æœå®˜æ–¹ç›¸å…³è¯´æ˜</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DESCRIPTION:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Demonstrates how to download fonts on demand on iOS 6 and later.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">On iOS 6, we have added the capability for applications to download fonts on demand. Besides the </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fonts installed with iOS 6, applications can install a list of additional fonts as necessary. This </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">list of additional fonts can be found in the following article:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">iOS 6: Font list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http://support.apple.com/kb/HT5484</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">These fonts will only be accessible to applications that implement the download support. Fonts </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">downloaded from applications in this manner are not installed permanently. The system may decide to </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">remove them under certain usage scenarios.</span><br></pre></td></tr></table></figure><p><a href="https://developer.apple.com/library/content/samplecode/DownloadFont/Introduction/Intro.html#//apple_ref/doc/uid/DTS40013404-Intro-DontLinkElementID_2" target="_blank" rel="noopener">å®˜æ–¹Demoä¸‹è½½åœ°å€</a></p><p>æ ¹æ®å®˜æ–¹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ¨æ€ä¸‹è½½å¹¶åœ¨appä¸­ä½¿ç”¨è¿™äº›é™„åŠ å­—ä½“äº†ã€‚</p><p>å¦‚æœä¸æ„¿æ„çœ‹å®˜æ–¹æ–‡æ¡£å’ŒDemoï¼Œç°å°†ä¸»è¦ä»£ç æ€»ç»“å¦‚ä¸‹ï¼š</p><h2 id="å¼‚æ­¥ä¸‹è½½é™„åŠ å­—ä½“ï¼š"><a href="#å¼‚æ­¥ä¸‹è½½é™„åŠ å­—ä½“ï¼š" class="headerlink" title="å¼‚æ­¥ä¸‹è½½é™„åŠ å­—ä½“ï¼š"></a>å¼‚æ­¥ä¸‹è½½é™„åŠ å­—ä½“ï¼š</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)asynchronouslySetFontName:(NSString *)fontName</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"> UIFont* aFont = [UIFont fontWithName:fontName size:12.];</span><br><span class="line"></span><br><span class="line">     // åˆ¤æ–­è¯¥å­—ä½“æ˜¯å¦å·²ç»ä¸‹è½½</span><br><span class="line"></span><br><span class="line">  if (aFont &amp;&amp; ([aFont.fontName compare:fontName] == NSOrderedSame || [aFont.familyName compare:fontName] == NSOrderedSame)) &#123;</span><br><span class="line"></span><br><span class="line">          // ç›´æ¥ä½¿ç”¨</span><br><span class="line"></span><br><span class="line">   NSUInteger sampleIndex = [_fontNames indexOfObject:fontName];</span><br><span class="line"></span><br><span class="line">    _fTextView.text = [_fontSamples objectAtIndex:sampleIndex];</span><br><span class="line"></span><br><span class="line"> _fTextView.font = [UIFont fontWithName:fontName size:24.];</span><br><span class="line"></span><br><span class="line">  return;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">      // æ„é€ å­—ä½“PostScriptåç§°çš„å­—å…¸ã€‚</span><br><span class="line"></span><br><span class="line">   NSMutableDictionary *attrs = [NSMutableDictionary dictionaryWithObjectsAndKeys:fontName, kCTFontNameAttribute, nil];</span><br><span class="line"></span><br><span class="line">       </span><br><span class="line"></span><br><span class="line">       // ä»å±æ€§å­—å…¸åˆ›å»ºæ–°çš„å­—ä½“æè¿°ç¬¦å¼•ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">    CTFontDescriptorRef desc = CTFontDescriptorCreateWithAttributes((__bridge CFDictionaryRef)attrs);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    NSMutableArray *descs = [NSMutableArray arrayWithCapacity:0];</span><br><span class="line"></span><br><span class="line">    [descs addObject:(__bridge id)desc];</span><br><span class="line"></span><br><span class="line">    CFRelease(desc);</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"> __block BOOL errorDuringDownload = NO;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  // å¼€å§‹å¤„ç†å­—ä½“æè¿°ç¬¦â€¦â€¦</span><br><span class="line"></span><br><span class="line">     CTFontDescriptorMatchFontDescriptorsWithProgressHandler( (__bridge CFArrayRef)descs, NULL,  ^(CTFontDescriptorMatchingState state, CFDictionaryRef progressParameter) &#123;</span><br><span class="line"></span><br><span class="line">         </span><br><span class="line"></span><br><span class="line">  //NSLog( @&quot;state %d - %@&quot;, state, progressParameter);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  double progressValue = [[(__bridge NSDictionary *)progressParameter objectForKey:(id)kCTFontDescriptorMatchingPercentage] doubleValue];</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">   if (state == kCTFontDescriptorMatchingDidBegin) &#123;</span><br><span class="line"></span><br><span class="line">    dispatch_async( dispatch_get_main_queue(), ^ &#123;</span><br><span class="line"></span><br><span class="line">                // Show an activity indicator</span><br><span class="line"></span><br><span class="line"> [_fActivityIndicatorView startAnimating];</span><br><span class="line"></span><br><span class="line">  _fActivityIndicatorView.hidden = NO;</span><br><span class="line"></span><br><span class="line">                  </span><br><span class="line"></span><br><span class="line">                  // Show something in the text view to indicate that we are downloading</span><br><span class="line"></span><br><span class="line">                  _fTextView.text= [NSString stringWithFormat:@&quot;Downloading %@&quot;, fontName];</span><br><span class="line"></span><br><span class="line">   _fTextView.font = [UIFont systemFontOfSize:14.];</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;Begin Matching&quot;);</span><br><span class="line"></span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line"> &#125; else if (state == kCTFontDescriptorMatchingDidFinish) &#123;</span><br><span class="line"></span><br><span class="line">  dispatch_async( dispatch_get_main_queue(), ^ &#123;</span><br><span class="line"></span><br><span class="line">                  // Remove the activity indicator</span><br><span class="line"></span><br><span class="line">   [_fActivityIndicatorView stopAnimating];</span><br><span class="line"></span><br><span class="line">    _fActivityIndicatorView.hidden = YES;</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">                // æ˜¾ç¤ºæ–°ä¸‹è½½å­—ä½“çš„ç¤ºä¾‹æ–‡æœ¬</span><br><span class="line"></span><br><span class="line"> NSUInteger sampleIndex = [_fontNames indexOfObject:fontName];</span><br><span class="line"></span><br><span class="line">  _fTextView.text = [_fontSamples objectAtIndex:sampleIndex];</span><br><span class="line"></span><br><span class="line">   _fTextView.font = [UIFont fontWithName:fontName size:24.];</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">                   // Log the font URL in the console</span><br><span class="line"></span><br><span class="line">    CTFontRef fontRef = CTFontCreateWithName((__bridge CFStringRef)fontName, 0., NULL);</span><br><span class="line"></span><br><span class="line">                CFStringRef fontURL = CTFontCopyAttribute(fontRef, kCTFontURLAttribute);</span><br><span class="line"></span><br><span class="line"> NSLog(@&quot;%@&quot;, (__bridge NSURL*)(fontURL));</span><br><span class="line"></span><br><span class="line">                 CFRelease(fontURL);</span><br><span class="line"></span><br><span class="line">  CFRelease(fontRef);</span><br><span class="line"></span><br><span class="line">                  </span><br><span class="line"></span><br><span class="line">   if (!errorDuringDownload) &#123;</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;%@ downloaded&quot;, fontName);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">   &#125; else if (state == kCTFontDescriptorMatchingWillBeginDownloading) &#123;</span><br><span class="line"></span><br><span class="line">    dispatch_async( dispatch_get_main_queue(), ^ &#123;</span><br><span class="line"></span><br><span class="line">                // æ˜¾ç¤ºè¿›åº¦æ¡</span><br><span class="line"></span><br><span class="line"> _fProgressView.progress = 0.0;</span><br><span class="line"></span><br><span class="line">  _fProgressView.hidden = NO;</span><br><span class="line"></span><br><span class="line">   NSLog(@&quot;Begin Downloading&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"> &#125; else if (state == kCTFontDescriptorMatchingDidFinishDownloading) &#123;</span><br><span class="line"></span><br><span class="line">  dispatch_async( dispatch_get_main_queue(), ^ &#123;</span><br><span class="line"></span><br><span class="line">                  // Remove the progress bar</span><br><span class="line"></span><br><span class="line">   _fProgressView.hidden = YES;</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;Finish downloading&quot;);</span><br><span class="line"></span><br><span class="line"> &#125;);</span><br><span class="line"></span><br><span class="line">   &#125; else if (state == kCTFontDescriptorMatchingDownloading) &#123;</span><br><span class="line"></span><br><span class="line">    dispatch_async( dispatch_get_main_queue(), ^ &#123;</span><br><span class="line"></span><br><span class="line">                // ç”¨è¿›åº¦æ¡æ˜¾ç¤ºä¸‹è½½è¿›åº¦</span><br><span class="line"></span><br><span class="line"> [_fProgressView setProgress:progressValue / 100.0 animated:YES];</span><br><span class="line"></span><br><span class="line">  NSLog(@&quot;Downloading %.0f%% complete&quot;, progressValue);</span><br><span class="line"></span><br><span class="line">   &#125;);</span><br><span class="line"></span><br><span class="line"> &#125; else if (state == kCTFontDescriptorMatchingDidFailWithError) &#123;</span><br><span class="line"></span><br><span class="line">             // An error has occurred.</span><br><span class="line"></span><br><span class="line">             // è·å–é”™è¯¯ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">             NSError *error = [(__bridge NSDictionary *)progressParameter objectForKey:(id)kCTFontDescriptorMatchingError];</span><br><span class="line"></span><br><span class="line">             if (error != nil) &#123;</span><br><span class="line"></span><br><span class="line">                 _errorMessage = [error description];</span><br><span class="line"></span><br><span class="line">             &#125; else &#123;</span><br><span class="line"></span><br><span class="line">                 _errorMessage = @&quot;ERROR MESSAGE IS NOT AVAILABLE!&quot;;</span><br><span class="line"></span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">             // Set our flag</span><br><span class="line"></span><br><span class="line">             errorDuringDownload = YES;</span><br><span class="line"></span><br><span class="line">             </span><br><span class="line"></span><br><span class="line">             dispatch_async( dispatch_get_main_queue(), ^ &#123;</span><br><span class="line"></span><br><span class="line">                 _fProgressView.hidden = YES;</span><br><span class="line"></span><br><span class="line">  NSLog(@&quot;Download error: %@&quot;, _errorMessage&quot;;   &#125;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">           </span><br><span class="line"></span><br><span class="line">    return (bool)YES;</span><br><span class="line"></span><br><span class="line"> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ç³»ç»Ÿæä¾›çš„é™„åŠ å­—ä½“ï¼Œæ—¢å¯ä»¥é¿å…å•†ç”¨ç‰ˆæƒé—®é¢˜ï¼Œåˆå¯ä»¥å‡å°åº”ç”¨çš„ä½“ç§¯ï¼Œé€‚ç”¨äºå¤šå­—ä½“æ ·å¼æœ‰è¦æ±‚çš„åº”ç”¨ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>åœ¨iOSå¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°ä¸€äº›å¥‡æ€ªçš„UIè®¾è®¡ï¼Œå…¶ä¸­ç”¨åˆ°å¥½å‡ ç§éç³»ç»Ÿåº“ä¸­å­˜åœ¨å­—ä½“ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦æ…é‡è€ƒè™‘æ˜¯å¦è¦æ— æ¡ä»¶å¼•å…¥ç¬¬ä¸‰æ–¹å­—ä½“åŒ…ï¼Œå…¶ç‰ˆæƒé—®é¢˜å’Œå ç”¨ç©ºé—´é—®é¢˜éƒ½æ˜¯ååˆ†ä¸¥é‡çš„ï¼Œéœ€è¦è¿›ä¸€æ­¥æ²Ÿé€šå¹¶ç¡®å®šä¸å­˜åœ¨ä¸Šè¿°ä¸¤æ–¹é¢é—®é¢˜æ—¶å†è¿›è¡Œç›¸å…³å¼€å‘ï¼Œå¦åˆ™ä½œä¸ºå¼€å‘è€…çš„æˆ‘ä»¬æ¥è¯´ä¼šå¾ˆè¢«åŠ¨ã€‚æœ€åï¼Œæé†’å¤§å®¶å°½é‡ä¸è¦ä½¿ç”¨å¤ªå¤šç¬¬ä¸‰æ–¹å­—ä½“ï¼Œç³»ç»Ÿæä¾›çš„å­—ä½“æ˜¯ç”¨æˆ·ç†Ÿæ‚‰äº†çš„ï¼Œappçš„å­—ä½“å¤ªå¤šåè€Œå¯èƒ½é€ æˆç”¨æˆ·ä½“éªŒä¸å¥½ï¼Œæ…ä¹‹ï¼Œæ…ä¹‹ï¼ï¼ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily-fontï¼‰&quot;&gt;&lt;a href=&quot;#iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily-fontï¼‰&quot; class=&quot;headerlink&quot; title=&quot;iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily fontï¼‰&quot;&gt;&lt;/a&gt;iOSç³»ç»Ÿå®¶æ—å­—ä½“ï¼ˆfamily fon
      
    
    </summary>
    
      <category term="iOS" scheme="https://fusugz.github.io/categories/iOS/"/>
    
    
      <category term="Objective-C" scheme="https://fusugz.github.io/tags/Objective-C/"/>
    
      <category term="font" scheme="https://fusugz.github.io/tags/font/"/>
    
      <category term="System" scheme="https://fusugz.github.io/tags/System/"/>
    
  </entry>
  
  <entry>
    <title>Objective-c_3_features</title>
    <link href="https://fusugz.github.io/2017/08/10/Objective-c-3-features/"/>
    <id>https://fusugz.github.io/2017/08/10/Objective-c-3-features/</id>
    <published>2017-08-10T04:19:58.000Z</published>
    <updated>2017-08-11T09:11:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»æœ‰ä¸‰å¤§ç‰¹æ€§ï¼šç»§æ‰¿ï¼Œå°è£…ï¼Œå¤šæ€ï¼Œè¿™ä¸‰å¤§ç‰¹æ€§æ˜¯å­¦ä¹ ç±»çš„æ—¶å€™ï¼Œå¿…é¡»ç†è§£çš„é—®é¢˜ï¼Œæ—¢æ˜¯åŸºç¡€ï¼Œæ›´è¯¥ç»™äºˆé‡è§†ã€‚</p><h1 id="ä¸€ã€å°è£…ï¼ˆEncapsulationï¼‰"><a href="#ä¸€ã€å°è£…ï¼ˆEncapsulationï¼‰" class="headerlink" title="ä¸€ã€å°è£…ï¼ˆEncapsulationï¼‰"></a>ä¸€ã€å°è£…ï¼ˆEncapsulationï¼‰</h1><p>å°è£…å°±æ˜¯å¯¹ç±»ä¸­çš„ä¸€äº›å­—æ®µã€æ–¹æ³•è¿›è¡Œä¿æŠ¤ï¼Œä¸è¢«å¤–ç•Œè®¿é—®åˆ°ï¼Œæœ‰ä¸€ç§æƒé™çš„æ§åˆ¶èƒ½åŠ›ï¼ŒJavaä¸­æœ‰å››ç§è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼špublicã€defaultã€protectedã€privateï¼Œå®ƒä»¬çš„è®¿é—®æƒé™ä¾æ¬¡é€’å‡ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å®šä¹‰ç±»çš„æ—¶å€™ï¼Œå“ªäº›å­—æ®µå’Œæ–¹æ³•ä¸æƒ³æš´éœ²å‡ºå»ï¼Œå“ªäº›å­—æ®µå’Œæ–¹æ³•å¯ä»¥æš´éœ²ï¼Œå¯ä»¥é€šè¿‡ä¸åŒä¿®é¥°ç¬¦æ¥åŒºåˆ†ï¼Œè¿™å°±æ˜¯å°è£…ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface Car : NSObject &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// è¿™ä¸ªå±æ€§å°±æ˜¯å¯¹å¤–è¿›è¡Œä¿å¯†çš„ç›¸å½“äºprivateï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å¤–éƒ¨è®¿é—®çš„è¯ï¼Œå¿…é¡»å®šä¹‰get/setæ–¹æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// é»˜è®¤çš„æ˜¯privateçš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨@publicè®¾ç½®ä¸ºpublicå±æ€§çš„,é‚£ä¹ˆåœ¨å¤–éƒ¨å¯ä»¥ç›´æ¥è®¿é—®ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">person-&gt;capcity = 2.8;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å½“ç„¶æˆ‘ä»¬ä¸€èˆ¬ä¸è¿™ä¹ˆä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¼šç ´åå°è£…æ€§ï¼Œè¿™ç§ç”¨æ³•ç›¸å½“äºCä¸­çš„ç»“æ„ä½“ä¸­æƒé™</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// ä¸€å…±å››ç§ï¼š@public,@protected,@private,@package,æƒé™ä¾æ¬¡é€’å‡ï¼Œè¿™ä¸ªå’ŒJavaä¸­æ˜¯ç›¸åŒçš„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@public</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">float _capcity; //æ²¹é‡å±æ€§</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)run;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒOCä¸­ä¹Ÿæœ‰å››ç§æƒé™ä¿®é¥°ç¬¦ï¼š@publicã€@protectedã€@privateã€@package</p><p>å…¶ä¸­é»˜è®¤çš„ä¿®é¥°ç¬¦æ˜¯@privateã€‚</p><p>ä½†æ˜¯è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒOCä¸­çš„æ–¹æ³•æ˜¯æ²¡æœ‰ä¿®é¥°ç¬¦çš„æ¦‚å¿µçš„ï¼Œè¿™ä¸å…¶å®ƒè¯­è¨€æœ‰æ‰€åŒºåˆ«ï¼Œä¸€èˆ¬éƒ½æ˜¯å…¬å¼€è®¿é—®çš„ï¼Œå³publicçš„ã€‚åœ¨OCä¸­ï¼Œè‹¥éœ€è¦åšåˆ°è®©ä¸€ä¸ªæ–¹æ³•ä¸èƒ½è¢«å¤–ç•Œè®¿é—®ï¼Œåªéœ€è¦åœ¨.mæ–‡ä»¶ä¸­å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œä¸è¦åœ¨å›¾æ–‡ä»¶ä¸­è¿›è¡Œå®šä¹‰ï¼Œç®€è¨€ä¹‹ï¼Œå°±æ˜¯è¯¥æ–¹æ³•æœ‰å®ç°è€Œæ²¡æœ‰å®šä¹‰ï¼Œè¿™æ ·å¤–ç•Œåœ¨å€’å…¥å¤´æ–‡ä»¶çš„æ—¶å€™ï¼Œæ˜¯æ²¡æœ‰è¿™ä¸ªæ–¹æ³•çš„ï¼Œè¿™ä¸ªæ–¹æ³•åªå¯ä»¥åœ¨è‡ªå·±çš„.mæ–‡ä»¶ä¸­ä½¿ç”¨ã€‚</p><h1 id="äºŒã€ç»§æ‰¿"><a href="#äºŒã€ç»§æ‰¿" class="headerlink" title="äºŒã€ç»§æ‰¿"></a>äºŒã€ç»§æ‰¿</h1><p>ç»§æ‰¿æ˜¯ç±»ä¸­çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå…¶ä½œç”¨åœ¨äºé¿å…å†™é‡å¤çš„ä»£ç ï¼Œå¯é‡ç”¨æ€§å¾ˆé«˜ï¼Œç»§æ‰¿çš„ç›®çš„æ˜¯ä¸ºäº†å‡å°‘ä»£ç çš„å†—ä½™ï¼Œè¿˜æ˜¯DRYåŸåˆ™ï¼ˆdon`t repeat yourself)ã€‚</p><p>åœ¨Car.hä¸­ï¼Œåœ¨Carç±»ä¸­å®šä¹‰äº†ä¸¤ä¸ªå±æ€§ï¼Œä»¥åŠä¸€äº›æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface Car : NSObject&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString *_brand;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString *_color;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)setBrand:(NSString *)brand;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)setColor:(NSString *)color;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)brake;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)quicken;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>åœ¨Car.mæ–¹æ³•ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation Car</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)setBrand:(NSString *)brand&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_brand = brand;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)setColor:(NSString *)color&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">_color = color;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)brake&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;åˆ¹è½¦&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)quicken&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;åŠ é€Ÿ&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><h2 id="åœ¨å…¶å­ç±»Taxiä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Carçš„æ–¹æ³•è¿›è¡Œç»§æ‰¿ã€‚"><a href="#åœ¨å…¶å­ç±»Taxiä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Carçš„æ–¹æ³•è¿›è¡Œç»§æ‰¿ã€‚" class="headerlink" title="åœ¨å…¶å­ç±»Taxiä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Carçš„æ–¹æ³•è¿›è¡Œç»§æ‰¿ã€‚"></a>åœ¨å…¶å­ç±»Taxiä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Carçš„æ–¹æ³•è¿›è¡Œç»§æ‰¿ã€‚</h2><p>Taxi.hæ–‡ä»¶ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface Taxi : Car&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSString *_company;//æ‰€å±å…¬å¸</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//æ‰“å°å‘ç¥¨</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)printTick;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>Taxiç±»ç»§æ‰¿äº†çˆ¶ç±»Car,è¿™é‡Œéœ€è¦å¯¼å…¥çˆ¶ç±»çš„å¤´æ–‡ä»¶ï¼Œç„¶ååœ¨Taxiç±»ä¸­å¤šäº†ä¸€ä¸ªå±æ€§å’Œæ–¹æ³•ï¼Œä¸çˆ¶ç±»ä¸€è‡´çš„æ–¹æ³•åˆ™ç»§æ‰¿æˆ–æ”¹å†™ã€‚</p><p>Taxi.mæ–‡ä»¶ä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Taxi.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation Taxi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)printTick&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[super brake];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[self brake];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%@å‡ºç§Ÿè½¦æ‰“å°äº†å‘ç¥¨ï¼Œå…¬å¸ä¸º:%@,é¢œè‰²ä¸º:%@&quot;,_brand,_company,_color);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>å¯¹æ–¹æ³•çš„å®ç°ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹åˆ°å®ç°æ–‡ä»¶ä¸­æ˜¯ä¸éœ€è¦å¯¼å…¥çˆ¶ç±»Carçš„å¤´æ–‡ä»¶çš„ï¼Œå› ä¸ºå¯ä»¥è®¤ä¸ºï¼ŒTaxi.hå¤´æ–‡ä»¶ä¸­å·²ç»åŒ…å«äº†Carçš„å¤´æ–‡ä»¶äº†ã€‚è€Œä¸”ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨superå…³é”®å­—æ¥è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼ŒåŒæ—¶è¿™é‡Œæˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥ç”¨selfå…³é”®å­—æ¥è°ƒç”¨ï¼Œè¿™é‡Œçœ‹åˆ°å…¶å®è¿™ä¸¤ç§æ–¹å¼è°ƒç”¨çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå½“æˆ‘ä»¬åœ¨å­ç±»é‡æ–°å®ç°brakeæ–¹æ³•çš„æ—¶å€™(Javaä¸­çš„é‡å†™æ¦‚å¿µ)ï¼Œé‚£ä¹ˆè¿™æ—¶å€™superå…³é”®å­—è°ƒç”¨çš„è¿˜æ˜¯çˆ¶ç±»çš„æ–¹æ³•ï¼Œè€Œselfè°ƒç”¨çš„å°±æ˜¯é‡å†™ä¹‹åçš„brakeæ–¹æ³•äº†ã€‚åŒæ ·ï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çˆ¶ç±»ä¸­çš„å±æ€§ã€‚</p><h2 id="å†çœ‹ä¸€ä¸‹å¦å¤–ä¸€ä¸ªå­ç±»Truck"><a href="#å†çœ‹ä¸€ä¸‹å¦å¤–ä¸€ä¸ªå­ç±»Truck" class="headerlink" title="å†çœ‹ä¸€ä¸‹å¦å¤–ä¸€ä¸ªå­ç±»Truck:"></a>å†çœ‹ä¸€ä¸‹å¦å¤–ä¸€ä¸ªå­ç±»Truck:</h2><p>åœ¨Truck.hä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Car.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//å¡è½¦ç±»ç»§æ‰¿Car</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface Truck : Car&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">float _maxWeight;//æœ€å¤§è½½è´§é‡</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//è¦†ç›–çˆ¶ç±»çš„æ–¹æ³•brake</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//ä¼˜å…ˆè°ƒç”¨å­ç±»çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)brake;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)unload;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±è‡ªå·±å®šä¹‰äº†ä¸€ä¸ªbrakeæ–¹æ³•ï¼Œè¿™æ—¶å€™å°±ä¼šè¦†ç›–çˆ¶ç±»ä¸­çš„brakeæ–¹æ³•äº†ã€‚</p><p>åœ¨Truck.mä¸­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Truck.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation Truck</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)brake&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[super brake];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;Truckç±»ä¸­çš„brakeæ–¹æ³•&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)unload&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[super brake];//è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[self brake];//ä¹Ÿæ˜¯å¯ä»¥çš„</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;%@çš„å¡è½¦å¸è´§äº†ï¼Œè½½è´§é‡:%.2f,æ±½è½¦çš„é¢œè‰²:%@&quot;,_brand,_maxWeight,_color);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¼šåœ¨brakeæ–¹æ³•ä¸­è°ƒç”¨ä¸€ä¸‹çˆ¶ç±»çš„brakeæ–¹æ³•ï¼Œç„¶ååœ¨å®ç°æˆ‘ä»¬è‡ªå·±çš„é€»è¾‘ä»£ç ã€‚</p><h1 id="ä¸‰ã€å¤šæ€"><a href="#ä¸‰ã€å¤šæ€" class="headerlink" title="ä¸‰ã€å¤šæ€"></a>ä¸‰ã€å¤šæ€</h1><p>å¤šæ€å¯¹äºé¢å‘å¯¹è±¡æ¥è¯´ï¼Œä¸ªäººæ„Ÿè§‰çœŸçš„å¾ˆé‡è¦ï¼Œå…¶å¯¹äºç¼–å†™ä»£ç çš„ä¼˜é›…æ–¹å¼ä¹Ÿèµ·åˆ°äº†å¾ˆé‡è¦çš„ä½œç”¨ã€‚åœ¨å¾ˆå¤šè®¾è®¡æ¨¡å¼ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨åˆ°äº†å¤šæ€çš„ç‰¹æ€§ï¼ŒJavaä¸­çš„å¤šæ€ç‰¹æ€§ç”¨èµ·æ¥å¾ˆæ˜¯æ–¹ä¾¿çš„ï¼Œä½†æ˜¯C++ä¸­å°±å¾ˆéš¾ç”¨äº†ï¼Œå…¶å®å¤šæ€è¯´ç™½äº†å°±æ˜¯ï¼šå®šä¹‰ç±»å‹å’Œå®é™…ç±»å‹ï¼Œä¸€èˆ¬æ˜¯åŸºäºæ¥å£çš„å½¢å¼å®ç°çš„ã€‚</p><p>ä»¥æ‰“å°æœºä¸ºä¾‹ï¼š</p><p>å†™ä¸€ä¸ªæŠ½è±¡çš„æ‰“å°æœºç±»Printerï¼Œ</p><p>Printer.h:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface Printer : NSObject</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) print;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>Printer.m:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Printer.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation Printer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)print&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;æ‰“å°æœºæ‰“å°çº¸å¼ &quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>å®ç°ä¹Ÿæ˜¯å¾ˆç®€å•çš„,ä¸‹é¢æ¥çœ‹ä¸€ä¸‹å…·ä½“çš„å­ç±»ColorPrinter:</p><p>ColorPrinter.h:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Printer.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//ä¿®æ”¹çˆ¶ç±»çš„æ‰“å°è¡Œä¸º</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface ColorPrinter : Printer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)print;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ColorPrinter.m</span><br></pre></td></tr></table></figure><p>ColorPrinter.m:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;ColorPrinter.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation ColorPrinter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)print&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;å½©è‰²æ‰“å°æœº&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>å†çœ‹ä¸€ä¸‹å¦ä¸€ä¸ªå­ç±»ï¼š</p><p>BlackPrinter.m:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;BlackPrinter.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation BlackPrinter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)print&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">NSLog(@&quot;é»‘ç™½æ‰“å°æœº&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬åœ¨å®šä¹‰ä¸€ä¸ªPersonç±»ï¼Œç”¨æ¥æ“ä½œå…·ä½“çš„æ‰“å°æœºã€‚</p><p>Person.m:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Person.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation Person</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) printWithColor:(ColorPrinter *)colorPrint&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[colorPrint print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) printWithBlack:(BlackPrinter *)blackPrint&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[blackPrint print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) doPrint:(Printer *)printer&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[printer print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>å†æ¥çœ‹ä¸€ä¸‹æµ‹è¯•ä»£ç ï¼š</p><p>Person.h:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Person.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation Person</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) printWithColor:(ColorPrinter *)colorPrint&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[colorPrint print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) printWithBlack:(BlackPrinter *)blackPrint&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[blackPrint print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) doPrint:(Printer *)printer&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[printer print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure><p>Person.m:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;Person.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;BlackPrinter.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#import &quot;ColorPrinter.h&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main(int argc, const charchar * argv[]) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@autoreleasepool &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Person *person =[[Person alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ColorPrinter *colorPrint = [[ColorPrinter alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BlackPrinter *blackPrint = [[BlackPrinter alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//å¤šæ€çš„å®šä¹‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Printer *p1 = [[ColorPrinter alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Printer *p2 = [[BlackPrinter alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person doPrint:p1];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person doPrint:p2];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//é€šè¿‡æ§åˆ¶å°è¾“å…¥çš„å‘½ä»¤æ¥æ§åˆ¶ä½¿ç”¨å“ªä¸ªæ‰“å°æœº</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int cmd;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">do&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scanf(&quot;%d&quot;,&amp;cmd);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if(cmd == 1)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person doPrint:colorPrint];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;else if(cmd == 2)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person doPrint:blackPrint];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;while (1);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å°±æ¥è¯¦ç»†è®¨è®ºä¸€ä¸‹å¤šæ€çš„å¥½å¤„ï¼Œä»¥ä¸Šä¾‹å­ä¸­ä¸€ä¸ªå½©è‰²æ‰“å°æœºå’Œé»‘ç™½æ‰“å°æœºï¼ŒPersonç±»ä¸­æœ‰ä¸€ä¸ªæ“ä½œæ‰“å°çš„æ–¹æ³•ï¼Œå½“ç„¶è¿™ä¸ªæ–¹æ³•æ˜¯éœ€è¦æ‰“å°æœºå¯¹è±¡çš„ï¼Œå¦‚æœä¸ç”¨å¤šæ€æœºåˆ¶å®ç°çš„è¯ï¼ˆPerson.hä¸­æ³¨é‡Šçš„ä»£ç éƒ¨åˆ†ï¼‰ï¼Œå°±æ˜¯ç»™ä¸¤ç§æ‰“å°æœºå•ç‹¬å®šä¹‰ä¸ªæ“ä½œçš„æ–¹æ³•ï¼Œç„¶ååœ¨Person.mï¼ˆä»£ç æ³¨é‡Šçš„éƒ¨åˆ†ï¼‰ä¸­ç”¨å…·ä½“çš„æ‰“å°æœºå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œåœ¨main.mæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼Œå½“personéœ€è¦ä½¿ç”¨å“ªä¸ªæ‰“å°æœºçš„æ—¶å€™ï¼Œå°±å»è°ƒç”¨æŒ‡å®šçš„æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person printWithBlack:blackPrint];//è°ƒç”¨é»‘ç™½æ‰“å°æœº</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person printWithColor:colorPrint];//è°ƒç”¨å½©è‰²æ‰“å°æœº</span><br></pre></td></tr></table></figure><p>å‡å¦‚ç°åœ¨åˆéœ€è¦å¦ä¸€ç§æ‰“å°æœº ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦åœ¨Person.hä¸­å®šä¹‰ä¸€ç§æ“ä½œè¿™ç§æ‰“å°æœºçš„æ–¹æ³•ï¼Œé‚£ä¹ˆåç»­å¦‚æœæ·»åŠ æ–°çš„æ‰“å°æœºå‘¢ï¼Ÿè¿˜è¦ç»§ç»­æ·»åŠ æ–¹æ³•å—ï¼Ÿé‚£ä¹ˆPerson.hæ–‡ä»¶å°±ä¼šå˜å¾—è‡ƒè‚¿ã€‚æ‰€ä»¥æ­¤æ—¶å¤šæ€å°±ä½“ç°äº†ä¼˜åŠ¿ï¼Œä½¿ç”¨çˆ¶ç±»ç±»å‹ï¼Œåœ¨Person.hä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•<code>- (void) doPrint:(Printer *)printer;</code>å°±å¯ä»¥äº†ã€‚è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªæ–¹æ³•çš„å‚æ•°ç±»å‹å°±æ˜¯çˆ¶ç±»ç±»å‹ï¼Œå®é™…ç±»å‹ä¸ºå­ç±»ç±»å‹,å…¶æ–¹æ³•ä½“ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void) doPrint:(Printer *)printer&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[printer print];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè°ƒç”¨printæ–¹æ³•ï¼Œå°±æ˜¯ä¼ é€’è¿›æ¥çš„å®é™…ç±»å‹çš„printæ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Printer *p1 = [[ColorPrinter alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Printer *p2 = [[BlackPrinter alloc] init];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person doPrint:p1];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[person doPrint:p2];</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„p1ï¼Œp2è¡¨é¢ä¸Šçš„ç±»å‹æ˜¯printerï¼Œä½†å®é™…ç±»å‹æ˜¯å­ç±»ç±»å‹ï¼Œæ‰€ä»¥è°ƒç”¨ä»–ä»¬è‡ªå·±å¯¹åº”çš„printæ–¹æ³•ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­çš„ç±»æœ‰ä¸‰å¤§ç‰¹æ€§ï¼šç»§æ‰¿ï¼Œå°è£…ï¼Œå¤šæ€ï¼Œè¿™ä¸‰å¤§ç‰¹æ€§æ˜¯å­¦ä¹ ç±»çš„æ—¶å€™ï¼Œå¿…é¡»ç†è§£çš„é—®é¢˜ï¼Œæ—¢æ˜¯åŸºç¡€ï¼Œæ›´è¯¥ç»™äºˆé‡è§†ã€‚&lt;/p&gt;
&lt;h1 id=&quot;ä¸€ã€å°è£…ï¼ˆEncapsulationï¼‰&quot;&gt;&lt;a href=&quot;#ä¸€ã€å°è£…ï¼ˆEncapsulationï¼‰&quot; class=&quot;
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>iOSæ•°æ®æŒä¹…åŒ–ä¹‹FMDBçš„ç®€å•å°è£…</title>
    <link href="https://fusugz.github.io/2017/07/03/fmdb-encapsulate/"/>
    <id>https://fusugz.github.io/2017/07/03/fmdb-encapsulate/</id>
    <published>2017-07-03T03:29:11.000Z</published>
    <updated>2017-07-03T03:43:44.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¼˜ç”±"><a href="#ç¼˜ç”±" class="headerlink" title="ç¼˜ç”±"></a>ç¼˜ç”±</h2><p>FMDBæ˜¯iOSå¹³å°å¤„ç†æ•°æ®æŒä¹…åŒ–çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…é«˜æ•ˆåœ°åœ¨å®¢æˆ·ç«¯å¤„ç†æ•°æ®ï¼Œä½†å¯¹äºæˆ‘ç­‰åˆçº§å¼€å‘è€…æ¥è¯´å…¶ä½¿ç”¨è¿˜æ˜¯ä¸å¤Ÿç®€å•ã€‚å› æ­¤ï¼Œæœ‰å¿…è¦å¯¹å®ƒè¿›è¡Œå°è£…ï¼Œä»è€Œä½¿å…¶æ›´æ˜“äºä½¿ç”¨ï¼Œå°è£…çš„æ–¹å¼å› äººè€Œå¼‚ï¼Œéœ€è¦æˆ‘ä»¬æ ¹æ®è‡ªå·±çš„ä»£ç ä¹ æƒ¯è¿›è¡Œä¼˜åŒ–ã€‚æˆ‘çš„å°è£…ä¹Ÿä»…é™äºæä¾›ä¸€ç§ç®€å•çš„æ€è·¯ï¼Œä»¥ä¾¿åæ¥è€…å‚è€ƒã€‚</p><h2 id="å¦‚ä½•å®ç°"><a href="#å¦‚ä½•å®ç°" class="headerlink" title="å¦‚ä½•å®ç°"></a>å¦‚ä½•å®ç°</h2><p>æˆ‘çš„é¡¹ç›®åä¸º<strong>fmdbEncap</strong>,æ‰˜ç®¡äº<code>Github</code>ã€‚åœ¨æˆ‘çš„ä»£ç ä¸­ï¼Œ ä½¿ç”¨<code>MZDatabaseManager</code>åˆ›å»º<code>SQLite</code>æ•°æ®åº“ï¼›åœ¨  <code>MZSqliteDao</code>ä¸­åˆ›å»ºäº†åŸºäº<code>FMDB</code>çš„ä¸€ç³»åˆ—æ–¹æ³•ç”¨äºæ•°æ®åº“åˆ›å»ºã€å»ºè¡¨ï¼Œä»¥åŠæ•°æ®åº“çš„å¢ã€åˆ ã€æ”¹ã€æŸ¥ã€‚</p><p><strong>æ–‡æœ«ä¼šé™„ä¸ŠGithubé¡¹ç›®åœ°å€</strong></p><h2 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h2><p>å…³äºå¦‚ä½•åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨è¯¥å°è£…ï¼Œä½ åªéœ€åœ¨å¼•å…¥FMDBçš„å‰æä¸‹æ·»åŠ æœ¬é¡¹ç›®ä¸­çš„<code>FMDBEncapsulation</code>æ–‡ä»¶å¤¹å’Œç›¸å…³æ¨¡å‹æ•°æ®å³å¯ã€‚</p><h2 id="ä¸€äº›è¯´æ˜"><a href="#ä¸€äº›è¯´æ˜" class="headerlink" title="ä¸€äº›è¯´æ˜"></a>ä¸€äº›è¯´æ˜</h2><p>ä¸ºäº†ä½¿å®ƒç®€å•å®ç”¨ï¼Œé¡¹ç›®ä¸­åŒ…å«<code>fmdb_task</code>å’Œ<code>fmdb_category</code>ä¸¤ä¸ªè¡¨ç”¨äºä¸¾ä¾‹è¯´æ˜ï¼Œè¡¨ä¸­çš„å‚æ•°ä¹Ÿä¸ä»£ç ä¸­å®ä¾‹ä¸€ä¸€å¯¹åº”ã€‚SQLiteæ•°æ®åº“å»ºç«‹åœ¨<code>Documents</code>è·¯å¾„ä¸‹ï¼Œå¯¹æ•°æ®åº“çš„ä¸€åˆ‡æ“ä½œåŸºäºæ¨¡æ‹Ÿæ•°æ®ã€‚æˆ‘ä¼šå°½é‡æ¶µç›–FMDBåŸºæœ¬ä½¿ç”¨çš„ç›¸å…³ç»†èŠ‚ï¼Œå¹¶å°†æŒç»­æ›´æ–°ä»£ç ã€‚</p><h3 id="SQL-è¯­å¥"><a href="#SQL-è¯­å¥" class="headerlink" title="SQL è¯­å¥"></a>SQL è¯­å¥</h3><p>SQLè¯­å¥ä»¥å®å®šä¹‰çš„å½¢å¼åœ¨é…ç½®æ–‡ä»¶ä¸­å†™å…¥ã€‚</p><ul><li>Table Name</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define     TABLE_TASK                   @&quot;FMDB_TASK&quot;</span><br><span class="line"></span><br><span class="line">#define     TABLE_CATEGORY               @&quot;FMDB_CATEGORY&quot;</span><br></pre></td></tr></table></figure><ul><li>Create tables</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define     SQL_CREATE_TASK              @&quot;CREATE TABLE IF NOT EXISTS FMDB_TASK(\</span><br><span class="line"></span><br><span class="line">                                           TASK_ID integer PRIMARY KEY AUTOINCREMENT NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           ROOM_ID int(11) NOT NULL DEFAULT 0,\</span><br><span class="line"></span><br><span class="line">                                           TASK_INFO int(11),\</span><br><span class="line"></span><br><span class="line">                                           TASK_NUMBER int(4) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           TASK_STATUS int(4) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           TASK_COORDINATE varchar(20),\</span><br><span class="line"></span><br><span class="line">                                           TASK_BEDSIDE varchar(20)\</span><br><span class="line"></span><br><span class="line">                                           );&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_CREATE_CATEGORY          @&quot;CREATE TABLE IF NOT EXISTS FMDB_CATEGORY(\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_ID integer PRIMARY KEY AUTOINCREMENT NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           PARENT_ID int(11) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           LEVEL int(11),\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_NAME nvarchar(45) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_IMG varchar(100),\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_RANK int(11) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_TYPE int(4) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_STATUS int(11) NOT NULL,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_REMARK nvarchar(100)\</span><br><span class="line"></span><br><span class="line">                                           );&quot;</span><br></pre></td></tr></table></figure><ul><li>Insert</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define     SQL_INSERT_TASK              @&quot;INSERT INTO FMDB_TASK\</span><br><span class="line"></span><br><span class="line">                                           ( ROOM_ID, TASK_INFO, TASK_NUMBER,\</span><br><span class="line"></span><br><span class="line">                                           TASK_STATUS, TASK_COORDINATE, TASK_BEDSIDE)\</span><br><span class="line"></span><br><span class="line">                                           VALUES ( &apos;%d&apos;, &apos;%d&apos;, &apos;%d&apos;, &apos;%d&apos;, &apos;%@&apos;, &apos;%@&apos;);&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_INSERT_CATEGORY          @&quot;INSERT INTO FMDB_CATEGORY\</span><br><span class="line"></span><br><span class="line">                                           ( PARENT_ID, LEVEL, CATEGORY_NAME, CATEGORY_IMG,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_RANK, CATEGORY_TYPE, CATEGORY_STATUS, CATEGORY_REMARK)\</span><br><span class="line"></span><br><span class="line">                                           VALUES ( &apos;%d&apos;, &apos;%d&apos;, &apos;%@&apos;, &apos;%d&apos;, &apos;%d&apos;, &apos;%d&apos;, &apos;%d&apos;, &apos;%@&apos;);&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_INSERT_TASK_PARAMTER     @&quot;INSERT INTO FMDB_TASK\</span><br><span class="line"></span><br><span class="line">                                           ( ROOM_ID, TASK_INFO, TASK_NUMBER,\</span><br><span class="line"></span><br><span class="line">                                           TASK_STATUS, TASK_COORDINATE, TASK_BEDSIDE)\</span><br><span class="line"></span><br><span class="line">                                           VALUES (\</span><br><span class="line"></span><br><span class="line">                                           :roomID, :taskInfo, :taskNumber, :taskStatus, :taskCoordinate, :taskBeside);&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_INSERT_CATEGORY_PARAMTER @&quot;INSERT INTO FMDB_CATEGORY\</span><br><span class="line"></span><br><span class="line">                                           ( PARENT_ID, LEVEL, CATEGORY_NAME, CATEGORY_IMG,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_RANK, CATEGORY_TYPE, CATEGORY_STATUS, CATEGORY_REMARK)\</span><br><span class="line"></span><br><span class="line">                                           VALUES (\</span><br><span class="line"></span><br><span class="line">                                           :prantID, :level, :categoryName, :categoryImage, :categoryRank, :categoryType, :categoryStatus, :categoryRemark);&quot;</span><br></pre></td></tr></table></figure><ul><li>Update</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define     SQL_UPDATE_TASK              @&quot;UPDATE FMDB_TASK\</span><br><span class="line"></span><br><span class="line">                                           SET ROOM_ID = &apos;%d&apos;, TASK_INFO = &apos;%d&apos;, TASK_NUMBER = &apos;%d&apos;,\</span><br><span class="line"></span><br><span class="line">                                           TASK_STATUS = &apos;%d&apos;, TASK_COORDINATE = &apos;%@&apos;, TASK_BEDSIDE = &apos;%@&apos;\</span><br><span class="line"></span><br><span class="line">                                           WHERE TASK_ID = &apos;%d&apos;;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_UPDATE_CATEGORY          @&quot;UPDATE FMDB_CATEGORY\</span><br><span class="line"></span><br><span class="line">                                           SET PARENT_ID = &apos;%d&apos;, LEVEL = &apos;%d&apos;, CATEGORY_NAME = &apos;%@&apos;,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_IMG = &apos;%d&apos;,CATEGORY_RANK = &apos;%d&apos;, CATEGORY_TYPE = &apos;%d&apos;,\</span><br><span class="line"></span><br><span class="line">                                           CATEGORY_STATUS = &apos;%d&apos;,CATEGORY_REMARK = &apos;%@&apos;\                                           WHERE CATEGORY_ID = &apos;%d&apos;;&quot;</span><br></pre></td></tr></table></figure><ul><li>Delete</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define     SQL_DELETE                   @&quot;DELETE FROM %@ WHERE &apos;%@&apos;=&apos;%d&apos;;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_DELETE_ALL               @&quot;DELETE FROM %@&quot;</span><br></pre></td></tr></table></figure><ul><li>Select</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#define     SQL_SELECT_ALL               @&quot;SELECT * FROM %@;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#define     SQL_SELECT_PARAMTER          @&quot;SELECT * FROM %@ WHERE %@ = &apos;%d&apos;;&quot;</span><br></pre></td></tr></table></figure><h3 id="ä¸¾ä¾‹è¯´æ˜"><a href="#ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="ä¸¾ä¾‹è¯´æ˜"></a>ä¸¾ä¾‹è¯´æ˜</h3><hr><p>1.Create database</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[[MZDatabaseManager sharedInstance] createDatabaseWithName:@&quot;test&quot;];</span><br></pre></td></tr></table></figure><p>2.Create table</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">self.sqliteDao = [[MZSqliteDao alloc] init];</span><br><span class="line"></span><br><span class="line">// create table</span><br><span class="line"></span><br><span class="line">[self.sqliteDao createTable:TABLE_TASK withSQL:SQL_CREATE_TASK];</span><br><span class="line"></span><br><span class="line">[self.sqliteDao createTable:TABLE_CATEGORY withSQL:SQL_CREATE_CATEGORY];</span><br></pre></td></tr></table></figure><p>3.Insert </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSArray *arrayOfTasks = [MZTask taskMetedata];</span><br><span class="line"></span><br><span class="line">    NSArray *arrayOfCategories = [MZCategory categoryMetedata];</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">      // task: SQL è¯­å¥æ‹¼æ¥</span><br><span class="line"></span><br><span class="line">    for (MZTask *task in arrayOfTasks) &#123;</span><br><span class="line"></span><br><span class="line">        NSString *SQL_InsertTaskData = [NSString stringWithFormat:SQL_INSERT_TASK,[task.roomID intValue],[task.taskInfo  intValue],[task.taskNumber  intValue],[task.taskStatus  intValue],task.taskCoordinate,task.taskBeside];</span><br><span class="line"></span><br><span class="line">        BOOL success = [self.sqliteDao excuteSQL:SQL_InsertTaskData];</span><br><span class="line"></span><br><span class="line">        if (success) &#123;</span><br><span class="line"></span><br><span class="line">            NSLog(@&quot;insert success!&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">      // category: å¸¦å‚</span><br><span class="line"></span><br><span class="line">    for (NSInteger i = 0; i &lt; arrayOfCategories.count; i ++) &#123;</span><br><span class="line"></span><br><span class="line">        MZCategory *category = arrayOfCategories[i];</span><br><span class="line"></span><br><span class="line">        NSDictionary *paramDict = @&#123;@&quot;prantID&quot;:category.parentID,</span><br><span class="line"></span><br><span class="line">                                    @&quot;level&quot;:category.level,</span><br><span class="line"></span><br><span class="line">                                    @&quot;categoryName&quot;:category.categoryName,</span><br><span class="line"></span><br><span class="line">                                    @&quot;categoryImage&quot;:category.categoryImg,</span><br><span class="line"></span><br><span class="line">                                    @&quot;categoryRank&quot;:category.categoryRank,</span><br><span class="line"></span><br><span class="line">                                    @&quot;categoryType&quot;:category.categoryType,</span><br><span class="line"></span><br><span class="line">                                    @&quot;categoryStatus&quot;:category.categoryStatus,</span><br><span class="line"></span><br><span class="line">                                    @&quot;categoryRemark&quot;:category.categoryRemark</span><br><span class="line"></span><br><span class="line">                                    &#125;;</span><br><span class="line"></span><br><span class="line">        BOOL success = [self.sqliteDao excuteSQL:SQL_INSERT_CATEGORY_PARAMTER withDicParameter:paramDict];</span><br><span class="line"></span><br><span class="line">        if (success) &#123;</span><br><span class="line"></span><br><span class="line">            NSLog(@&quot;%@ insert success!&quot;,paramDict);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>4.Update</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSString *SQL_UpdateTaskData = [NSString stringWithFormat:SQL_UPDATE_TASK, 10, 10, 10, 10,@&quot;la&quot;,@&quot;la&quot;, 10];</span><br><span class="line"></span><br><span class="line">[self.sqliteDao excuteSQL:SQL_UpdateTaskData];</span><br></pre></td></tr></table></figure><p>5.Delete</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//NSString *SQL_DeleteAllTaskData = [NSString stringWithFormat:SQL_DELETE_ALL,TABLE_TASK];</span><br><span class="line"></span><br><span class="line">// delete one record</span><br><span class="line"></span><br><span class="line">    NSString *SQL_DeleteTaskData = [NSString stringWithFormat:SQL_DELETE,TABLE_TASK,@&quot;TASK_ID&quot;,248];</span><br><span class="line"></span><br><span class="line">    BOOL deleteSuccess = [self.sqliteDao excuteSQL:SQL_DeleteTaskData];</span><br><span class="line"></span><br><span class="line">    if (deleteSuccess) &#123;</span><br><span class="line"></span><br><span class="line">        NSLog(@&quot;delete success!&quot;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>6.Select</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">NSString *SQL_SelectCategoryData = [NSString stringWithFormat:SQL_SELECT_ALL,TABLE_TASK];</span><br><span class="line"></span><br><span class="line">    NSMutableArray *selectedTasks = [NSMutableArray array];</span><br><span class="line"></span><br><span class="line">    // select *</span><br><span class="line"></span><br><span class="line">    [self.sqliteDao excuteQuerySQL:SQL_SelectCategoryData resultBlock:^(FMResultSet *rsSet) &#123;</span><br><span class="line"></span><br><span class="line">        while ([rsSet next]) &#123;</span><br><span class="line"></span><br><span class="line">            NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;TASK_ID&quot;] forKey:@&quot;TASK_ID&quot;];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;ROOM_ID&quot;] forKey:@&quot;ROOM_ID&quot;];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;TASK_INFO&quot;] forKey:@&quot;TASK_INFO&quot;];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;TASK_NUMBER&quot;] forKey:@&quot;TASK_NUMBER&quot;];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;TASK_STATUS&quot;] forKey:@&quot;TASK_STATUS&quot;];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;TASK_COORDINATE&quot;] forKey:@&quot;TASK_COORDINATE&quot;];</span><br><span class="line"></span><br><span class="line">            [dict setValue:[rsSet objectForColumnName:@&quot;TASK_BEDSIDE&quot;] forKey:@&quot;TASK_BEDSIDE&quot;];</span><br><span class="line"></span><br><span class="line">            [selectedTasks addObject:dict];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;];</span><br><span class="line"></span><br><span class="line">    NSLog(@&quot;selected all tasks:%@&quot;,selectedTasks);</span><br><span class="line"></span><br><span class="line">    // select by ID</span><br><span class="line"></span><br><span class="line">    NSString *SQL_SelectByID = [NSString stringWithFormat:SQL_SELECT_PARAMTER,TABLE_CATEGORY,@&quot;CATEGORY_ID&quot;,6];</span><br><span class="line"></span><br><span class="line">    [self.sqliteDao excuteQuerySQL:SQL_SelectByID resultBlock:^(FMResultSet *rsSet) &#123;</span><br><span class="line"></span><br><span class="line">        while ([rsSet next]) &#123;</span><br><span class="line"></span><br><span class="line">            // save as model data</span><br><span class="line"></span><br><span class="line">            MZCategory *selectedCategory    = [MZCategory new];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryID     = [rsSet objectForColumnName:@&quot;CATEGORY_ID&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.parentID       = [rsSet objectForColumnName:@&quot;PARENT_ID&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.level          = [rsSet objectForColumnName:@&quot;LEVEL&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryName   = [rsSet objectForColumnName:@&quot;CATEGORY_NAME&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryImg    = [rsSet objectForColumnName:@&quot;CATEGORY_IMG&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryRank   = [rsSet objectForColumnName:@&quot;CATEGORY_RANK&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryType   = [rsSet objectForColumnName:@&quot;CATEGORY_TYPE&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryStatus = [rsSet objectForColumnName:@&quot;CATEGORY_STATUS&quot;];</span><br><span class="line"></span><br><span class="line">            selectedCategory.categoryRemark = [rsSet objectForColumnName:@&quot;CATEGORY_REMARK&quot;];</span><br><span class="line"></span><br><span class="line">            NSLog(@&quot;select by categoryID:%d,parentID:%d,level:%d,categoryName:%@,categoryImg:%@,categoryRank:%d,categoryType:%d,categoryStatus:%d,categoryRemark:%@&quot;,[selectedCategory.categoryID intValue],[selectedCategory.parentID intValue],[selectedCategory.level intValue],selectedCategory.categoryName,selectedCategory.categoryImg,[selectedCategory.categoryRank intValue],[selectedCategory.categoryType intValue],[selectedCategory.categoryStatus intValue],selectedCategory.categoryRemark);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure><h2 id="è¯´åœ¨åé¢"><a href="#è¯´åœ¨åé¢" class="headerlink" title="è¯´åœ¨åé¢"></a>è¯´åœ¨åé¢</h2><p>æœ¬äººæŠ€æœ¯æµ…è–„ï¼Œå¯¹æ•°æ®åº“çš„ç†è§£ä¹Ÿä¸å¤Ÿæ·±å…¥é€å½»ï¼Œåœ¨æ­¤å†™ä¸‹å¾®æœ«ç»éªŒï¼Œä»¥æœŸä¸ºåæ¥ä¹‹åˆå­¦è€…æä¾›äº›è®¸ä¾¿åˆ©ï¼Œè‹¥æœ‰ä¸€äººè§‰å¾—æ­¤é¡¹ç›®å¹¶éé€šç¯‡èƒ¡è¨€ï¼Œä¹Ÿä¸æ‰æˆ‘ç å­—ä¹‹åŠ³ç´¯ï¼Œæœ€åå¥‰ä¸Š<a href="https://github.com/fusugz/fmdbEncap" target="_blank" rel="noopener">Githubé¡¹ç›®åœ°å€</a>ï¼Œå¦‚éœ€å‚è€ƒä¸å¦¨å‰å¾€ä¸‹è½½ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç¼˜ç”±&quot;&gt;&lt;a href=&quot;#ç¼˜ç”±&quot; class=&quot;headerlink&quot; title=&quot;ç¼˜ç”±&quot;&gt;&lt;/a&gt;ç¼˜ç”±&lt;/h2&gt;&lt;p&gt;FMDBæ˜¯iOSå¹³å°å¤„ç†æ•°æ®æŒä¹…åŒ–çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…é«˜æ•ˆåœ°åœ¨å®¢æˆ·ç«¯å¤„ç†æ•°æ®ï¼Œä½†å¯¹äºæˆ‘ç­‰åˆçº§å¼€å‘è€…æ¥è¯´å…¶ä½¿ç”¨è¿˜æ˜¯ä¸å¤Ÿç®€å•ã€‚å› æ­¤ï¼Œæœ‰
      
    
    </summary>
    
      <category term="Objective-C" scheme="https://fusugz.github.io/categories/Objective-C/"/>
    
    
      <category term="fmdb" scheme="https://fusugz.github.io/tags/fmdb/"/>
    
      <category term="database" scheme="https://fusugz.github.io/tags/database/"/>
    
  </entry>
  
  <entry>
    <title>ä¸å®¹é”™è¿‡çš„WWDC17å…¨ç¨‹è®°å½•</title>
    <link href="https://fusugz.github.io/2017/06/06/note-of-WWDC17/"/>
    <id>https://fusugz.github.io/2017/06/06/note-of-WWDC17/</id>
    <published>2017-06-06T11:09:46.000Z</published>
    <updated>2017-06-06T11:13:30.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2251123-4348ae5a59d0dcfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="wwdc2017"></p><p>WWDC17å¦‚æœŸè€Œè‡³ï¼Œè‹¹æœè¿™ä¸€æ¬¡ä½“ç°äº†è¶³å¤Ÿçš„è¯šæ„ï¼Œä¹Ÿå±•ç°äº†å…¶ç»§ç»­æ”¹å˜ä¸–ç•Œçš„å†³å¿ƒå’Œæƒ…æ€€ï¼Œåœ¨Keynoteç¯èŠ‚ç”¨ä¸¤ä¸ªå¤šå°æ—¶é˜è¿°å’Œæ¼”ç¤ºäº†è‹¹æœç”Ÿæ€ç³»ç»Ÿè½¯ç¡¬ä»¶æ–¹é¢çš„æ›´æ–°ï¼Œæœ‰å‡çº§ä¼˜åŒ–ï¼Œä¹Ÿæœ‰åˆ›é€ é©æ–°ï¼Œå¯è°“äº®ç‚¹å¤šå¤šã€‚</p><p>è‹¹æœä¸€ç›´å£°ç§°è¦ä»¥æŠ€æœ¯å’Œæƒ…æ€€æ”¹å˜ä¸–ç•Œï¼Œæ­£å¦‚æœ¬æ¬¡ä¸»é¢˜è¯:</p><blockquote><p>Technology alone is not enough.</p></blockquote><p>Technology must intersect with the liberal arts and the humanities, </p><p>to create new ideas and experiences that push society forward. </p><p>This summer we bring together thousands of brilliant minds representing many diverse perspectives,passions, and talents to help us change the world.</p><p>ä»…ä»…é æŠ€æœ¯æ˜¯ä¸å¤Ÿçš„ã€‚</p><p>æŠ€æœ¯å¿…é¡»ä¸æ–‡ç§‘å’Œäººæ–‡ç›¸äº¤ï¼Œåˆ›é€ æ–°çš„æ€æƒ³å’Œç»éªŒï¼Œæ¨åŠ¨ç¤¾ä¼šå‘å‰å‘å±•ã€‚</p><p>ä»Šå¹´å¤å¤©ï¼Œæˆ‘ä»¬æ±‡é›†äº†æˆåƒä¸Šä¸‡çš„æ‰åæ¨ªæº¢çš„äººæ‰ï¼Œä»£è¡¨ç€è®¸å¤šä¸åŒçš„è§‚ç‚¹ï¼Œæ¿€æƒ…å’Œæ‰åï¼Œä»¥å¸®åŠ©æˆ‘ä»¬æ”¹å˜ä¸–ç•Œã€‚</p><p><strong>é‚£ä¹ˆï¼Œå¿«æ¥çœ‹çœ‹è‹¹æœå°†æ€æ ·æ”¹å˜ä¸–ç•Œå§</strong></p><ul><li><p>ç¡¬ä»¶æ–¹é¢ï¼šå‘å¸ƒäº†åŒ…æ‹¬21.5/27å¯¸iMac/iMac Proã€10.5å¯¸è¶…çª„è¾¹iPad Proã€7ä»£é…·ç¿çš„MacBookã€A10Xå¤„ç†å™¨çš„iPad Proï¼Œæ”¯æŒSiriå’ŒHomeKitçš„å…¨æ–°ç¡¬ä»¶HomePadæ‰¬å£°å™¨ç­‰ã€‚</p></li><li><p>è½¯ä»¶æ–¹é¢ï¼štvOSç»†å¾®æ”¹è¿›ã€watchOS 4ã€macOS High Sierraã€iOS 11ç­‰ã€‚</p></li></ul><hr><h1 id="tvOS"><a href="#tvOS" class="headerlink" title="tvOS"></a>tvOS</h1><h2 id="Changes-on-tvOC"><a href="#Changes-on-tvOC" class="headerlink" title="Changes on tvOC"></a>Changes on tvOC</h2><blockquote><p>Add Amzon and suppot itâ€™s prime video </p></blockquote><p>tvOSæœ¬æ¬¡æ²¡æœ‰å®è´¨ä¸Šçš„æ›´æ–°ï¼Œä»…ä»…å®£å¸ƒäº†äºšé©¬é€Šçš„åŠ å…¥å¹¶ä¸ºå…¶å¸¦æ¥äº†æ›´å¤šä¼˜ç§€çš„è§†é¢‘ã€‚</p><hr><h1 id="watchOS"><a href="#watchOS" class="headerlink" title="watchOS"></a>watchOS</h1><h2 id="Changes-on-watchOS"><a href="#Changes-on-watchOS" class="headerlink" title="Changes on watchOS"></a>Changes on watchOS</h2><blockquote><p>watchOS 4 updates</p></blockquote><p>i. Card View UI      </p><p>ii. Activity new UI</p><p>iii. Great support for workout</p><p>iv. Music app added and support background play</p><p>watch OSåœ¨UIä¸Šå­¦ä¹ äº†Google Material UIçš„Card View,ä½¿å¾—iWatchåœ¨è§†è§‰å‘ˆç°ä¸Šæ›´åŠ ç¾è§‚ï¼ŒåŒæ—¶åœ¨é€šçŸ¥æ UIä¸Šæœ‰äº†è¾ƒå¤§æ”¹å˜ã€‚åœ¨è¿åŠ¨ã€å¤©æ°”ã€äº¤é€šç­‰æ–¹é¢æ›´å¥½åœ°æ”¯æŒæˆ·å¤–ç”Ÿæ´»ï¼Œè¿åŠ¨æ•°æ®å‘ˆç°æ›´åŠ ç”ŸåŠ¨ç›´è§‚ã€‚æ–°åŠ å…¥çš„Music appè®©ç”¨æˆ·å¯ä»¥ç›´æ¥åœ¨æ‰‹è¡¨ä¸Šäº«å—éŸ³ä¹ï¼Œå¹¶å¯æ”¯æŒæ— çº¿è“ç‰™ã€‚</p><h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><blockquote><p>Screen autorotate  </p></blockquote><p>Background navigation</p><p>Background audio recording</p><p>Single-propress runtime</p><p>Full screen</p><p>Overlapping layers</p><p>Water lock API</p><p>Core Bluetooth</p><p>ä»¥ä¸Šæ˜¯watchOSè®¸å¤šç»†èŠ‚ä¸Šçš„ç‰¹æ€§ã€‚æ­¤å¤–ï¼ŒwatchOSæ–°åŠ å…¥äº†ä¸‡èŠ±ç­’æ–°è¡¨ç›˜å’Œç©å…·æ€»åŠ¨å‘˜è¡¨ç›˜ã€‚</p><hr><h1 id="macOS-High-Sierra-amp-New-Macs"><a href="#macOS-High-Sierra-amp-New-Macs" class="headerlink" title="macOS High Sierra &amp; New Macs"></a>macOS High Sierra &amp; New Macs</h1><h2 id="Updates-on-macOS-High-Sierra"><a href="#Updates-on-macOS-High-Sierra" class="headerlink" title="Updates on macOS High Sierra"></a>Updates on macOS High Sierra</h2><h3 id="Safari-more-faster"><a href="#Safari-more-faster" class="headerlink" title="Safari  ( more faster )"></a>Safari  ( more faster )</h3><blockquote><p> Worldâ€™s most fast desktop browser</p></blockquote><p>Modern JavaScript performance</p><p>Intelligent tracking prevention</p><p>Safariçš„æ›´æ–°æœ€æ˜¾è‘—çš„æ˜¯é€Ÿåº¦ï¼Œæ¯”Chromeå¿«äº†80%ï¼Œå·ç§°ç›®å‰æœ€å¿«é€Ÿçš„æ¡Œé¢æµè§ˆå™¨ã€‚</p><h3 id="Mail"><a href="#Mail" class="headerlink" title="Mail"></a>Mail</h3><blockquote><p>Full-screen split view</p></blockquote><p>Storage space required for mail up to 35% less</p><p>é‚®ç®±å¯æ”¯æŒå…¨å±å·¦å³åˆ†å±æ“ä½œï¼Œå¯ä»¥å¯¹ç€æ”¶ä»¶å†…å®¹ç¼–è¾‘å›å¤ï¼Œæ–¹ä¾¿ç›´è§‚ï¼›åŒæ—¶ï¼Œé‚®ä»¶çš„ç©ºé—´å ç”¨å‡å°‘äº†35%ã€‚</p><h3 id="Photo"><a href="#Photo" class="headerlink" title="Photo"></a>Photo</h3><p>æ›´å¥½åœ°æ ¹æ®äººå·¥æ™ºèƒ½è¿›è¡Œåˆ†ç±»ï¼Œæ›´ç²¾å‡†äººè„¸è¯†åˆ«ï¼Œå¸®åŠ©ç”¨æˆ·ç§‘å­¦ç®¡ç†ç…§ç‰‡ã€‚</p><h3 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h3><p>APFS ( Apple File System )</p><blockquote><p><strong>Advanced architecture</strong></p></blockquote><p>Optimized for morden storage</p><p>64-bit data structure</p><p>Easily adapted to future storage</p><blockquote><p><strong>Safe and Secure</strong></p></blockquote><p>Crash protection</p><p>Safe document saves</p><p>Stable snapshots</p><p>Native encryption</p><blockquote><p><strong>Ultra Responsive</strong></p></blockquote><p>Instant file and directory cloning</p><p>Fast directory sizing</p><p>Zero copy snapshots</p><p>Parallelized metedata operations</p><p>Frequently used items in inode</p><p>Sparse file write</p><p>æ–‡ä»¶ç³»ç»Ÿç”±HFSå‡çº§ä¸ºAPFSï¼Œæå‡äº†æ˜“ç”¨æ€§å’Œå®‰å…¨æ€§ï¼Œå¤åˆ¶æ“ä½œæ˜¾è‘—å˜å¿«ã€‚</p><h3 id="Video"><a href="#Video" class="headerlink" title="Video"></a>Video</h3><p>H.265( High Efficiency Video Coding ) â€”up to 40% better compression than H.264</p><p>æ”¯æŒæ›´åŠ å¿«é€Ÿé«˜æ•ˆçš„H.265è§†é¢‘ç¼–ç ï¼Œå‹ç¼©é€Ÿç‡æ¯”H.264å¿«äº†40%ã€‚</p><h3 id="Graphics-All-about-GPU"><a href="#Graphics-All-about-GPU" class="headerlink" title="Graphics ( All about GPU )"></a>Graphics ( All about GPU )</h3><p>i. Metal 2 updated,up to 10x better draw call throughput</p><blockquote><p>Driver optimizeations</p></blockquote><p>Indirect argument buffers</p><p>SIMD group data exchange </p><p>Uniform variables</p><p>Sampler arrays</p><p>Resource heaps</p><p>ç”±Metalåˆ°Metal 2ï¼Œæ€§èƒ½æé«˜10å€ã€‚</p><p>ii. Used for machine learning</p><blockquote><p>Metal perfance shaders</p></blockquote><p>Recurrent nature network kernels</p><p>Binary convolution</p><p>Dilated convolution</p><p>L-2 norm pooling</p><p>Dilated pooling</p><p>åŠ å…¥äººå·¥æ™ºèƒ½ï¼ŒåŠŸèƒ½æ›´å¼ºå¤§ã€‚</p><p>iii. Metal for external graphics</p><blockquote><p>Thunderbolt 3 enclosure</p></blockquote><p>AMD Redern RX 580</p><p>USB-C hub</p><p>å¤–éƒ¨è®¾å¤‡æ”¯æŒå‡çº§ã€‚</p><p>iv. VR content creation ( Metal for VR )</p><blockquote><p>VR -optimized display pipeline</p></blockquote><p>Viewport arrays</p><p>System trace stereo timelines</p><p>GPU quene priorities</p><p>Frame debugger stereoscopic</p><p>Visualization</p><p>å¯æ”¯æŒVRå†…å®¹åˆ›é€ ã€‚</p><p><strong>ä»Šå¤©èµ·å¯åœ¨å¼€å‘è€…ç½‘ç«™ä¸‹è½½macOS High Sierra Bateç‰ˆæœ¬</strong></p><h2 id="New-iMacs"><a href="#New-iMacs" class="headerlink" title="New iMacs"></a>New iMacs</h2><h3 id="Features-1"><a href="#Features-1" class="headerlink" title="Features"></a>Features</h3><blockquote><p><strong>Best Mac displayers ever</strong></p></blockquote><p>500 nits</p><p>43% brighter</p><p>10-bit dithering</p><p>One billion colrs</p><blockquote><p><strong>Faster processors</strong></p></blockquote><p>7th-gen Intel core</p><p>â€œKaby lakeâ€</p><p>Higher base &amp; turbo frequencies</p><p>10-bit HEVC decode</p><p>æ›´å¿«çš„æ•°æ®å¤„ç†å™¨</p><blockquote><p><strong>Higher memory capacity</strong></p></blockquote><p>Up to 32GB on 21.5-inch</p><p>Up to 64GB on 27-inch</p><p>æ›´å¤§å­˜å‚¨ç©ºé—´</p><blockquote><p><strong>Super fast storage</strong></p></blockquote><p>Fusion drive on all 27-inch </p><p>Up to 50% faster SSDs</p><p>Up to 2TB</p><p>è¶…å¿«å­˜å‚¨é€Ÿåº¦</p><h3 id="Comparison"><a href="#Comparison" class="headerlink" title="Comparison"></a>Comparison</h3><p>| iMac | Price | Improvement |</p><p>| â€”â€”â€”â€”â€”â€“ |â€”â€”-|â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“|</p><p>|iMac 21.5-inch|$1099|Intl Iris Plus Graphics 640 with 64MB eDRAM &amp; Up to 80% faster graphics|</p><p>|iMac Retina 4k 21.5-inch|$1499|Radern Pro 555 &amp; 560 up to 4GB VRAM &amp; Up to 3xfaster graphics|</p><p>|iMac Retina 5k 27-inch|$1799|Radern Pro 570,575 &amp; 580 up to 8GB VRAM &amp; Up to 5.5x teraflops</p><h3 id="The-most-powerful-Mac-ever-â€”iMac-Pro"><a href="#The-most-powerful-Mac-ever-â€”iMac-Pro" class="headerlink" title="The most powerful Mac ever â€”iMac Pro"></a>The most powerful Mac ever â€”iMac Pro</h3><blockquote><p>Up to 18-Core Xean Procesor</p></blockquote><p>Up to 22 traflops half precision</p><p>Up to 128GB ECC memory</p><p>â€¦and so on</p><p>å·¥ä½œç«™çº§åˆ«ï¼Œæ€§èƒ½å“è¶Šï¼</p><h2 id="New-MacBooks"><a href="#New-MacBooks" class="headerlink" title="New MacBooks"></a>New MacBooks</h2><p>|MacBook|Price|</p><p>|â€”â€”â€”â€”â€”â€”â€”â€”-|â€”â€”â€”|</p><p>|MacBook |$1299|</p><p>|MacBook Pro |$1299|</p><p>|MacBook Pro 13-inch|$1799|</p><p>|MacBook Pro 15-inch |$2399|</p><p>MacBookæ²¡æœ‰æ›´æ–°ï¼Œæ‰‹ä¸Šçš„è¿˜å¯ä»¥ç”¨ã€‚</p><h1 id="iOS-amp-HomePod"><a href="#iOS-amp-HomePod" class="headerlink" title="iOS &amp; HomePod"></a>iOS &amp; HomePod</h1><p>Tim Cooké¦–å…ˆé„™è§†äº†ä¸€ä¸‹Android 7å®‰è£…ç‡</p><blockquote><p>iOS 10: %86 </p></blockquote><p>Android 7: %7</p><p>å¤§å®¶éƒ½çŸ¥é“è¿™ä¸èƒ½è¯´æ˜ä»€ä¹ˆé—®é¢˜ï¼ŒAndroid 7å®‰è£…ç‡ä½æœ‰å…¶ç‰¹æ®ŠåŸå› ï¼ŒJust for funã€‚iOS 11 comes,æˆ‘ä»¬ä¸»è¦æ¥çœ‹iOS 11æœ‰å“ªäº›æ–°ç‰¹æ€§ã€‚</p><h2 id="Technologies"><a href="#Technologies" class="headerlink" title="Technologies"></a>Technologies</h2><h3 id="Message"><a href="#Message" class="headerlink" title="Message"></a>Message</h3><blockquote><p>Redesigned app drawer</p></blockquote><p>Messages in iCloud</p><p>Optimized device storage smaller and faster backups iOS &amp; macOS</p><p>50% U.S. retailers accpting Apple Pay by end of year send and received money on iMessage</p><p>iMessageå¯å‚¨å­˜åˆ°iCloudå¹¶å¯å¤‡ä»½åˆ°iOSè®¾å¤‡å’ŒmacOSè®¾å¤‡ï¼Œå¹´åº•å°†æœ‰50%çš„é›¶å”®å•†åœ¨iMessageæ”¯æŒApple Payæ”¯ä»˜ã€‚</p><h3 id="Siri"><a href="#Siri" class="headerlink" title="Siri"></a>Siri</h3><p>i. æ”¯æŒæ›´å¤šè¯­è¨€</p><p>ii. æ”¯æŒäººå·¥æ™ºèƒ½</p><p>iii. ç¿»è¯‘åŠŸèƒ½ï¼šæ”¯æŒè‹±è¯­ä¸ä¸­æ–‡ã€æ³•è¯­ã€å¾·è¯­ã€æ„å¤§åˆ©è¯­ã€è¥¿ç­ç‰™è¯­ç­‰äº’ç›¸ç¿»è¯‘</p><p>iv. Siri Kit can support more</p><h3 id="Camera-amp-Photos"><a href="#Camera-amp-Photos" class="headerlink" title="Camera &amp; Photos"></a>Camera &amp; Photos</h3><blockquote><p>H.265 supported</p></blockquote><p>Depth API</p><p>Live Photos &amp; Loop Photos &amp; Live Photoså€’æ”¾</p><p>å›¾ç‰‡å˜å¾—æ›´æœ‰è¶£äº†ã€‚</p><h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>æ–°å¢Do not disturb while drivingæ¨¡å¼ï¼Œåˆ©ç”¨äººå·¥æ™ºèƒ½ä½¿ç”¨æˆ·åœ¨é©¾è½¦æ¨¡å¼å¯æ‰“å¼€è¯¥æ¨¡å¼ï¼Œé˜²æ­¢ä¸å¿…è¦å¹²æ‰°ï¼ˆå¦‚æ¨é€ã€çŸ­ä¿¡ã€åƒåœ¾é‚®ä»¶ç­‰ï¼‰ï¼Œæ¥åˆ°çŸ­ä¿¡åå¯è‡ªåŠ¨å‘çŸ­ä¿¡å›å¤è¯´æ˜æ­£åœ¨é©¾é©¶ï¼Œç¨åå›å¤ã€‚</p><h3 id="Home-Kit"><a href="#Home-Kit" class="headerlink" title="Home Kit"></a>Home Kit</h3><p>Air Play 2 </p><p>å¼€æ”¾Air Play 2 Audio APIï¼Œå¼€å‘è€…å¯å¼€å‘ç›¸å…³æ™ºèƒ½å®¶å±…åŠŸèƒ½ã€‚</p><h3 id="Apple-Music"><a href="#Apple-Music" class="headerlink" title="Apple Music"></a>Apple Music</h3><blockquote><p>Full access to Apple Music service</p></blockquote><p>Cloud Library access</p><p>Usersâ€™ for you recommendations</p><p>Featured music &amp;charts</p><p>Search playlist,stations,,and catalog</p><p>æ›´åŠ æ³¨é‡ç¤¾äº¤å’Œä¸ªæ€§åŒ–ï¼Œæ›´æ™ºèƒ½å¸®åŠ©ç”¨æˆ·ç­›é€‰éŸ³ä¹ã€‚</p><h3 id="App-Store-â€”the-best-platform-in-the-worlld"><a href="#App-Store-â€”the-best-platform-in-the-worlld" class="headerlink" title="App Store â€”the best platform in the worlld"></a>App Store â€”the best platform in the worlld</h3><blockquote><p>Trusted and safe place for users great opportunity for all developers</p></blockquote><p>Every single day has new app and new games commend for users</p><p>App Storeä¸­appå’Œæ¸¸æˆå±•ç¤ºæ›´åŠ ä¸°å¯Œè¯¦ç»†ï¼Œæ¯æ—¥æœ‰æ¨èï¼Œå€¼å¾—ä¿¡ä»»ï¼Œå®‰å…¨å‹å¥½ã€‚</p><h3 id="Machine-Learning-Core-ML"><a href="#Machine-Learning-Core-ML" class="headerlink" title="Machine Learning ( Core ML )"></a>Machine Learning ( Core ML )</h3><blockquote><p>Vision API,learning API</p></blockquote><p>Images recognized per minute</p><p>äººå·¥æ™ºèƒ½å¼€æ”¾APIã€‚</p><h3 id="AR-AR-Kit-â€”the-largest-AR-platform-in-the-world"><a href="#AR-AR-Kit-â€”the-largest-AR-platform-in-the-world" class="headerlink" title="AR ( AR Kit )â€”the largest AR platform in the world"></a>AR ( AR Kit )â€”the largest AR platform in the world</h3><blockquote><p>Fast,stable motion tracking</p></blockquote><p>Plane estimation with basic boundaries</p><p>Ambient lighting estimation</p><p>Scale extimation</p><p>Support for Unity,Unreal,ScenceKit</p><p>Xcode app templates</p><p>è‹¹æœç»ˆäºç¥­å‡ºARå¤§æ‹›äº†ï¼Œä¼šä¸Šæ¼”ç¤ºäº†Demoï¼Œéå¸¸å¼ºå¤§ï¼</p><h3 id="Something-Special-for-China"><a href="#Something-Special-for-China" class="headerlink" title="Something Special for China"></a>Something Special for China</h3><blockquote><p>QR code support </p></blockquote><p>SMS fraud extension</p><p>Traffic cameras</p><p>Shanghainese dictation</p><p>English on 10-key Pinyin keyboard</p><p>Phone number as Apple ID</p><p>è‹¹æœåˆä¸€æ¬¡åœ¨å¼€å‘è€…å¤§ä¼šä¸Šå‘ä¸­å›½ç”¨æˆ·ç¤ºå¥½ï¼ˆæ¯•ç«Ÿä¸­å›½ç”¨æˆ·è¿™ä¹ˆå¤šï¼‰ã€‚æ”¯æŒäº†ç”¨ç›¸æœºæ‰«äºŒç»´ç ã€çŸ­ä¿¡è¯ˆéª—é˜²æŠ¤ã€äº¤é€šæ‘„åƒæœºã€ä¸Šæµ·è¯å¬å†™10é”®æ‹¼éŸ³é”®ç›˜å’Œç”µè¯å·ç ç»‘å®šApple IDç­‰ï¼Œè¯šæ„æ»¡åˆ†ã€‚</p><h2 id="iOS-11-on-iPad"><a href="#iOS-11-on-iPad" class="headerlink" title="iOS 11 on iPad"></a>iOS 11 on iPad</h2><h3 id="Pro-motion-â€”120Hz-Display-refresh-rate"><a href="#Pro-motion-â€”120Hz-Display-refresh-rate" class="headerlink" title="Pro motion â€”120Hz Display refresh rate"></a>Pro motion â€”120Hz Display refresh rate</h3><blockquote><p>Six-Core CPU</p></blockquote><p>Twelve-Core GPU</p><p>æ€§èƒ½æå‡ã€‚</p><h3 id="Deck-on-iPad"><a href="#Deck-on-iPad" class="headerlink" title="Deck on iPad"></a>Deck on iPad</h3><p>iPadæ–°å¢Deckï¼Œç±»ä¼¼äºiMacï¼Œå¯å‘ˆç°ä¸éšè—ï¼Œæ–¹ä¾¿æ‹–æ‹½ä¸åˆ†å±ã€‚</p><h3 id="Files-on-iPad"><a href="#Files-on-iPad" class="headerlink" title="Files on iPad"></a>Files on iPad</h3><p>iPadæ–°å¢æ–‡ä»¶ç³»ç»Ÿï¼Œæ”¯æŒæ‹–æ¥æ‹–å»åŠŸèƒ½ï¼Œæ–‡ä»¶æ“ä½œååˆ†æ–¹ä¾¿ï¼Œæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ–‡ä»¶ç³»ç»Ÿã€‚</p><h2 id="HomePod-349"><a href="#HomePod-349" class="headerlink" title="HomePod ( $349 )"></a>HomePod ( $349 )</h2><p>Reinvent Home Music &amp; Breakthrough Home Speaker</p><h3 id="For-waht"><a href="#For-waht" class="headerlink" title="For waht"></a>For waht</h3><ul><li><p>Rock the house</p></li><li><p>Spatial awareness</p></li><li><p>Musicologist</p></li><li><p>Home assistant</p></li></ul><h3 id="Hardware"><a href="#Hardware" class="headerlink" title="Hardware"></a>Hardware</h3><blockquote><p>7beam-forming tweeter array</p></blockquote><p>Precision acoustic horns</p><p>Directional control</p><p>Apple designed woofer</p><p>Automatic bass equalizetion</p><p>Dynamic modeling</p><h3 id="Great-Home-Speaker"><a href="#Great-Home-Speaker" class="headerlink" title="Great Home Speaker"></a>Great Home Speaker</h3><p>HomePodå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸é«˜å¤§ä¸Šçš„ä¸­æ–‡åï¼šè½°è¶´ï¼Œå…·æœ‰ç»ç¾å¤–è§‚ï¼Œæ­è½½A8å¤„ç†å™¨ã€‚å¯æ”¯æŒç«‹ä½“ç¯ç»•å£°ï¼Œä¹Ÿå¯åªæœä¸€ä¸ªæ–¹å‘å‘å£°ã€‚å¯åœ¨HomePodä¸­ä½¿ç”¨Siriï¼Œå¯ä»¥ç›´æ¥å¯¹å®ƒè¯´è¯ï¼Œå¦‚æ§åˆ¶ç”µå™¨ã€ä»‹ç»æ–°é—»ç­‰ã€‚å…·å¤‡Anonymous IDï¼Œé»‘ç™½ä¸¤ç§é¢œè‰²ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2251123-4348ae5a59d0dcfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; 
      
    
    </summary>
    
      <category term="iOS" scheme="https://fusugz.github.io/categories/iOS/"/>
    
    
      <category term="iOS" scheme="https://fusugz.github.io/tags/iOS/"/>
    
      <category term="WWDC" scheme="https://fusugz.github.io/tags/WWDC/"/>
    
  </entry>
  
  <entry>
    <title>å†™ä¸€ä¸ªDeleteç¨‹åºå»å¿˜è®°</title>
    <link href="https://fusugz.github.io/2017/06/04/write-a-delete-program-to-forget/"/>
    <id>https://fusugz.github.io/2017/06/04/write-a-delete-program-to-forget/</id>
    <published>2017-06-04T15:10:26.000Z</published>
    <updated>2017-06-04T15:11:52.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/2251123-200142e6247ae54d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Memory"></p><p>æ¸…æ™¨ï¼Œå¤ªé˜³ç…§å¸¸å‡èµ·äº†ã€‚å®¿é†‰ä¹‹åå¸¸å¸¸ä¸çŸ¥èº«åœ¨ä½•å¤„ï¼Œç‰‡åˆ»ä¹‹åï¼Œæ€ç»ªç¿»é£ï¼Œä¸€åˆ‡æ˜¨å¤œè¿«åˆ‡æƒ³å¿˜è®°çš„åˆéƒ½æµ®ä¸Šäº†å¿ƒå¤´ã€‚å›åˆ°ç°å®åä¸å¾—ä¸æ¥å—ä¸å¦ä¸€åŠåˆ†å¼€çš„äº‹å®ï¼Œä¸å…¶ç»§ç»­æ€€å¿µï¼Œæ²‰æµ¸åœ¨æ‚²å“€è‹¦é—·ä¹‹ä¸­ï¼Œä¸å¦‚å°è¯•å»å¿˜è®°ã€‚</p><p>äºæ˜¯ï¼Œä½œä¸ºç¨‹åºå‘˜ï¼Œæˆ‘å†³å®šå°è¯•å†™ä¸€ä¸ªDeleteç¨‹åºå»å¿˜è®°ã€‚</p><p>è¯¥ç¨‹åºçš„æ ¸å¿ƒåœ¨äºåˆ é™¤æŸäº›è®°å¿†ç‰‡æ®µï¼Œè®©æœªæ¥çš„ç”Ÿæ´»ä¸å†å—ç—›è‹¦å›å¿†çš„ç¾ç»Šã€‚</p><blockquote><p>é¦–å…ˆï¼ŒæŸ¥æ‰¾ç›¸å…³ç›®æ ‡å¯¹è±¡</p></blockquote><p>é¢å¯¹åºå¤§çš„å¤§è„‘è®°å¿†ç³»ç»Ÿï¼Œæ”¶é›†æ•°æ®æ˜¯ä¸€ä»¶ç¹å¤çš„äº‹æƒ…ã€‚è¦æ‰¾åˆ°äººè„‘è®°å¿†çš„å­˜å‚¨å•å…ƒï¼Œéå†å…¶æ‰€æœ‰ç¥ç»å…ƒï¼Œæ‰¾åˆ°è®°å¿†çš„å­˜å‚¨å…¥å£ã€‚è¯¥å…¥å£çš„æ‰“å¼€å¯èƒ½ä¸å¤–éƒ¨åˆºæ¿€æœ‰å…³ï¼Œå› æ­¤éœ€è¦æ¨¡æ‹Ÿä¼ å…¥ä¿¡æ¯ä¸è®°å¿†å­˜å‚¨å…¥å£è¿›è¡Œå¯¹æ¥ã€‚ä¸€æ—¦å¯¹æ¥æˆåŠŸï¼Œå°†å¯¹æ¥è¿‡ç¨‹ä¸­çš„å¯†ç ï¼ˆç”µä¿¡å·ï¼‰ä¿å­˜ï¼Œå¹¶è¡Œå¯¹æ‰€æœ‰è®°å¿†å…¥å£è¿›è¡Œå¯¹æ¥æœç´¢ï¼Œæ ¹æ®â€œå‰å¥³å‹â€ã€â€œå‰å¥³å‹åå­—â€ã€â€œçˆ±æƒ…â€ã€â€œå¯çˆ±â€ã€â€œå¥½å¦¹å¦¹â€ã€â€œçˆ±äººâ€ç­‰å…³é”®å­—è¿›è¡Œæ£€ç´¢ï¼Œè·å–ç›¸å…³ç›®æ ‡è®°å¿†ç‰‡æ®µã€‚</p><blockquote><p>é€ä¸€å¯¹å„ç›®æ ‡è®°å¿†ç‰‡æ®µè¿›è¡Œè®°å¿†å”¤é†’ï¼Œç­›é€‰å‡ºç²¾å‡†ç›®æ ‡å¯¹è±¡</p></blockquote><p>æ­¤æ—¶ï¼Œéœ€è¦ç¡®å®šç›¸å…³ç›®æ ‡è®°å¿†ç‰‡æ®µä¸­å“ªäº›æ˜¯éœ€è¦åˆ é™¤çš„ç›®æ ‡è®°å¿†ç‰‡æ®µã€‚æœ‰æ•ˆæ–¹æ³•æ˜¯å£°æ˜ä¸€ä¸ªæ–¹æ³•ç”¨æ¥ç­›é€‰ï¼ˆç±»ä¼¼çˆ¬è™«ï¼‰ï¼Œéå†æ‰€æœ‰ç›¸å…³ç›®æ ‡è®°å¿†ç‰‡æ®µï¼Œé€ä¸€ç”¨è®°å¿†å”¤é†’æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼Œç”¨è¿”å›çš„å¸ƒå°”å€¼è¿›è¡Œç­›é€‰ï¼ŒTrueè¡¨ç¤ºéœ€è¦åˆ é™¤ï¼ŒFalseè¡¨ç¤ºä¸éœ€è¦åˆ é™¤ã€‚åœ¨ç­›é€‰æ–¹æ³•ä¸­ï¼Œå°†è®°å¿†ç‰‡æ®µå¯¹è±¡è¾“é€åˆ°äººè„å¤„ï¼Œç”¨åˆºæ¿€æ–¹æ³•æ£€æŸ¥æ˜¯å¦å¼•èµ·å¿ƒç‡å¼‚å¸¸ï¼Œæ˜¯å¦å¼•èµ·å¿ƒç—›ï¼Œä»¥åŠæ˜¯å¦å¼•èµ·å¤´ç—›ã€å››è‚¢æ— åŠ›ç­‰äººä½“æœºèƒ½ååº”ã€‚è‹¥æœ‰ï¼Œåˆ™è¿”å›Trueï¼›è‹¥æ— ï¼Œåˆ™è¿”å›Falseã€‚æ¥ä¸‹æ¥ï¼Œåœ¨æ‰€æœ‰è¿”å›ä¸ºFalseçš„è®°å¿†ä¸­ï¼Œå°†æ‰€æœ‰å¤§è„‘å’Œå¿ƒè„èƒ½å¹³ç¨³æ¥å—å¹¶å¿ƒå¦‚æ­¢æ°´çš„è®°å¿†å®Œæ•´ä¿å­˜å¥½ï¼Œé‡æ–°ç”¨å‚¨å­˜æ–¹æ³•å‚¨å­˜åœ¨å¤§è„‘ä¸­ï¼›å°†æ‰€æœ‰ä»¤å¤§è„‘äº§ç”Ÿæ„‰æ‚¦å¹¶ä¼´éšç¾å¥½å¹»æƒ³çš„è®°å¿†è¿›è¡Œå¤‡ä»½å¤„ç†ï¼Œå¹¶å­˜å‚¨åœ¨æ ¸å¿ƒå­˜å‚¨åŒºï¼Œæ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è¿›è¡Œå›å¿†ã€‚å°†æ‰€æœ‰åˆ¤æ–­å‡ºéœ€åˆ é™¤è®°å¿†ç‰‡æ®µæŒ‰ç±»å‹åˆ†å¼€å­˜å‚¨åœ¨æµ…è®°å¿†åŒºï¼Œä»¥ä¾¿åˆ†æ—¶åˆ†ç±»åˆ é™¤ã€‚</p><blockquote><p>å¯¹éœ€åˆ é™¤è®°å¿†å¯¹è±¡æ ¹æ®ä¸åŒç±»åˆ«è¿›è¡Œåˆ é™¤æ“ä½œ</p></blockquote><p>è¿™æ˜¯æœ¬åˆ é™¤ç¨‹åºçš„æœ€åä¸€æ­¥ï¼Œä¹Ÿæ˜¯è‡³å…³é‡è¦çš„ä¸€æ­¥ã€‚å¯¹å„ç±»åˆ«éœ€åˆ é™¤è®°å¿†æ·±æµ…ç¨‹åº¦è¿›è¡Œè¯„ä¼°ï¼Œç”±æµ…å…¥æ·±ï¼Œå¾ªåºæ¸è¿›ã€‚æ‰§è¡Œåˆ é™¤æ“ä½œï¼šå¯¹äºæµ…å±‚æ¬¡ç—›è‹¦è®°å¿†è¿›è¡Œå­˜å‚¨ç©ºé—´å ç”¨æ³•è¿›è¡Œåˆ é™¤ï¼Œåˆ©ç”¨å·¥ä½œã€å­¦ä¹ å’Œè¿åŠ¨ç­‰æ¥ä¸°å¯Œä¸ªäººç”Ÿæ´»ï¼Œå½¢æˆæ–°çš„ç¾å¥½è®°å¿†ï¼Œå°†æµ…å±‚æ¬¡ç—›è‹¦è®°å¿†é€æ¸å‹ç¼©å‡ºè®°å¿†å­˜å‚¨åŒºã€‚å¯¹äºä¸€èˆ¬å±‚æ¬¡ç—›è‹¦è®°å¿†é‡‡å–åœ¨æˆ‘ç–—å…»æ³•è¿›è¡Œæ—¶é•¿è¾ƒé•¿çš„åˆ é™¤æ“ä½œï¼Œåˆ©ç”¨ä¹‹å‰ä¸å¯¹æ–¹ç•™ä¸‹çš„ç¾å¥½è®°å¿†ä¸ºä¸€èˆ¬å±‚æ¬¡ç—›è‹¦è®°å¿†ç¨€é‡Šï¼Œè®©æ—¶é—´ä½œä¸ºå‚¬åŒ–å‰‚ä¿ƒè¿›è¯¥ç±»è®°å¿†çš„åˆ é™¤ï¼Œè™½è€—æ—¶é•¿ï¼Œä½†çŠ¹å¯åŸºæœ¬å®Œæˆåˆ é™¤æ“ä½œã€‚å¯¹äºæå…¶æ·±åˆ»çš„ç—›è‹¦å›å¿†ï¼Œéœ€è¦ç”¨æš´åŠ›ç§»é™¤çš„æ–¹æ³•è¿›è¡Œåˆ é™¤æ“ä½œï¼Œéœ€è¦æœ‰æå¤§çš„å‹‡æ°”å’Œå†³å¿ƒï¼Œè€—å°½ä¸€ä¸ªä¸ªéš¾ç†¬çš„å¤œæ™šï¼Œç”¨é…’ç²¾æˆ–è‡ªè™è¿›è¡Œè¾…åŠ©ï¼Œæš‚æ—¶æ€§å°é—­è¯¥å­˜å‚¨åŒºï¼Œç›¸å½“äºå°†è®°å¿†æ–‡ä»¶ç§»åˆ°å›æ”¶ç«™ï¼Œä½†å´æ— æ³•å½»åº•åˆ é™¤ï¼Œä¸€æ—¦åœ¨ç”Ÿæ´»ä¸­æœ‰è¯¯æ“ä½œï¼Œè¿™äº›è®°å¿†åˆä¼šè¿›ä¸€æ­¥æ·±åŒ–ï¼Œå› æ­¤è¯¥æ“ä½œéœ€ç®¡ç†å‘˜æœ€é«˜æƒé™ï¼Œå¹¶è°¨æ…æ‰§è¡Œæ“ä½œã€‚</p><p><img src="http://upload-images.jianshu.io/upload_images/2251123-27565ff8b1d662fc.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Not don&#39;t,but can&#39;t"></p><blockquote><p>ç»“è®º</p></blockquote><p>æœ‰äº†è¿™ä¸ªDeleteç¨‹åºï¼Œä¼šè®©ä½ åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¿˜è®°ä¸€äº›ç—›è‹¦è®°å¿†ï¼Œä½†ç¾å¥½è®°å¿†æ˜¯æ— æ³•ä¹Ÿæ— ç†ç”±å»å¿˜è®°ã€‚å½“ç•™ä¸‹çš„å…¨æ˜¯ç¾å¥½è®°å¿†åï¼Œè¯·å°†å…¶çè—åœ¨å¿ƒçµæ·±å¤„çš„æŸä¸ªè§’è½ï¼Œå¥½å¥½ä¿ç®¡ï¼Œä¸è¦å¦„è‡ªå¼ºè¡Œåˆ é™¤ï¼Œå¦åˆ™ï¼Œç¾å¥½è®°å¿†ä¹Ÿä¼šå˜æˆç—›è‹¦å›å¿†ã€‚è¯¥ç¨‹åºåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯å°†ä¸å¥½æƒ…ç»ªå’Œè®°å¿†æš‚æ—¶å±è”½ï¼Œç•™ä¸‹ç¾å¥½çš„ç§¯æçš„è®°å¿†ï¼Œä¾›ä½™ç”Ÿå»æƒ³å¿µã€‚ç„¶è€Œï¼Œä»ç»“æœä¸Šæ¥è¯´ï¼Œè¯¥ç¨‹åºæ˜¯å¤±è´¥çš„ï¼Œäº‹å®è¯æ˜ï¼Œå¼ºå¤§å¦‚ç¨‹åºå‘˜ï¼Œä¹Ÿä¸èƒ½åƒå¤„ç†ç¨‹åºä¸€æ ·é¢å¯¹æ„Ÿæƒ…ï¼Œä¸”è¡Œä¸”çæƒœã€‚</p><p><strong>å¦‚éœ€ä¸‹è½½æœ¬ç¨‹åºï¼Œæœ¬äººå°†æ•´ç†åæ‰˜ç®¡è‡³Githubï¼Œæ•¬è¯·æœŸå¾…ï¼ï¼</strong></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/2251123-200142e6247ae54d.jpeg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot;
      
    
    </summary>
    
      <category term="program" scheme="https://fusugz.github.io/categories/program/"/>
    
    
      <category term="forget" scheme="https://fusugz.github.io/tags/forget/"/>
    
  </entry>
  
</feed>
